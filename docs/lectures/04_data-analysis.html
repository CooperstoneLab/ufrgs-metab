<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jessica Cooperstone">

<title>Analysis of metabolomics data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="../lectures/01_intro.html" rel="" target="">
 <span class="dropdown-text">Introduction to metabolomics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/02_design-collection.html" rel="" target="">
 <span class="dropdown-text">Study design and sample collection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/03_lc-ms.html" rel="" target="">
 <span class="dropdown-text">LC-MS data acquisition and pre-processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/04_data-analysis.html" rel="" target="">
 <span class="dropdown-text">Data analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/05_compound-id.html" rel="" target="">
 <span class="dropdown-text">Compound ID</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-activities" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Activities</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-activities">    
        <li>
    <a class="dropdown-item" href="../activities/02_design-experiment.html" rel="" target="">
 <span class="dropdown-text">Design your own experiment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/03_mzmine.html" rel="" target="">
 <span class="dropdown-text">LC-MS pre-processing with MZmine</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/04_metaboanalyst.html" rel="" target="">
 <span class="dropdown-text">Data analysis with MetaboAnalyst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/05_R.html" rel="" target="">
 <span class="dropdown-text">Data analysis with R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://mzmine.github.io/" rel="" target="">
 <span class="dropdown-text">MZmine 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.metaboanalyst.ca/" rel="" target="">
 <span class="dropdown-text">MetaboAnalyst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hmdb.ca/" rel="" target="">
 <span class="dropdown-text">HMDB</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://buckeyemailosu-my.sharepoint.com/:f:/g/personal/cooperstone_1_osu_edu/Em__DQbIlCBBuadrLMNDr8gB7-_tQayjX1JSzSdubjwhQA?e=QZdzx4" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-cloud-arrow-down"></i></a>
    <a href="https://github.com/CooperstoneLab/ufrgs-metabolomics" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#now-that-we-have-our-feature-table-what-happens-next" id="toc-now-that-we-have-our-feature-table-what-happens-next" class="nav-link active" data-scroll-target="#now-that-we-have-our-feature-table-what-happens-next">Now that we have our feature table, what happens next?</a></li>
  <li><a href="#data-pre-treatment" id="toc-data-pre-treatment" class="nav-link" data-scroll-target="#data-pre-treatment">Data pre-treatment</a></li>
  <li><a href="#centering" id="toc-centering" class="nav-link" data-scroll-target="#centering">Centering</a></li>
  <li><a href="#scaling" id="toc-scaling" class="nav-link" data-scroll-target="#scaling">Scaling</a></li>
  <li><a href="#log-transformation---tables" id="toc-log-transformation---tables" class="nav-link" data-scroll-target="#log-transformation---tables">Log transformation - tables</a></li>
  <li><a href="#log-transformation---plots" id="toc-log-transformation---plots" class="nav-link" data-scroll-target="#log-transformation---plots">Log transformation - plots</a></li>
  <li><a href="#sample-wise-normalization" id="toc-sample-wise-normalization" class="nav-link" data-scroll-target="#sample-wise-normalization">Sample wise normalization</a></li>
  <li><a href="#assessing-data-quality" id="toc-assessing-data-quality" class="nav-link" data-scroll-target="#assessing-data-quality">Assessing data quality</a></li>
  <li><a href="#overlay-your-bpcs" id="toc-overlay-your-bpcs" class="nav-link" data-scroll-target="#overlay-your-bpcs">Overlay your BPCs</a></li>
  <li><a href="#zoom-in-and-look-at-your-bpcs-carefully" id="toc-zoom-in-and-look-at-your-bpcs-carefully" class="nav-link" data-scroll-target="#zoom-in-and-look-at-your-bpcs-carefully">Zoom in and look at your BPCs carefully</a></li>
  <li><a href="#look-at-a-single-feature-for-retention-time-shifting" id="toc-look-at-a-single-feature-for-retention-time-shifting" class="nav-link" data-scroll-target="#look-at-a-single-feature-for-retention-time-shifting">Look at a single feature for retention time shifting</a></li>
  <li><a href="#create-boxplots-of-features-by-sample" id="toc-create-boxplots-of-features-by-sample" class="nav-link" data-scroll-target="#create-boxplots-of-features-by-sample">Create boxplots of features by sample</a></li>
  <li><a href="#your-qcs-should-cluster-in-a-pca" id="toc-your-qcs-should-cluster-in-a-pca" class="nav-link" data-scroll-target="#your-qcs-should-cluster-in-a-pca">Your QCs should cluster in a PCA</a></li>
  <li><a href="#data-analysis-can-be-unsupervised-or-supervised" id="toc-data-analysis-can-be-unsupervised-or-supervised" class="nav-link" data-scroll-target="#data-analysis-can-be-unsupervised-or-supervised">Data analysis can be unsupervised or supervised</a></li>
  <li><a href="#unsupervised-principal-components-analysis-pca" id="toc-unsupervised-principal-components-analysis-pca" class="nav-link" data-scroll-target="#unsupervised-principal-components-analysis-pca">Unsupervised: Principal Components Analysis (PCA)</a></li>
  <li><a href="#interpreting-pcas" id="toc-interpreting-pcas" class="nav-link" data-scroll-target="#interpreting-pcas">Interpreting PCAs</a></li>
  <li><a href="#what-you-should-be-doing-with-your-pcas" id="toc-what-you-should-be-doing-with-your-pcas" class="nav-link" data-scroll-target="#what-you-should-be-doing-with-your-pcas">What you should be doing with your PCAs</a></li>
  <li><a href="#unsupervised-hierarchical-clustering-analysis-hca" id="toc-unsupervised-hierarchical-clustering-analysis-hca" class="nav-link" data-scroll-target="#unsupervised-hierarchical-clustering-analysis-hca">Unsupervised: Hierarchical Clustering Analysis (HCA)</a></li>
  <li><a href="#hca-applied-to-metabolomics" id="toc-hca-applied-to-metabolomics" class="nav-link" data-scroll-target="#hca-applied-to-metabolomics">HCA applied to metabolomics</a></li>
  <li><a href="#unsupervised-k-means-clustering" id="toc-unsupervised-k-means-clustering" class="nav-link" data-scroll-target="#unsupervised-k-means-clustering">Unsupervised: K-means clustering</a></li>
  <li><a href="#supervised-univariate-testing-the-categories" id="toc-supervised-univariate-testing-the-categories" class="nav-link" data-scroll-target="#supervised-univariate-testing-the-categories">Supervised: Univariate testing, the categories</a></li>
  <li><a href="#big-p-little-n-the-curse-of-dimensionality" id="toc-big-p-little-n-the-curse-of-dimensionality" class="nav-link" data-scroll-target="#big-p-little-n-the-curse-of-dimensionality">Big p, little n: the curse of dimensionality</a></li>
  <li><a href="#ways-to-control-for-multiple-testing" id="toc-ways-to-control-for-multiple-testing" class="nav-link" data-scroll-target="#ways-to-control-for-multiple-testing">Ways to control for multiple testing</a></li>
  <li><a href="#should-i-use-parametric-or-non-parametric-tests" id="toc-should-i-use-parametric-or-non-parametric-tests" class="nav-link" data-scroll-target="#should-i-use-parametric-or-non-parametric-tests">Should I use parametric or non-parametric tests?</a></li>
  <li><a href="#multivariate-testing-in-metabolomics" id="toc-multivariate-testing-in-metabolomics" class="nav-link" data-scroll-target="#multivariate-testing-in-metabolomics">Multivariate testing in metabolomics</a></li>
  <li><a href="#supervised-pls-da" id="toc-supervised-pls-da" class="nav-link" data-scroll-target="#supervised-pls-da">Supervised: PLS-DA</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="04_data-analysis.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of metabolomics data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jessica Cooperstone </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="now-that-we-have-our-feature-table-what-happens-next" class="level2">
<h2 class="anchored" data-anchor-id="now-that-we-have-our-feature-table-what-happens-next">Now that we have our feature table, what happens next?</h2>
<ul>
<li>Data normalization/transformation/scaling</li>
<li>Assess for quality (and make adjustments if needed)</li>
<li>Univariate analysis (supervised)</li>
<li>Multivariate analysis (supervised or unsupervised)</li>
</ul>
</section>
<section id="data-pre-treatment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data-pre-treatment">Data pre-treatment</h2>
<p><img src="img/04/center-scaling-transformation.png" class="img-fluid"></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>From <a href="https://doi.org/10.1186/1471-2164-7-142">van den Berg et al., Genomics 2006</a></p>
</div></div></section>
<section id="centering" class="level2" style="font-size: 23px">
<h2 style="font-size: 23px" class="anchored" data-anchor-id="centering">Centering</h2>
<ul>
<li>Centering converts all relative intensities to be centered around zero instead of around mean concentrations</li>
<li>This is particularly useful in metabolomics given that more <em>intense</em> features are <em>not necessarily more abundant</em></li>
<li>I like to center when conducting principal components analysis (PCA, more on this later)</li>
</ul>
<div class="columns">
<div class="column fragment" style="font-size: 23px">
<p><img src="img/04/pca_not_centered.png" class="img-fluid" style="width:80.0%"></p>
</div><div class="column fragment" style="font-size: 23px">
<p><img src="img/04/pca_centered.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
</section>
<section id="scaling" class="level2">
<h2 class="anchored" data-anchor-id="scaling">Scaling</h2>
<ul>
<li>Uses data dispersion as a part of a scaling factor
<ul>
<li>Auto scaling: mean = 0, standard deviation = 1 (for each feature)</li>
<li>Pareto scaling: like auto but scaled to square root of the st dev. The most common scaling used for metabolomics</li>
<li>In general I find this not necessary and will just log transform (more coming next)</li>
</ul></li>
</ul>
</section>
<section id="log-transformation---tables" class="level2">
<h2 class="anchored" data-anchor-id="log-transformation---tables">Log transformation - tables</h2>
<ul>
<li>Reduce heteroscedasicity</li>
<li>Makes large values proportionally smaller than small ones</li>
<li>Makes distributions more normal</li>
</ul>
<div class="columns">
<div class="column fragment" style="font-size: 23px">
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">sample</th>
<th style="text-align: right;">feature_1</th>
<th style="text-align: right;">feature_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">10000</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">11000</td>
<td style="text-align: right;">2000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column fragment" style="font-size: 23px">
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">sample</th>
<th style="text-align: right;">log2_feature_1</th>
<th style="text-align: right;">log2_feature_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">13.29</td>
<td style="text-align: right;">9.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">13.43</td>
<td style="text-align: right;">10.97</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="log-transformation---plots" class="level2">
<h2 class="anchored" data-anchor-id="log-transformation---plots">Log transformation - plots</h2>
<ul>
<li>Log transforming can make your data look more normally distributed</li>
</ul>
<div class="columns">
<div class="column fragment" style="font-size: 25px">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="04_data-analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div><div class="column fragment" style="font-size: 25px">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="04_data-analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="sample-wise-normalization" class="level2">
<h2 class="anchored" data-anchor-id="sample-wise-normalization">Sample wise normalization</h2>
<ul>
<li>Adjust based on weight or volume (very common)</li>
<li>Adjust based on intensity of an internal standard (used sometimes)</li>
<li>Adjust based on total signal (used in older MS papers and for NMR but not really in MS)</li>
</ul>
</section>
<section id="assessing-data-quality" class="level2">
<h2 class="anchored" data-anchor-id="assessing-data-quality">Assessing data quality</h2>
<ul>
<li>How can we go about assessing if our data is of high quality when we have thousands of features and don’t know what to expect?</li>
</ul>
</section>
<section id="overlay-your-bpcs" class="level2">
<h2 class="anchored" data-anchor-id="overlay-your-bpcs">Overlay your BPCs</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/qc-bpc.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Overlaid base peak chromatograms in MZmine</figcaption>
</figure>
</div>
</section>
<section id="zoom-in-and-look-at-your-bpcs-carefully" class="level2">
<h2 class="anchored" data-anchor-id="zoom-in-and-look-at-your-bpcs-carefully">Zoom in and look at your BPCs carefully</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/qc-bpc-zoom.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Overlaid base peak chromatograms in MassHunter</figcaption>
</figure>
</div>
</section>
<section id="look-at-a-single-feature-for-retention-time-shifting" class="level2">
<h2 class="anchored" data-anchor-id="look-at-a-single-feature-for-retention-time-shifting">Look at a single feature for retention time shifting</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/qc-eic-zoom.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Overlaid extracted ion chromatograms in MassHunter</figcaption>
</figure>
</div>
</section>
<section id="create-boxplots-of-features-by-sample" class="level2">
<h2 class="anchored" data-anchor-id="create-boxplots-of-features-by-sample">Create boxplots of features by sample</h2>
<div class="columns">
<div class="column" style="font-size: 25px">
<p>Ordering by sample groups <img src="img/04/quality-boxplot-log2.png" class="img-fluid"></p>
</div><div class="column" style="font-size: 25px">
<p>Ordering by run order <img src="img/04/quality-boxplot-log2-run-order.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="your-qcs-should-cluster-in-a-pca" class="level2">
<h2 class="anchored" data-anchor-id="your-qcs-should-cluster-in-a-pca">Your QCs should cluster in a PCA</h2>
<p><img src="img/04/pca_centered.png" class="img-fluid"></p>
</section>
<section id="data-analysis-can-be-unsupervised-or-supervised" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis-can-be-unsupervised-or-supervised">Data analysis can be unsupervised or supervised</h2>
<div class="columns">
<div class="column" style="font-size: 25px">
<section id="unsupervised-model-does-not-know-which-samples-belong-to-which-groups" class="level3">
<h3 class="anchored" data-anchor-id="unsupervised-model-does-not-know-which-samples-belong-to-which-groups">Unsupervised (model does not know which samples belong to which groups):</h3>
<ul>
<li>Principal components analysis (PCA)</li>
<li>Hierarchical clustering analysis (HCA)</li>
<li>K-means clustering</li>
</ul>
</section>
</div><div class="column" style="font-size: 25px">
<section id="supervised-model-knows-group-composition" class="level3">
<h3 class="anchored" data-anchor-id="supervised-model-knows-group-composition">Supervised (model knows group composition):</h3>
<ul>
<li>Univariate (or multivariate) group comparisons</li>
<li>Predictive/classification models
<ul>
<li>Partial least squares regression (PLS-R)</li>
<li>PLS-discriminant analysis (PLS-DA)</li>
<li>Random forest</li>
<li>Artificial neural networks</li>
<li>Others</li>
</ul></li>
</ul>
</section>
</div>
</div>
</section>
<section id="unsupervised-principal-components-analysis-pca" class="level2">
<h2 class="anchored" data-anchor-id="unsupervised-principal-components-analysis-pca">Unsupervised: Principal Components Analysis (PCA)</h2>
<div class="columns">
<div class="column" style="font-size: 25px">
<ul>
<li>A dimensionality reduction approach that transforms our data into a new system where principal coordinates (PCs) are drawn maximizing variation in our data.</li>
<li>Each new PC is orthogonal to the previous one.</li>
<li>Can interpret points closer together as more similar that those further apart</li>
<li>The loadings plot helps us understand which features are most influential for each PC</li>
</ul>
</div><div class="column fragment" style="font-size: 25px">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/pca-explained.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Fig from <a href="https://www.ibm.com/topics/principal-component-analysis">https://www.ibm.com/topics/principal-component-analysis</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interpreting-pcas" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="interpreting-pcas">Interpreting PCAs</h2>
<p><img src="img/04/pca-interpretation.png" class="img-fluid"></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>PCA A) scores and B) loadings (from <a href="https://doi.org/10.1002/tpg2.20192">Dzakovich et al., 2022</a>)</p>
</div></div></section>
<section id="what-you-should-be-doing-with-your-pcas" class="level2">
<h2 class="anchored" data-anchor-id="what-you-should-be-doing-with-your-pcas">What you should be doing with your PCAs</h2>
<ul>
<li>Check for samples that are very different from the rest</li>
<li>Show that your QCs cluster together</li>
<li>Look for batch effects</li>
<li>Observe the distance between your samples within a group, and between groups</li>
<li>See how much variation is being explained by each PC</li>
<li>Look for clusters in your data</li>
</ul>
</section>
<section id="unsupervised-hierarchical-clustering-analysis-hca" class="level2">
<h2 class="anchored" data-anchor-id="unsupervised-hierarchical-clustering-analysis-hca">Unsupervised: Hierarchical Clustering Analysis (HCA)</h2>
<ul>
<li>An approach “cluster” samples based on their distance/similarity</li>
<li>Find two most similar samples and merge into cluster, and repeat</li>
<li>Different methods for determining both distance and linkage</li>
<li>Think of these like a phylogenic tree - samples that are closer together are more similar</li>
<li>Can cluster samples, features, or both</li>
<li><a href="https://www.youtube.com/watch?v=7xHsRkOdVwo">StatQuest video on hierarchical clustering</a></li>
</ul>
</section>
<section id="hca-applied-to-metabolomics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hca-applied-to-metabolomics">HCA applied to metabolomics</h2>
<p><img src="img/04/hca-example.jpeg" class="img-fluid"></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>From <a href="https://doi.org/10.1002/mnfr.202300239">Dzakovich et al., 2024</a></p>
</div></div></section>
<section id="unsupervised-k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="unsupervised-k-means-clustering">Unsupervised: K-means clustering</h2>
<div class="columns">
<div class="column" style="font-size: 25px">
<ul>
<li>Randomly assigns all samples to be a part of <span class="math inline">\(k\)</span> clusters</li>
<li>Calculates centroids and assigns samples to the nearest one</li>
<li>Iterates until centroids stability or reach some maximum</li>
<li>Can figure out number of clusters using a scree plot to visualize within cluster sums</li>
<li><a href="https://www.youtube.com/watch?v=4b5d3muPQmA">StatQuest explains K-means clustering</a></li>
</ul>
</div><div class="column fragment" style="font-size: 25px">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/e/ea/K-means_convergence.gif" class="img-fluid"></p>
</div>
</div>
</section>
<section id="supervised-univariate-testing-the-categories" class="level2">
<h2 class="anchored" data-anchor-id="supervised-univariate-testing-the-categories">Supervised: Univariate testing, the categories</h2>
<ul>
<li>Two group tests
<ul>
<li>t-test (parametric)</li>
<li>Wilcoxon rank sum test (non-parameric)</li>
</ul></li>
<li>More than two group tests
<ul>
<li>ANOVA (parametric)</li>
<li>Kruskal Wallis test (non-parametric)</li>
<li>Both followed by post-hoc means separation</li>
</ul></li>
</ul>
</section>
<section id="big-p-little-n-the-curse-of-dimensionality" class="level2 incremental" style="font-size: 30px">
<h2 class="incremental anchored" style="font-size: 30px" data-anchor-id="big-p-little-n-the-curse-of-dimensionality">Big p, little n: the curse of dimensionality</h2>
<ul>
<li>With metabolomics, we almost always have more features (p) than samples (n)</li>
<li>This means we are making a lot of comparisons</li>
<li>If we want to know if each figure is differentially abundant across two groups, we can do a series of t-tests.</li>
<li>If we set α = 0.05, then we have a 5% chance for rejecting the null when it is true (false positive, type I error)</li>
<li>If we do 1000 tests, and each one has a 5% of a false positive, then we would predict to have 50 false positives due to chance alone - features that have p &lt; 0.05 but are not truly different between our groups</li>
</ul>
</section>
<section id="ways-to-control-for-multiple-testing" class="level2">
<h2 class="anchored" data-anchor-id="ways-to-control-for-multiple-testing">Ways to control for multiple testing</h2>
<ul>
<li>Bonferroni correction: <span class="math inline">\(α/number\,of\,comparisons\)</span> (very conservative, leads to false negatives)</li>
<li>Benjamini Hochberg false discovery rate correction: adjust overall error rate to be α (tries to balance false negatives and positives)</li>
</ul>
<div class="fragment" style="font-size: 15px">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/fdr.png" class="img-fluid figure-img" width="800"></p>
</figure>
</div>
<p>Fig. from <a href="https://geneviatechnologies.com/blog/what-is-multiple-testing-correction/">https://geneviatechnologies.com/blog/what-is-multiple-testing-correction/</a></p>
</div>
</section>
<section id="should-i-use-parametric-or-non-parametric-tests" class="level2">
<h2 class="anchored" data-anchor-id="should-i-use-parametric-or-non-parametric-tests">Should I use parametric or non-parametric tests?</h2>
</section>
<section id="multivariate-testing-in-metabolomics" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-testing-in-metabolomics">Multivariate testing in metabolomics</h2>
<ul>
<li>Multivariate approaches allow the investigation of more than one feature at once</li>
<li>Approaches can be unsupervised or supervised</li>
<li>Be sure to select the most appropriate method given the nature of your data and question</li>
</ul>
</section>
<section id="supervised-pls-da" class="level2">
<h2 class="anchored" data-anchor-id="supervised-pls-da">Supervised: PLS-DA</h2>
<ul>
<li>Partial least squares discriminate analysis (PLS-DA) approaches optimize separation between groups</li>
<li>Two data matrices, X: contains your features, Y: contains group identity</li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Created with RStudio and <a href="https://quarto.org/">Quarto</a> <br> © Jessica Cooperstone, 2024, License: <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a> <br> <a href="https://osu-codeclub.github.io/#category=website">Want to make a website like this one?</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>