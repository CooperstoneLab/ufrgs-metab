[
  {
    "objectID": "lectures/02_design-collection.html#the-idea-behind-design-and-sampling",
    "href": "lectures/02_design-collection.html#the-idea-behind-design-and-sampling",
    "title": "Study design and sample collection",
    "section": "The idea behind design and sampling",
    "text": "The idea behind design and sampling\n\n\nThe samples you choose should be representative of the broader population you wish to study\nThe variability between your groups should be due to your research question (and not some other thing)"
  },
  {
    "objectID": "lectures/02_design-collection.html#types-of-replicates",
    "href": "lectures/02_design-collection.html#types-of-replicates",
    "title": "Study design and sample collection",
    "section": "Types of replicates",
    "text": "Types of replicates"
  },
  {
    "objectID": "lectures/02_design-collection.html#sources-of-variation-in-samples",
    "href": "lectures/02_design-collection.html#sources-of-variation-in-samples",
    "title": "Study design and sample collection",
    "section": "Sources of variation in samples",
    "text": "Sources of variation in samples\n\n\nExperimental (due to our question):\n\nNon-experimental (due to things other than our question)\n\nPersonnel\nCollection materials\nStorage (e.g., freeze-thaw, age)\nInstrument issues\nRun order effects\n\n\n\n\nIdeally, measurement variability &lt;&lt;&lt; sample variability"
  },
  {
    "objectID": "lectures/02_design-collection.html#what-can-we-do-to-minimize-non-experimental-variation",
    "href": "lectures/02_design-collection.html#what-can-we-do-to-minimize-non-experimental-variation",
    "title": "Study design and sample collection",
    "section": "What can we do to minimize non-experimental variation?",
    "text": "What can we do to minimize non-experimental variation?\n\n\nConsistency!\nChoose appropriate controls\nEnsure sample groups are handled in the same way\nRandomize extraction order\nRandomize run order\nRun in one batch"
  },
  {
    "objectID": "lectures/02_design-collection.html#quality-control-qc-samples",
    "href": "lectures/02_design-collection.html#quality-control-qc-samples",
    "title": "Study design and sample collection",
    "section": "Quality control (QC) samples",
    "text": "Quality control (QC) samples\n\n\nHow do we know if our data looks ‚Äòokay‚Äô if we don‚Äôt know what it‚Äôs supposed to look like?\nPooled QCs, commercial QCs, synthetic QCs\n\n\n\n\n\n\n\n\nFig. adapted from Broadhurst et al., Metabolomics 2018"
  },
  {
    "objectID": "lectures/02_design-collection.html#processextraction-blanks",
    "href": "lectures/02_design-collection.html#processextraction-blanks",
    "title": "Study design and sample collection",
    "section": "Process/extraction blanks",
    "text": "Process/extraction blanks\n\n\nTo remove signal that comes from the non-sample parts of your extract, we run process blanks\nThese consist of all components of your extraction minus the sample\n\nIf you are extracting tomato juice with methanol, you would instead take an equal volume of water and ‚Äúextract‚Äù using the identical process\n\nThis allows the removal of signal coming from: tips, vials, extraction aids, solvents, tubing, your dirty MS source etc"
  },
  {
    "objectID": "lectures/02_design-collection.html#run-order",
    "href": "lectures/02_design-collection.html#run-order",
    "title": "Study design and sample collection",
    "section": "Run order",
    "text": "Run order\n\nFig. from John-Williams et al., Sci Data 2017"
  },
  {
    "objectID": "lectures/02_design-collection.html#qc-samples-should-cluster-together",
    "href": "lectures/02_design-collection.html#qc-samples-should-cluster-together",
    "title": "Study design and sample collection",
    "section": "QC samples should cluster together",
    "text": "QC samples should cluster together\n\nFig. adapted from Broadhurst et al., Metabolomics 2018"
  },
  {
    "objectID": "lectures/02_design-collection.html#qc-adjustment",
    "href": "lectures/02_design-collection.html#qc-adjustment",
    "title": "Study design and sample collection",
    "section": "QC adjustment",
    "text": "QC adjustment\n\nFig. from Dunn et al., Nature Protocols 2011"
  },
  {
    "objectID": "lectures/02_design-collection.html#sample-age",
    "href": "lectures/02_design-collection.html#sample-age",
    "title": "Study design and sample collection",
    "section": "Sample age",
    "text": "Sample age\n\nFig. from Kjeldahl and Bro, J Chemometrics 2010"
  },
  {
    "objectID": "lectures/02_design-collection.html#timing-of-collection",
    "href": "lectures/02_design-collection.html#timing-of-collection",
    "title": "Study design and sample collection",
    "section": "Timing of collection",
    "text": "Timing of collection\n\nFig. from Sato et al., Molecular Metabolism 2018"
  },
  {
    "objectID": "lectures/02_design-collection.html#collection-tube-impact",
    "href": "lectures/02_design-collection.html#collection-tube-impact",
    "title": "Study design and sample collection",
    "section": "Collection tube impact",
    "text": "Collection tube impact\n\nFig. from Cruickshank-Quinn et al., Metabolites 2018"
  },
  {
    "objectID": "lectures/02_design-collection.html#collection-variables-to-consider",
    "href": "lectures/02_design-collection.html#collection-variables-to-consider",
    "title": "Study design and sample collection",
    "section": "Collection variables to consider",
    "text": "Collection variables to consider\n\n\nTubes\nStorage\nFreeze-thaw\nQuenching"
  },
  {
    "objectID": "lectures/02_design-collection.html#standarizing-extraction-amoung",
    "href": "lectures/02_design-collection.html#standarizing-extraction-amoung",
    "title": "Study design and sample collection",
    "section": "Standarizing extraction amoung",
    "text": "Standarizing extraction amoung\nCompare samples by:\n\n\nMass\nVolume\nNumber of cells\nNormalized to protein\nSome other thing?"
  },
  {
    "objectID": "lectures/02_design-collection.html#when-starting-a-metabolomics-study",
    "href": "lectures/02_design-collection.html#when-starting-a-metabolomics-study",
    "title": "Study design and sample collection",
    "section": "When starting a metabolomics study‚Ä¶",
    "text": "When starting a metabolomics study‚Ä¶\n\n\nPurchase one lot of materials (solvents, reagents, vials etc.)\nStore many, small volume aliquots to avoid freeze-thaw\nDecide what your QCs will be and act accordingly\nBe consistent ‚Äì generate a plan!\nBe especially careful when conducting a secondary analysis of already collected data\n\n\n\n\n\n¬© Jessica Cooperstone, 2024"
  },
  {
    "objectID": "lectures/01_intro.html#introductions",
    "href": "lectures/01_intro.html#introductions",
    "title": "Introduction to metabolomics",
    "section": "Introductions üëã",
    "text": "Introductions üëã\n\n\nName\nResearch focus area\nHow you see yourself using metabolomics\nWhat you hope to learn"
  },
  {
    "objectID": "lectures/01_intro.html#what-is-metabolomics",
    "href": "lectures/01_intro.html#what-is-metabolomics",
    "title": "Introduction to metabolomics",
    "section": "What is metabolomics?",
    "text": "What is metabolomics?\n\n\nThe study of the totality of small molecules (&lt; 1500 Da) within a given system\nMetabolomics is a tool that allows us to study global metabolism"
  },
  {
    "objectID": "lectures/01_intro.html#metabolites-are-the-downstream-products-of-the-system-biology-cascade",
    "href": "lectures/01_intro.html#metabolites-are-the-downstream-products-of-the-system-biology-cascade",
    "title": "Introduction to metabolomics",
    "section": "Metabolites are the downstream products of the system biology cascade",
    "text": "Metabolites are the downstream products of the system biology cascade"
  },
  {
    "objectID": "lectures/01_intro.html#the-food-metabolome-can-be-influenced-by",
    "href": "lectures/01_intro.html#the-food-metabolome-can-be-influenced-by",
    "title": "Introduction to metabolomics",
    "section": "The food metabolome can be influenced by:",
    "text": "The food metabolome can be influenced by:\n\n\nVariety/genetics\nEnvironment\nPost-harvest/processing\nStorage"
  },
  {
    "objectID": "lectures/01_intro.html#the-metabolome-is-really-big",
    "href": "lectures/01_intro.html#the-metabolome-is-really-big",
    "title": "Introduction to metabolomics",
    "section": "The metabolome is really BIG!",
    "text": "The metabolome is really BIG!\n\n\n\nAdapted from David Wishart‚Äôs Canadian Bioinformatics Workshop"
  },
  {
    "objectID": "lectures/01_intro.html#the-metabolome-is-very-chemically-diverse",
    "href": "lectures/01_intro.html#the-metabolome-is-very-chemically-diverse",
    "title": "Introduction to metabolomics",
    "section": "The metabolome is very chemically diverse",
    "text": "The metabolome is very chemically diverse\n\n\nFrom Roche, Biochemical Pathways"
  },
  {
    "objectID": "lectures/01_intro.html#the-metabolome-is-constantly-changing",
    "href": "lectures/01_intro.html#the-metabolome-is-constantly-changing",
    "title": "Introduction to metabolomics",
    "section": "The metabolome is constantly changing",
    "text": "The metabolome is constantly changing"
  },
  {
    "objectID": "lectures/01_intro.html#how-is-metabolomics-different-from-targeted-analyses",
    "href": "lectures/01_intro.html#how-is-metabolomics-different-from-targeted-analyses",
    "title": "Introduction to metabolomics",
    "section": "How is metabolomics different from targeted analyses?",
    "text": "How is metabolomics different from targeted analyses?\n\n\nMetabolomics:\n\n100s-1,000s of analytes\nWork on the back end\nComparative (i.e.¬†relative concentration)\n\n\nTargeted analyses:\n\n1-20 analytes\nWork on the front end\nQuantitative (i.e.¬†absolute concentration)"
  },
  {
    "objectID": "lectures/01_intro.html#metabolomics-workflow",
    "href": "lectures/01_intro.html#metabolomics-workflow",
    "title": "Introduction to metabolomics",
    "section": "Metabolomics workflow",
    "text": "Metabolomics workflow"
  },
  {
    "objectID": "lectures/01_intro.html#metabolomics-is-a-comparative-analysis",
    "href": "lectures/01_intro.html#metabolomics-is-a-comparative-analysis",
    "title": "Introduction to metabolomics",
    "section": "Metabolomics is a comparative analysis",
    "text": "Metabolomics is a comparative analysis\n\n\nWhat can food scientists use metabolomics for?\nIf you have specific compounds of interest, develop a targeted method!"
  },
  {
    "objectID": "lectures/01_intro.html#what-do-we-want-to-compare",
    "href": "lectures/01_intro.html#what-do-we-want-to-compare",
    "title": "Introduction to metabolomics",
    "section": "What do we want to compare?",
    "text": "What do we want to compare?\n\n\nIt‚Äôs critical to select comparable samples as our approach is comparative.\nFoods: plants, animal products, raw ingredients, finished product\nBiological sample: plasma, urine, tissue, other fluids, cells"
  },
  {
    "objectID": "lectures/01_intro.html#preparation-dictates-compounds-detected",
    "href": "lectures/01_intro.html#preparation-dictates-compounds-detected",
    "title": "Introduction to metabolomics",
    "section": "Preparation dictates compounds detected",
    "text": "Preparation dictates compounds detected\n\n\n\nYou can only detect what you present to an instrument for analysis\nSample prep depends on intended method of analysis (e.g., water extraction, polar compounds; non-polar extraction, non-polar compounds)\nDilute, centrifuge/filter, inject (e.g.¬†urine, juice, olive oil)"
  },
  {
    "objectID": "lectures/01_intro.html#collect-comprehensive-metabolite-data",
    "href": "lectures/01_intro.html#collect-comprehensive-metabolite-data",
    "title": "Introduction to metabolomics",
    "section": "Collect comprehensive metabolite data",
    "text": "Collect comprehensive metabolite data\n\n3 most popular methods for analysis:\n\nLiquid-chromatography, mass spectrometry (LC-MS)\nGas chromatpgrahy, MS (GC-MS)\nNuclear magnetic resonance spectroscopy (NMR)\n\n\nAll methods have benefits and drawbacks"
  },
  {
    "objectID": "lectures/01_intro.html#convert-spectral-data-into-feature-table",
    "href": "lectures/01_intro.html#convert-spectral-data-into-feature-table",
    "title": "Introduction to metabolomics",
    "section": "Convert spectral data into feature table",
    "text": "Convert spectral data into feature table\n\n\n\nFrom raw spectra, ions are selected, chromatograms drawn, peaks detected, masses and retention times aligned, features dereplicated\nResult is a data file that includes m/z, retention time, compound identifier (usually mz_rt), and relative abundance of each feature in each sample\nWith MZmine, samples are columns, features are rows"
  },
  {
    "objectID": "lectures/01_intro.html#use-statistics-and-chemometrics-to-understand-group-differences",
    "href": "lectures/01_intro.html#use-statistics-and-chemometrics-to-understand-group-differences",
    "title": "Introduction to metabolomics",
    "section": "Use statistics and chemometrics to understand group differences",
    "text": "Use statistics and chemometrics to understand group differences\n\n\n\nSignificance testing (e.g., t-test, Wilcoxon rank sum test, ANOVA)\nUnsupervised analyses (e.g., PCA, hierarchical clustering)\nSupervised analyses (e.g., PLS-DA or PLS-R, random forest)"
  },
  {
    "objectID": "lectures/01_intro.html#what-metabolites-do-we-have",
    "href": "lectures/01_intro.html#what-metabolites-do-we-have",
    "title": "Introduction to metabolomics",
    "section": "What metabolites do we have?",
    "text": "What metabolites do we have?\n\n\n\nSearching publicly available databases (e.g., HMDB, METLIN, GNPS) at the MS1 and MS2 level\nConduct MS/MS experiments\nComparison with authentic standards"
  },
  {
    "objectID": "lectures/01_intro.html#putting-findings-into-a-broader-context",
    "href": "lectures/01_intro.html#putting-findings-into-a-broader-context",
    "title": "Introduction to metabolomics",
    "section": "Putting findings into a broader context",
    "text": "Putting findings into a broader context\n\n\n\nUnderstanding which metabolic pathways are most deregulated\nTypically for enzymatic pathways\nRequires compound IDs (a big limitation)"
  },
  {
    "objectID": "lectures/01_intro.html#ensure-findings-are-real-and-reproducible",
    "href": "lectures/01_intro.html#ensure-findings-are-real-and-reproducible",
    "title": "Introduction to metabolomics",
    "section": "Ensure findings are real and reproducible",
    "text": "Ensure findings are real and reproducible\n\n\n\nMass spectrometry is not inherently quantitative (i.e., if the intensity of analyte A is higher than analyte B, it doesn‚Äôt necessarily mean there is more of A than B)\nKnowing the absolute concentration allows comparison with literature/other data\nValidation in a separate sample set ensures robustness"
  },
  {
    "objectID": "lectures/01_intro.html#metabolomics-workflow-1",
    "href": "lectures/01_intro.html#metabolomics-workflow-1",
    "title": "Introduction to metabolomics",
    "section": "Metabolomics workflow",
    "text": "Metabolomics workflow\n\n\n\n\n¬© Jessica Cooperstone, 2024"
  },
  {
    "objectID": "lectures/03_lc-ms.html#chromatography",
    "href": "lectures/03_lc-ms.html#chromatography",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Chromatography",
    "text": "Chromatography\n\n\nThe process of separating components of a mixture\nBased on an analytes‚Äô difference in partitioning between a stationary and mobile phases\n\n\n\nhttps://en.wikipedia.org/wiki/Chromatography"
  },
  {
    "objectID": "lectures/03_lc-ms.html#types-of-liquid-chromatography",
    "href": "lectures/03_lc-ms.html#types-of-liquid-chromatography",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Types of liquid chromatography",
    "text": "Types of liquid chromatography\n\n\n\n\nReversed phase\nNormal phase\nHILIC (hydrophilic interaction liquid chromatography)"
  },
  {
    "objectID": "lectures/03_lc-ms.html#mass-spectrometry",
    "href": "lectures/03_lc-ms.html#mass-spectrometry",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Mass spectrometry",
    "text": "Mass spectrometry"
  },
  {
    "objectID": "lectures/03_lc-ms.html#specifics-about-ms",
    "href": "lectures/03_lc-ms.html#specifics-about-ms",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Specifics about MS",
    "text": "Specifics about MS\n\n\nRequires gas phase ionization (no charge, no signal!)\nDifferent ionization methods (e.g., ESI vs.¬†APCI)\nInherently non-quantitative\n\nA higher signal for compound A than B doesn‚Äôt necessarily mean compound A is present in higher concentration\n\nIon suppression in complex mixtures"
  },
  {
    "objectID": "lectures/03_lc-ms.html#mass-analyzer-time-of-flight-tof-or-qtof",
    "href": "lectures/03_lc-ms.html#mass-analyzer-time-of-flight-tof-or-qtof",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Mass analyzer: time of flight (TOF or QTOF)",
    "text": "Mass analyzer: time of flight (TOF or QTOF)\n Allen and McWhinney, Clin Biochem Red 2019"
  },
  {
    "objectID": "lectures/03_lc-ms.html#mass-analyzer-orbitrap",
    "href": "lectures/03_lc-ms.html#mass-analyzer-orbitrap",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Mass analyzer: Orbitrap",
    "text": "Mass analyzer: Orbitrap\n\nhttps://www.youtube.com/watch?v=j2_FVJr9xNk"
  },
  {
    "objectID": "lectures/03_lc-ms.html#ms-output",
    "href": "lectures/03_lc-ms.html#ms-output",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "MS output",
    "text": "MS output"
  },
  {
    "objectID": "lectures/03_lc-ms.html#ms-data-is-really-3d",
    "href": "lectures/03_lc-ms.html#ms-data-is-really-3d",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "MS data is really 3D",
    "text": "MS data is really 3D"
  },
  {
    "objectID": "lectures/03_lc-ms.html#different-ways-to-express-a-mass",
    "href": "lectures/03_lc-ms.html#different-ways-to-express-a-mass",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Different ways to express a mass",
    "text": "Different ways to express a mass\n\n\nNominal mass: sum of the integer masses of the constituent elements of a molecule (C=12, H=1)\nMonoisotopic mass: mass of a molecular given empirical formulate calculated using the exact mass of the most abundance isotope of each element (C=12.0000, H=1.0078)\nAverage mass: mass of a molecule given empirical formulate calculated using the weighted average mass for each element by isotopic abundance (C=12.0112, H=1.00797)\nC20H42\n\nNominal mass: (20 √ó 12) + (42 √ó 1) = 282\nMonoisotopic mass: (20 √ó 12.0000) + (42 √ó 1.0078) = 282.3276\nAverage mass: (20 √ó 12.0112) + (42 √ó 1.00797) = 282.5587"
  },
  {
    "objectID": "lectures/03_lc-ms.html#try-calculating-the-monoisotopic-mass",
    "href": "lectures/03_lc-ms.html#try-calculating-the-monoisotopic-mass",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Try calculating the monoisotopic mass",
    "text": "Try calculating the monoisotopic mass\n\n\nTomatidine C27H45NO2"
  },
  {
    "objectID": "lectures/03_lc-ms.html#example-rutin",
    "href": "lectures/03_lc-ms.html#example-rutin",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Example: Rutin",
    "text": "Example: Rutin"
  },
  {
    "objectID": "lectures/03_lc-ms.html#compare-accurate-mass-to-exact-mass-towards-compound-id",
    "href": "lectures/03_lc-ms.html#compare-accurate-mass-to-exact-mass-towards-compound-id",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Compare accurate mass to exact mass towards compound ID",
    "text": "Compare accurate mass to exact mass towards compound ID\n\n\n\n\n\nExact mass is calculated (theoretical)\nTheoretical mass is experimental determined (observed)\n\n\n\n\n\n\n\n\n\n\n\nExample:\n\nrutin observed (positive mode): 611.1613 m/z\nrutin theoretical: 610.1534"
  },
  {
    "objectID": "lectures/03_lc-ms.html#why-you-need-high-mass-accuracy-for-metabolomics",
    "href": "lectures/03_lc-ms.html#why-you-need-high-mass-accuracy-for-metabolomics",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Why you need high mass accuracy for metabolomics",
    "text": "Why you need high mass accuracy for metabolomics"
  },
  {
    "objectID": "lectures/03_lc-ms.html#standards-for-identity-reporting",
    "href": "lectures/03_lc-ms.html#standards-for-identity-reporting",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Standards for identity reporting",
    "text": "Standards for identity reporting\n\nFig. adapted from Sumner et al., Metabolomics 2007"
  },
  {
    "objectID": "lectures/03_lc-ms.html#converting-raw-spectra-into-a-feature-table-i.e.-pre-processing",
    "href": "lectures/03_lc-ms.html#converting-raw-spectra-into-a-feature-table-i.e.-pre-processing",
    "title": "LC-MS data acquisition and pre-processing",
    "section": "Converting raw spectra into a feature table (i.e., pre-processing)",
    "text": "Converting raw spectra into a feature table (i.e., pre-processing)\n\n\n\n\nVendor software:\n\nAgilent: Profinder\nWaters: Progenesis\nThermo: Compound Discoverer\nBruker: MetaboScape\nShimadzu: LabSolutions\n\nOpen source software:\n\nMZmine\nMSDial\nXCMS\nMetaboAnalyst\n\n\n\n\n\n\n\nCastillo et al., Chemometrics Intelligent Lab Systems 2011\n\n\n\n¬© Jessica Cooperstone, 2024"
  },
  {
    "objectID": "activities/05_R.html",
    "href": "activities/05_R.html",
    "title": "Data analysis with R",
    "section": "",
    "text": "We aren‚Äôt going to go over this in the workshop, but I wanted to show you an example of the workflow my team might use for doing the first pass analysis of metabolomics data. We are going to use the feature table directly from MZmine (without any filtering) and will conduct our filtering and analysis in R.\n\n\n\nlibrary(factoextra) # visualizing PCA results\nlibrary(glue) # for easy pasting\nlibrary(plotly) # quick interactive plots\nlibrary(proxyC) # more efficient large matrices\nlibrary(data.table) # easy transposing\nlibrary(janitor) # for cleaning names and checking duplicates\nlibrary(notame) # for collapsing ions coming from the same metabolite\nlibrary(doParallel) # for parallelizing notame specifically\nlibrary(patchwork) # for making multi-panel plots\nlibrary(rstatix) # for additional univariate functionality\n\n# this is at the end hoping that the default select will be that from dplyr\nlibrary(tidyverse) # for everything\n\nOnce you get deconvoluted data from MZmine or similar programs, you need to wrangle your data in such a way that you can conduct your analysis on it.\n\n\n\nFirst we want to read in our raw data. The code here is to read in data directly from MZmine.\n\nmetabdata &lt;- read_csv(file = \"data/Feature_list_MZmine_2560.csv\",\n                      col_names = TRUE) # has headers\n\nNew names:\nRows: 2560 Columns: 49\n‚îÄ‚îÄ Column specification\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Delimiter: \",\" dbl\n(48): row ID, row m/z, row retention time, HATS_402_041.mzML Peak height... lgl\n(1): ...49\n‚Ñπ Use `spec()` to retrieve the full column specification for this data. ‚Ñπ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n‚Ä¢ `` -&gt; `...49`\n\ndim(metabdata)\n\n[1] 2560   49\n\n# look at beginning of the dataset\nmetabdata[1:8, 1:8]\n\n# A tibble: 8 √ó 8\n  `row ID` `row m/z` `row retention time` `HATS_402_041.mzML Peak height`\n     &lt;dbl&gt;     &lt;dbl&gt;                &lt;dbl&gt;                           &lt;dbl&gt;\n1     3106      100.                2.78                           26623.\n2      364      101.                0.611                         105494.\n3      453      102.                0.641                         413981.\n4     5568      103.                3.98                            9505.\n5     2723      103.                2.54                          196964.\n6     1424      104.                1.07                           75342.\n7      397      104.                0.630                         911384.\n8      426      104.                0.629                        2498815 \n# ‚Ñπ 4 more variables: `HATS_403_037.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_404_040.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_401_022.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_408_043.mzML Peak height` &lt;dbl&gt;\n\n# how many features do we have?\nnrow(metabdata)\n\n[1] 2560\n\n\nNote there is no metadata included in this file. Just m/z, retention time, and a column for each sample, where values are peak heights. We are using peak height instead of peak area because it is less dependent on bad peak shape which you get sometimes with metabolomics.\n\ncolnames(metabdata)\n\n [1] \"row ID\"                          \"row m/z\"                        \n [3] \"row retention time\"              \"HATS_402_041.mzML Peak height\"  \n [5] \"HATS_403_037.mzML Peak height\"   \"HATS_404_040.mzML Peak height\"  \n [7] \"HATS_401_022.mzML Peak height\"   \"HATS_408_043.mzML Peak height\"  \n [9] \"HATS_405_025.mzML Peak height\"   \"HATS_406_055.mzML Peak height\"  \n[11] \"HATS_407_059.mzML Peak height\"   \"HATS_412_019.mzML Peak height\"  \n[13] \"HATS_409_056.mzML Peak height\"   \"HATS_410_018.mzML Peak height\"  \n[15] \"HATS_411_044.mzML Peak height\"   \"LA2213_602_035.mzML Peak height\"\n[17] \"LA2213_603_045.mzML Peak height\" \"LA2213_601_051.mzML Peak height\"\n[19] \"LA2213_604_016.mzML Peak height\" \"LA2213_605_017.mzML Peak height\"\n[21] \"LA2213_607_032.mzML Peak height\" \"LA2213_608_024.mzML Peak height\"\n[23] \"LA2213_606_033.mzML Peak height\" \"LA2213_609_058.mzML Peak height\"\n[25] \"LA2213_610_050.mzML Peak height\" \"LA2213_612_046.mzML Peak height\"\n[27] \"OH8243_801_036.mzML Peak height\" \"OH8243_802_026.mzML Peak height\"\n[29] \"OH8243_803_030.mzML Peak height\" \"OH8243_805_057.mzML Peak height\"\n[31] \"LA2213_611_061.mzML Peak height\" \"OH8243_804_029.mzML Peak height\"\n[33] \"OH8243_806_027.mzML Peak height\" \"OH8243_809_063.mzML Peak height\"\n[35] \"OH8243_807_053.mzML Peak height\" \"OH8243_810_049.mzML Peak height\"\n[37] \"OH8243_808_038.mzML Peak height\" \"OH8243_812_060.mzML Peak height\"\n[39] \"OH8243_811_028.mzML Peak height\" \"PB_02_006.mzML Peak height\"     \n[41] \"PB_03_007.mzML Peak height\"      \"PB_01_005.mzML Peak height\"     \n[43] \"QC_02_031.mzML Peak height\"      \"QC_04_047.mzML Peak height\"     \n[45] \"QC_01_023.mzML Peak height\"      \"QC_03_039.mzML Peak height\"     \n[47] \"QC_05_054.mzML Peak height\"      \"QC_06_062.mzML Peak height\"     \n[49] \"...49\"                          \n\n\nIt looks like we have an extra blank column at the end - if we look at our raw data we can see OH9243_811_028 is the last sample, so I am going to remove the last column\n\nmetabdata &lt;- metabdata[,-49]\n\ncolnames(metabdata)\n\n [1] \"row ID\"                          \"row m/z\"                        \n [3] \"row retention time\"              \"HATS_402_041.mzML Peak height\"  \n [5] \"HATS_403_037.mzML Peak height\"   \"HATS_404_040.mzML Peak height\"  \n [7] \"HATS_401_022.mzML Peak height\"   \"HATS_408_043.mzML Peak height\"  \n [9] \"HATS_405_025.mzML Peak height\"   \"HATS_406_055.mzML Peak height\"  \n[11] \"HATS_407_059.mzML Peak height\"   \"HATS_412_019.mzML Peak height\"  \n[13] \"HATS_409_056.mzML Peak height\"   \"HATS_410_018.mzML Peak height\"  \n[15] \"HATS_411_044.mzML Peak height\"   \"LA2213_602_035.mzML Peak height\"\n[17] \"LA2213_603_045.mzML Peak height\" \"LA2213_601_051.mzML Peak height\"\n[19] \"LA2213_604_016.mzML Peak height\" \"LA2213_605_017.mzML Peak height\"\n[21] \"LA2213_607_032.mzML Peak height\" \"LA2213_608_024.mzML Peak height\"\n[23] \"LA2213_606_033.mzML Peak height\" \"LA2213_609_058.mzML Peak height\"\n[25] \"LA2213_610_050.mzML Peak height\" \"LA2213_612_046.mzML Peak height\"\n[27] \"OH8243_801_036.mzML Peak height\" \"OH8243_802_026.mzML Peak height\"\n[29] \"OH8243_803_030.mzML Peak height\" \"OH8243_805_057.mzML Peak height\"\n[31] \"LA2213_611_061.mzML Peak height\" \"OH8243_804_029.mzML Peak height\"\n[33] \"OH8243_806_027.mzML Peak height\" \"OH8243_809_063.mzML Peak height\"\n[35] \"OH8243_807_053.mzML Peak height\" \"OH8243_810_049.mzML Peak height\"\n[37] \"OH8243_808_038.mzML Peak height\" \"OH8243_812_060.mzML Peak height\"\n[39] \"OH8243_811_028.mzML Peak height\" \"PB_02_006.mzML Peak height\"     \n[41] \"PB_03_007.mzML Peak height\"      \"PB_01_005.mzML Peak height\"     \n[43] \"QC_02_031.mzML Peak height\"      \"QC_04_047.mzML Peak height\"     \n[45] \"QC_01_023.mzML Peak height\"      \"QC_03_039.mzML Peak height\"     \n[47] \"QC_05_054.mzML Peak height\"      \"QC_06_062.mzML Peak height\"     \n\n\n\n\n\nYou might have deconvoluted more data than you plan to use in your analysis. For example, you may want to exclude the first bit and last bit of your run, since you do not expect to have good reproducibility in those areas.\nHere, we are filtering to only include features that elute between 0.5-7.5 min of this 10 min run. Let‚Äôs check what we have.\n\nrange(metabdata$`row retention time`)\n\n[1] 0.5184004 7.4863230\n\n\nOur data is already filtered for our desired retention time range, so we don‚Äôt need to do anything. Below is some code you could use to filter if you needed to.\n\nmetabdata_RTfilt &lt;- metabdata %&gt;%\n  filter(between(`row retention time`, 0.5, 7.5))\n\n# did it work?\nrange(metabdata_RTfilt$`row retention time`)\n\n# how many features do we have?\ndim(metabdata_RTfilt)"
  },
  {
    "objectID": "activities/05_R.html#read-in-data",
    "href": "activities/05_R.html#read-in-data",
    "title": "Data analysis with R",
    "section": "",
    "text": "First we want to read in our raw data. The code here is to read in data directly from MZmine.\n\nmetabdata &lt;- read_csv(file = \"data/Feature_list_MZmine_2560.csv\",\n                      col_names = TRUE) # has headers\n\nNew names:\nRows: 2560 Columns: 49\n‚îÄ‚îÄ Column specification\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Delimiter: \",\" dbl\n(48): row ID, row m/z, row retention time, HATS_402_041.mzML Peak height... lgl\n(1): ...49\n‚Ñπ Use `spec()` to retrieve the full column specification for this data. ‚Ñπ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n‚Ä¢ `` -&gt; `...49`\n\ndim(metabdata)\n\n[1] 2560   49\n\n# look at beginning of the dataset\nmetabdata[1:8, 1:8]\n\n# A tibble: 8 √ó 8\n  `row ID` `row m/z` `row retention time` `HATS_402_041.mzML Peak height`\n     &lt;dbl&gt;     &lt;dbl&gt;                &lt;dbl&gt;                           &lt;dbl&gt;\n1     3106      100.                2.78                           26623.\n2      364      101.                0.611                         105494.\n3      453      102.                0.641                         413981.\n4     5568      103.                3.98                            9505.\n5     2723      103.                2.54                          196964.\n6     1424      104.                1.07                           75342.\n7      397      104.                0.630                         911384.\n8      426      104.                0.629                        2498815 \n# ‚Ñπ 4 more variables: `HATS_403_037.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_404_040.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_401_022.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_408_043.mzML Peak height` &lt;dbl&gt;\n\n# how many features do we have?\nnrow(metabdata)\n\n[1] 2560\n\n\nNote there is no metadata included in this file. Just m/z, retention time, and a column for each sample, where values are peak heights. We are using peak height instead of peak area because it is less dependent on bad peak shape which you get sometimes with metabolomics.\n\ncolnames(metabdata)\n\n [1] \"row ID\"                          \"row m/z\"                        \n [3] \"row retention time\"              \"HATS_402_041.mzML Peak height\"  \n [5] \"HATS_403_037.mzML Peak height\"   \"HATS_404_040.mzML Peak height\"  \n [7] \"HATS_401_022.mzML Peak height\"   \"HATS_408_043.mzML Peak height\"  \n [9] \"HATS_405_025.mzML Peak height\"   \"HATS_406_055.mzML Peak height\"  \n[11] \"HATS_407_059.mzML Peak height\"   \"HATS_412_019.mzML Peak height\"  \n[13] \"HATS_409_056.mzML Peak height\"   \"HATS_410_018.mzML Peak height\"  \n[15] \"HATS_411_044.mzML Peak height\"   \"LA2213_602_035.mzML Peak height\"\n[17] \"LA2213_603_045.mzML Peak height\" \"LA2213_601_051.mzML Peak height\"\n[19] \"LA2213_604_016.mzML Peak height\" \"LA2213_605_017.mzML Peak height\"\n[21] \"LA2213_607_032.mzML Peak height\" \"LA2213_608_024.mzML Peak height\"\n[23] \"LA2213_606_033.mzML Peak height\" \"LA2213_609_058.mzML Peak height\"\n[25] \"LA2213_610_050.mzML Peak height\" \"LA2213_612_046.mzML Peak height\"\n[27] \"OH8243_801_036.mzML Peak height\" \"OH8243_802_026.mzML Peak height\"\n[29] \"OH8243_803_030.mzML Peak height\" \"OH8243_805_057.mzML Peak height\"\n[31] \"LA2213_611_061.mzML Peak height\" \"OH8243_804_029.mzML Peak height\"\n[33] \"OH8243_806_027.mzML Peak height\" \"OH8243_809_063.mzML Peak height\"\n[35] \"OH8243_807_053.mzML Peak height\" \"OH8243_810_049.mzML Peak height\"\n[37] \"OH8243_808_038.mzML Peak height\" \"OH8243_812_060.mzML Peak height\"\n[39] \"OH8243_811_028.mzML Peak height\" \"PB_02_006.mzML Peak height\"     \n[41] \"PB_03_007.mzML Peak height\"      \"PB_01_005.mzML Peak height\"     \n[43] \"QC_02_031.mzML Peak height\"      \"QC_04_047.mzML Peak height\"     \n[45] \"QC_01_023.mzML Peak height\"      \"QC_03_039.mzML Peak height\"     \n[47] \"QC_05_054.mzML Peak height\"      \"QC_06_062.mzML Peak height\"     \n[49] \"...49\"                          \n\n\nIt looks like we have an extra blank column at the end - if we look at our raw data we can see OH9243_811_028 is the last sample, so I am going to remove the last column\n\nmetabdata &lt;- metabdata[,-49]\n\ncolnames(metabdata)\n\n [1] \"row ID\"                          \"row m/z\"                        \n [3] \"row retention time\"              \"HATS_402_041.mzML Peak height\"  \n [5] \"HATS_403_037.mzML Peak height\"   \"HATS_404_040.mzML Peak height\"  \n [7] \"HATS_401_022.mzML Peak height\"   \"HATS_408_043.mzML Peak height\"  \n [9] \"HATS_405_025.mzML Peak height\"   \"HATS_406_055.mzML Peak height\"  \n[11] \"HATS_407_059.mzML Peak height\"   \"HATS_412_019.mzML Peak height\"  \n[13] \"HATS_409_056.mzML Peak height\"   \"HATS_410_018.mzML Peak height\"  \n[15] \"HATS_411_044.mzML Peak height\"   \"LA2213_602_035.mzML Peak height\"\n[17] \"LA2213_603_045.mzML Peak height\" \"LA2213_601_051.mzML Peak height\"\n[19] \"LA2213_604_016.mzML Peak height\" \"LA2213_605_017.mzML Peak height\"\n[21] \"LA2213_607_032.mzML Peak height\" \"LA2213_608_024.mzML Peak height\"\n[23] \"LA2213_606_033.mzML Peak height\" \"LA2213_609_058.mzML Peak height\"\n[25] \"LA2213_610_050.mzML Peak height\" \"LA2213_612_046.mzML Peak height\"\n[27] \"OH8243_801_036.mzML Peak height\" \"OH8243_802_026.mzML Peak height\"\n[29] \"OH8243_803_030.mzML Peak height\" \"OH8243_805_057.mzML Peak height\"\n[31] \"LA2213_611_061.mzML Peak height\" \"OH8243_804_029.mzML Peak height\"\n[33] \"OH8243_806_027.mzML Peak height\" \"OH8243_809_063.mzML Peak height\"\n[35] \"OH8243_807_053.mzML Peak height\" \"OH8243_810_049.mzML Peak height\"\n[37] \"OH8243_808_038.mzML Peak height\" \"OH8243_812_060.mzML Peak height\"\n[39] \"OH8243_811_028.mzML Peak height\" \"PB_02_006.mzML Peak height\"     \n[41] \"PB_03_007.mzML Peak height\"      \"PB_01_005.mzML Peak height\"     \n[43] \"QC_02_031.mzML Peak height\"      \"QC_04_047.mzML Peak height\"     \n[45] \"QC_01_023.mzML Peak height\"      \"QC_03_039.mzML Peak height\"     \n[47] \"QC_05_054.mzML Peak height\"      \"QC_06_062.mzML Peak height\""
  },
  {
    "objectID": "activities/05_R.html#rt-filter-if-necessary",
    "href": "activities/05_R.html#rt-filter-if-necessary",
    "title": "Data analysis with R",
    "section": "",
    "text": "You might have deconvoluted more data than you plan to use in your analysis. For example, you may want to exclude the first bit and last bit of your run, since you do not expect to have good reproducibility in those areas.\nHere, we are filtering to only include features that elute between 0.5-7.5 min of this 10 min run. Let‚Äôs check what we have.\n\nrange(metabdata$`row retention time`)\n\n[1] 0.5184004 7.4863230\n\n\nOur data is already filtered for our desired retention time range, so we don‚Äôt need to do anything. Below is some code you could use to filter if you needed to.\n\nmetabdata_RTfilt &lt;- metabdata %&gt;%\n  filter(between(`row retention time`, 0.5, 7.5))\n\n# did it work?\nrange(metabdata_RTfilt$`row retention time`)\n\n# how many features do we have?\ndim(metabdata_RTfilt)"
  },
  {
    "objectID": "activities/05_R.html#create-mz_rt",
    "href": "activities/05_R.html#create-mz_rt",
    "title": "Data analysis with R",
    "section": "Create mz_rt",
    "text": "Create mz_rt\nThis creates a unique identifier for each feature using its mass-to-charge ratio (m/z) and retention time (RT).\n\nMZ_RT &lt;- metabdata %&gt;%\n  rename(mz = `row m/z`,\n         rt = `row retention time`,\n         row_ID = `row ID`) %&gt;%\n  unite(mz_rt, c(mz, rt), remove = FALSE) %&gt;% # Combine m/z & rt with _ in between\n  select(row_ID, mz, rt, mz_rt, everything()) # reorder and move row_ID to front\n\n# how does our df look?\nMZ_RT[1:8, 1:8]\n\n# A tibble: 8 √ó 8\n  row_ID    mz    rt mz_rt         HATS_402_041.mzML Pe‚Ä¶¬π HATS_403_037.mzML Pe‚Ä¶¬≤\n   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                          &lt;dbl&gt;                  &lt;dbl&gt;\n1   3106  100. 2.78  100.11203254‚Ä¶                 26623.                 45481.\n2    364  101. 0.611 101.07092628‚Ä¶                105494.                104196.\n3    453  102. 0.641 102.05495781‚Ä¶                413981.                413246.\n4   5568  103. 3.98  103.05420188‚Ä¶                  9505.                 24041.\n5   2723  103. 2.54  103.05422465‚Ä¶                196964.                232544.\n6   1424  104. 1.07  104.05281547‚Ä¶                 75342.                 72664.\n7    397  104. 0.630 104.05926456‚Ä¶                911384.                  3235.\n8    426  104. 0.629 104.07084507‚Ä¶               2498815                3274537.\n# ‚Ñπ abbreviated names: ¬π‚Äã`HATS_402_041.mzML Peak height`,\n#   ¬≤‚Äã`HATS_403_037.mzML Peak height`\n# ‚Ñπ 2 more variables: `HATS_404_040.mzML Peak height` &lt;dbl&gt;,\n#   `HATS_401_022.mzML Peak height` &lt;dbl&gt;"
  },
  {
    "objectID": "activities/05_R.html#clean-up-file-names",
    "href": "activities/05_R.html#clean-up-file-names",
    "title": "Data analysis with R",
    "section": "Clean up file names",
    "text": "Clean up file names\nWe are using str_remove() to remove some information we do not need in our sample names.\n\n# remove stuff from the end of file names, \".mzML Peak height\"\nnew_col_names &lt;- str_remove(colnames(MZ_RT), \".mzML Peak height\")\n\n# did it work?\nnew_col_names\n\n [1] \"row_ID\"         \"mz\"             \"rt\"             \"mz_rt\"         \n [5] \"HATS_402_041\"   \"HATS_403_037\"   \"HATS_404_040\"   \"HATS_401_022\"  \n [9] \"HATS_408_043\"   \"HATS_405_025\"   \"HATS_406_055\"   \"HATS_407_059\"  \n[13] \"HATS_412_019\"   \"HATS_409_056\"   \"HATS_410_018\"   \"HATS_411_044\"  \n[17] \"LA2213_602_035\" \"LA2213_603_045\" \"LA2213_601_051\" \"LA2213_604_016\"\n[21] \"LA2213_605_017\" \"LA2213_607_032\" \"LA2213_608_024\" \"LA2213_606_033\"\n[25] \"LA2213_609_058\" \"LA2213_610_050\" \"LA2213_612_046\" \"OH8243_801_036\"\n[29] \"OH8243_802_026\" \"OH8243_803_030\" \"OH8243_805_057\" \"LA2213_611_061\"\n[33] \"OH8243_804_029\" \"OH8243_806_027\" \"OH8243_809_063\" \"OH8243_807_053\"\n[37] \"OH8243_810_049\" \"OH8243_808_038\" \"OH8243_812_060\" \"OH8243_811_028\"\n[41] \"PB_02_006\"      \"PB_03_007\"      \"PB_01_005\"      \"QC_02_031\"     \n[45] \"QC_04_047\"      \"QC_01_023\"      \"QC_03_039\"      \"QC_05_054\"     \n[49] \"QC_06_062\"     \n\n# assign our new column names to MZ_RT\ncolnames(MZ_RT) &lt;- new_col_names\n\nWhat are our sample names?\n\ncolnames(MZ_RT)\n\n [1] \"row_ID\"         \"mz\"             \"rt\"             \"mz_rt\"         \n [5] \"HATS_402_041\"   \"HATS_403_037\"   \"HATS_404_040\"   \"HATS_401_022\"  \n [9] \"HATS_408_043\"   \"HATS_405_025\"   \"HATS_406_055\"   \"HATS_407_059\"  \n[13] \"HATS_412_019\"   \"HATS_409_056\"   \"HATS_410_018\"   \"HATS_411_044\"  \n[17] \"LA2213_602_035\" \"LA2213_603_045\" \"LA2213_601_051\" \"LA2213_604_016\"\n[21] \"LA2213_605_017\" \"LA2213_607_032\" \"LA2213_608_024\" \"LA2213_606_033\"\n[25] \"LA2213_609_058\" \"LA2213_610_050\" \"LA2213_612_046\" \"OH8243_801_036\"\n[29] \"OH8243_802_026\" \"OH8243_803_030\" \"OH8243_805_057\" \"LA2213_611_061\"\n[33] \"OH8243_804_029\" \"OH8243_806_027\" \"OH8243_809_063\" \"OH8243_807_053\"\n[37] \"OH8243_810_049\" \"OH8243_808_038\" \"OH8243_812_060\" \"OH8243_811_028\"\n[41] \"PB_02_006\"      \"PB_03_007\"      \"PB_01_005\"      \"QC_02_031\"     \n[45] \"QC_04_047\"      \"QC_01_023\"      \"QC_03_039\"      \"QC_05_054\"     \n[49] \"QC_06_062\""
  },
  {
    "objectID": "activities/05_R.html#check-for-duplicates",
    "href": "activities/05_R.html#check-for-duplicates",
    "title": "Data analysis with R",
    "section": "Check for duplicates",
    "text": "Check for duplicates\nSometimes you end up with duplicate data after deconvolution with MZmine. Here, we are going to check for complete, perfect duplicates and remove them. The function get_dupes() is from the package janitor.\nWe don‚Äôt want row_ID to be considered here since those are unique per row.\n\nget_dupes(MZ_RT %&gt;% select(-row_ID))\n\nNo variable names specified - using all columns.\n\n\nNo duplicate combinations found of: mz, rt, mz_rt, HATS_402_041, HATS_403_037, HATS_404_040, HATS_401_022, HATS_408_043, HATS_405_025, ... and 39 other variables\n\n\n# A tibble: 0 √ó 49\n# ‚Ñπ 49 variables: mz &lt;dbl&gt;, rt &lt;dbl&gt;, mz_rt &lt;chr&gt;, HATS_402_041 &lt;dbl&gt;,\n#   HATS_403_037 &lt;dbl&gt;, HATS_404_040 &lt;dbl&gt;, HATS_401_022 &lt;dbl&gt;,\n#   HATS_408_043 &lt;dbl&gt;, HATS_405_025 &lt;dbl&gt;, HATS_406_055 &lt;dbl&gt;,\n#   HATS_407_059 &lt;dbl&gt;, HATS_412_019 &lt;dbl&gt;, HATS_409_056 &lt;dbl&gt;,\n#   HATS_410_018 &lt;dbl&gt;, HATS_411_044 &lt;dbl&gt;, LA2213_602_035 &lt;dbl&gt;,\n#   LA2213_603_045 &lt;dbl&gt;, LA2213_601_051 &lt;dbl&gt;, LA2213_604_016 &lt;dbl&gt;,\n#   LA2213_605_017 &lt;dbl&gt;, LA2213_607_032 &lt;dbl&gt;, LA2213_608_024 &lt;dbl&gt;, ‚Ä¶\n\n\nWe have no exact duplicate, this is great! I‚Äôm including some code that you can use to remove duplicates if you have them.\n\nMZ_RT %&gt;%\n  filter(mz_rt %in% c()) %&gt;%\n  arrange(mz_rt)\n\n\nMZ_RT_nodupes &lt;- MZ_RT %&gt;%\n  filter(!row_ID %in% c(\"insert your duplicated row_IDs here\"))\n\nThis should remove 5 rows.\n\nnrow(MZ_RT) - nrow(MZ_RT_nodupes) # ok good\n\n\nCV function\nSince base R does not have a function to calculate coefficient of variance, let‚Äôs write one.\n\ncv &lt;- function(x){\n        (sd(x)/mean(x))\n}"
  },
  {
    "objectID": "activities/05_R.html#counting-qcs",
    "href": "activities/05_R.html#counting-qcs",
    "title": "Data analysis with R",
    "section": "Counting QCs",
    "text": "Counting QCs\nSubset QCs and filter features to keep only those that are present in 100% of QCs. You could change this parameter based on your data.\n\n# check dimensions of current df\ndim(MZ_RT)\n\n[1] 2560   49\n\nMZ_RT_QCs &lt;- MZ_RT %&gt;%\n  select(mz_rt, contains(\"QC\")) %&gt;% # select QCs\n  filter(rowSums(is.na(.)) &lt;= 1) # remove rows that have 1 or more NAs\n\n\n# check dimensions of QCs filtered df\ndim(MZ_RT_QCs)\n\n[1] 2560    7\n\n# how many features got removed with this filtering?\nnrow(MZ_RT) - nrow(MZ_RT_QCs)\n\n[1] 0\n\n\nIt looks like we didn‚Äôt actually remove anything by doing this."
  },
  {
    "objectID": "activities/05_R.html#filter-on-qc-cv",
    "href": "activities/05_R.html#filter-on-qc-cv",
    "title": "Data analysis with R",
    "section": "Filter on QC CV",
    "text": "Filter on QC CV\nHere we are removing features that have a CV of more than 30% in the QCs. The rationale is that if a feature cannot be reproducibly measured in samples that are all the same, it should not be included in our analysis.\n\n# calculate CV row-wise (1 means row-wise)\nQC_CV &lt;- apply(MZ_RT_QCs[, 2:ncol(MZ_RT_QCs)], 1, cv)\n\n# bind the CV vector back to the QC df\nMZ_RT_QCs_CV &lt;- cbind(MZ_RT_QCs, QC_CV)\n\n# filter for keeping features with QC_CV &lt;= 0.30 (or 30%)\nMZ_RT_QCs_CVfilt &lt;- MZ_RT_QCs_CV %&gt;%\n  filter(QC_CV &lt;= 0.30)\n\nHow many features did I remove with this CV filtering?\n\nnrow(MZ_RT_QCs) - nrow(MZ_RT_QCs_CVfilt)\n\n[1] 46"
  },
  {
    "objectID": "activities/05_R.html#merge-back-the-rest-of-the-data",
    "href": "activities/05_R.html#merge-back-the-rest-of-the-data",
    "title": "Data analysis with R",
    "section": "Merge back the rest of the data",
    "text": "Merge back the rest of the data\nMZ_RT_QCs_CVfilt only contains the QCs, We want to keep only the rows that are present in this df, and then merge back all of the other samples present in MZ_RT. We will do this by creating a vector that has the mz_rt features we want to keep, and then using filter() and %in% to keep only features that are a part of this list.\n\ndim(MZ_RT_QCs_CVfilt)\n\n[1] 2514    8\n\ndim(MZ_RT)\n\n[1] 2560   49\n\n# make a character vector of the mz_rt features we want to keep\n# i.e., the ones that passed our previous filtering steps\nfeatures_to_keep &lt;- as.character(MZ_RT_QCs_CVfilt$mz_rt)\n\nMZ_RT_filt &lt;- MZ_RT %&gt;%\n  filter(mz_rt %in% features_to_keep)\n\ndim(MZ_RT_filt)\n\n[1] 2514   49\n\nget_dupes(MZ_RT_filt %&gt;% select(mz_rt)) # good no dupes\n\nNo variable names specified - using all columns.\n\n\nNo duplicate combinations found of: mz_rt\n\n\n# A tibble: 0 √ó 2\n# ‚Ñπ 2 variables: mz_rt &lt;chr&gt;, dupe_count &lt;int&gt;\n\n\nYou should have the same number of features in MZ_RT_QCs_CVfilt as you do in your new filtered df MZ_RT_filt.\n\nall.equal(MZ_RT_QCs_CVfilt$mz_rt, MZ_RT_filt$mz_rt)\n\n[1] TRUE"
  },
  {
    "objectID": "activities/05_R.html#process-blanks",
    "href": "activities/05_R.html#process-blanks",
    "title": "Data analysis with R",
    "section": "Process blanks",
    "text": "Process blanks\nWe want to remove features that are present in our process blanks as they are not coming from compounds present in our samples. In this dataset, there are three process blanks (a sample that includes all the extraction materials, minus the sample, here the tomato was replaced by mass with water) has ‚ÄúPB‚Äù in the sample name.\n\n# grab the name of the column/sample that is the process blank\nstr_subset(colnames(MZ_RT_filt), \"PB\")\n\n[1] \"PB_02_006\" \"PB_03_007\" \"PB_01_005\"\n\n\nCalculate the average value across the QCs, then remove features that are not at least 10x higher in the QCs than in the process blank. To do this we will use apply().\napply(X, MARGIN, FUN,...) where X is your df, MARGIN is 1 for row-wise, and 2 for col-wise, and FUN is your function\n\n# pull avg peak height across QCs\navg_height_QC &lt;- apply(MZ_RT_QCs_CVfilt[, 2:ncol(MZ_RT_QCs_CVfilt)], 1, mean)\n\n# bind back to rest of data\nMZ_RT_filt_QC_avg &lt;- cbind(MZ_RT_filt, avg_height_QC)\n\n# check dimensions\ndim(MZ_RT_filt_QC_avg)\n\n[1] 2514   50\n\n\nPull the name of your process blank, and make a new column that indicates how many fold higher your peak height is in your average QC vs your process blank.\n\n# pull name of process blank so we can remember them\nstr_subset(colnames(MZ_RT_filt), \"PB\")\n\n[1] \"PB_02_006\" \"PB_03_007\" \"PB_01_005\"\n\n# make a new column that has a value of how many fold higher peak height is\n# in QCs as compared to PB\n# here there is only  one PB, but would be better to have &gt; 1 but this is ok\n# then you can avg your PBs together and do the same thing\nMZ_RT_filt_PB &lt;- MZ_RT_filt_QC_avg %&gt;% \n  mutate(avg_height_PB = ((PB_02_006 + PB_01_005 + PB_03_007)/3),\n         fold_higher_in_QC = avg_height_QC/avg_height_PB) %&gt;%\n  select(row_ID, mz_rt, mz, rt, avg_height_QC, avg_height_PB, fold_higher_in_QC)\n\nhead(MZ_RT_filt_PB)\n\n  row_ID                      mz_rt       mz        rt avg_height_QC\n1   3106 100.112032546963_2.7774892 100.1120 2.7774892      40408.18\n2    364 101.070926284391_0.6108881 101.0709 0.6108881      78630.77\n3    453  102.054957817964_0.641104 102.0550 0.6411040     420303.10\n4   5568 103.054201883867_3.9781477 103.0542 3.9781477      15405.02\n5   2723 103.054224658561_2.5438855 103.0542 2.5438855     215913.13\n6   1424  104.052815474906_1.065307 104.0528 1.0653070     119092.77\n  avg_height_PB fold_higher_in_QC\n1     1479.6998         27.308366\n2      719.0611        109.351996\n3     3059.5315        137.374986\n4     1894.2296          8.132607\n5     1617.7699        133.463439\n6        0.0000               Inf\n\n\nWe want to keep features that are at least 10x higher in QCs than process blanks, and we also want to keep Infs, because an Inf indicates that a feature absent in the process blanks (i.e., you get an Inf because you‚Äôre trying to divide by zero).\n\n# keep features that are present at least 10x higher in QCs vs PB\n# or, keep NAs because those are absent in blank\nPB_features_to_keep &lt;- MZ_RT_filt_PB %&gt;%\n  filter(fold_higher_in_QC &gt; 10 | is.infinite(fold_higher_in_QC)) \n\ndim(PB_features_to_keep)\n\n[1] 2409    7\n\n\nHow many features did we remove?\n\nnrow(MZ_RT_filt_QC_avg) - nrow(PB_features_to_keep)\n\n[1] 105\n\n\nRemoved some garbage!\nBind back metdata.\n\nMZ_RT_filt_PBremoved &lt;- MZ_RT_filt_QC_avg %&gt;%\n  filter(mz_rt %in% PB_features_to_keep$mz_rt)\n\nnrow(MZ_RT_filt_PBremoved)\n\n[1] 2409\n\n\nDo we have any duplicate features?\n\nget_dupes(MZ_RT_filt_PBremoved, mz_rt)\n\nNo duplicate combinations found of: mz_rt\n\n\n [1] mz_rt          dupe_count     row_ID         mz             rt            \n [6] HATS_402_041   HATS_403_037   HATS_404_040   HATS_401_022   HATS_408_043  \n[11] HATS_405_025   HATS_406_055   HATS_407_059   HATS_412_019   HATS_409_056  \n[16] HATS_410_018   HATS_411_044   LA2213_602_035 LA2213_603_045 LA2213_601_051\n[21] LA2213_604_016 LA2213_605_017 LA2213_607_032 LA2213_608_024 LA2213_606_033\n[26] LA2213_609_058 LA2213_610_050 LA2213_612_046 OH8243_801_036 OH8243_802_026\n[31] OH8243_803_030 OH8243_805_057 LA2213_611_061 OH8243_804_029 OH8243_806_027\n[36] OH8243_809_063 OH8243_807_053 OH8243_810_049 OH8243_808_038 OH8243_812_060\n[41] OH8243_811_028 PB_02_006      PB_03_007      PB_01_005      QC_02_031     \n[46] QC_04_047      QC_01_023      QC_03_039      QC_05_054      QC_06_062     \n[51] avg_height_QC \n&lt;0 rows&gt; (or 0-length row.names)\n\n\nGood, we shouldn‚Äôt because we handled this already.\nRemove samples that we don‚Äôt need anymore.\n\ncolnames(MZ_RT_filt_PBremoved)\n\n [1] \"row_ID\"         \"mz\"             \"rt\"             \"mz_rt\"         \n [5] \"HATS_402_041\"   \"HATS_403_037\"   \"HATS_404_040\"   \"HATS_401_022\"  \n [9] \"HATS_408_043\"   \"HATS_405_025\"   \"HATS_406_055\"   \"HATS_407_059\"  \n[13] \"HATS_412_019\"   \"HATS_409_056\"   \"HATS_410_018\"   \"HATS_411_044\"  \n[17] \"LA2213_602_035\" \"LA2213_603_045\" \"LA2213_601_051\" \"LA2213_604_016\"\n[21] \"LA2213_605_017\" \"LA2213_607_032\" \"LA2213_608_024\" \"LA2213_606_033\"\n[25] \"LA2213_609_058\" \"LA2213_610_050\" \"LA2213_612_046\" \"OH8243_801_036\"\n[29] \"OH8243_802_026\" \"OH8243_803_030\" \"OH8243_805_057\" \"LA2213_611_061\"\n[33] \"OH8243_804_029\" \"OH8243_806_027\" \"OH8243_809_063\" \"OH8243_807_053\"\n[37] \"OH8243_810_049\" \"OH8243_808_038\" \"OH8243_812_060\" \"OH8243_811_028\"\n[41] \"PB_02_006\"      \"PB_03_007\"      \"PB_01_005\"      \"QC_02_031\"     \n[45] \"QC_04_047\"      \"QC_01_023\"      \"QC_03_039\"      \"QC_05_054\"     \n[49] \"QC_06_062\"      \"avg_height_QC\" \n\nMZ_RT_filt_PBremoved &lt;- MZ_RT_filt_PBremoved %&gt;%\n  select(-PB_02_006, -PB_01_005, -PB_03_007, -avg_height_QC)"
  },
  {
    "objectID": "activities/05_R.html#save-your-file",
    "href": "activities/05_R.html#save-your-file",
    "title": "Data analysis with R",
    "section": "Save your file",
    "text": "Save your file\nNow you have a list of features present in your samples after filtering for CV in QCs, and removing all the extraneous columns we added to help us do this, along with removing any process blanks.\n\nwrite_csv(MZ_RT_filt_PBremoved,\n          \"data/post_filtering_6892.csv\")"
  },
  {
    "objectID": "activities/05_R.html#wrangle-sample-names",
    "href": "activities/05_R.html#wrangle-sample-names",
    "title": "Data analysis with R",
    "section": "Wrangle sample names",
    "text": "Wrangle sample names\nHere, the samples are in columns and the features are in rows. Samples are coded so that the first number is the treatment code, and the last code is the run order. We don‚Äôt need pos. We are going to transpose the data so that samples are in rows and features are in tables, and we will also import the metadata about the samples.\n\nmetab_t &lt;- MZ_RT_filt_PBremoved %&gt;%\n  select(-row_ID, -mz, -rt) %&gt;%\n  t() %&gt;%\n  as.data.frame() %&gt;%\n  rownames_to_column(var = \"mz_rt\")\n\n# make the first row the column names\ncolnames(metab_t) &lt;- metab_t[1,]\n\n# then remove the first row and rename the column that should be called sample_name\nmetab_t &lt;- metab_t[-1,] %&gt;%\n  rename(sample_name = mz_rt) %&gt;%\n  mutate((across(.cols = 2:ncol(.), .fns = as.numeric)))\n\nmetab_t[1:10, 1:10]\n\n    sample_name 100.112032546963_2.7774892 101.070926284391_0.6108881\n2  HATS_402_041                   26623.42                  105494.08\n3  HATS_403_037                   45481.48                  104196.20\n4  HATS_404_040                   43957.91                  104899.95\n5  HATS_401_022                   47214.43                   90222.12\n6  HATS_408_043                   46941.94                  115545.70\n7  HATS_405_025                   32218.73                   93989.97\n8  HATS_406_055                   31183.91                   95570.40\n9  HATS_407_059                   35303.91                  115281.73\n10 HATS_412_019                   45864.24                  101472.12\n11 HATS_409_056                   23643.99                   97027.94\n   102.054957817964_0.641104 103.054224658561_2.5438855\n2                   413980.8                   196963.9\n3                   413245.7                   232544.1\n4                   410670.9                   233201.0\n5                   422117.5                   201711.9\n6                   379500.5                   317119.0\n7                   449261.5                   196461.6\n8                   433928.6                   172716.3\n9                   332571.8                   233300.6\n10                  392594.0                   236538.0\n11                  390017.1                   159840.7\n   104.052815474906_1.065307 104.059264569687_0.6302757\n2                   75342.02                 911384.440\n3                   72663.66                   3234.576\n4                   98486.46                   4026.670\n5                   78438.71                   3363.092\n6                  128792.77                   3529.039\n7                   69918.09                1575439.000\n8                   64246.62                   2767.284\n9                   88647.18                   2967.580\n10                  78838.38                   3400.089\n11                  71890.95                   3651.530\n   104.070845078818_0.6292385 104.107425371357_0.5997596\n2                     2498815                    4192158\n3                     3274537                    4506788\n4                     3265155                    4466335\n5                     3602852                    4506087\n6                     4000426                    4407152\n7                     2522760                    4389543\n8                     2374514                    4441916\n9                     3509658                    4643859\n10                    3862798                    4476118\n11                    3250134                    4585277\n   104.124821538078_0.6135892\n2                    158717.3\n3                    246090.9\n4                    240655.1\n5                    246382.4\n6                    264137.5\n7                    146173.3\n8                    223540.2\n9                    258637.6\n10                   247997.0\n11                   246773.9\n\n\nAdd in the metadata and make a new column that will indicate whether a sample is a ‚Äúsample‚Äù or a ‚ÄúQC‚Äù. Extract the metadata out of the column names. The metadata we have for the samples we are no longer using (process blanks etc) are removed.\n\nmetab_plus &lt;- metab_t %&gt;%\n  mutate(sample_or_qc = if_else(str_detect(sample_name, \"QC\"), \n                                true = \"QC\", false = \"Sample\")) %&gt;%\n  separate_wider_delim(cols = sample_name, delim = \"_\",\n                       names = c(\"tomato\", \"rep_or_plot\", \"run_order\"),\n                       cols_remove = FALSE) %&gt;%\n  select(sample_name, sample_or_qc, tomato, rep_or_plot, run_order, everything()) %&gt;%\n  mutate(sample_or_qc = as.factor(sample_or_qc),\n         tomato = as.factor(tomato),\n         run_order = as.numeric(run_order))\n         \n\n# how does it look\nmetab_plus[1:5, 1:8]\n\n# A tibble: 5 √ó 8\n  sample_name  sample_or_qc tomato rep_or_plot run_order 100.112032546963_2.77‚Ä¶¬π\n  &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt;                   &lt;dbl&gt;\n1 HATS_402_041 Sample       HATS   402                41                  26623.\n2 HATS_403_037 Sample       HATS   403                37                  45481.\n3 HATS_404_040 Sample       HATS   404                40                  43958.\n4 HATS_401_022 Sample       HATS   401                22                  47214.\n5 HATS_408_043 Sample       HATS   408                43                  46942.\n# ‚Ñπ abbreviated name: ¬π‚Äã`100.112032546963_2.7774892`\n# ‚Ñπ 2 more variables: `101.070926284391_0.6108881` &lt;dbl&gt;,\n#   `102.054957817964_0.641104` &lt;dbl&gt;\n\n\nGo from wide to long data.\n\nmetab_plus_long &lt;- metab_plus %&gt;%\n  pivot_longer(cols = -c(sample_name, sample_or_qc, tomato, rep_or_plot, run_order,),  # remove metadata\n               names_to = \"mz_rt\",\n               values_to = \"rel_abund\")\n\nglimpse(metab_plus_long)\n\nRows: 101,178\nColumns: 7\n$ sample_name  &lt;chr&gt; \"HATS_402_041\", \"HATS_402_041\", \"HATS_402_041\", \"HATS_402‚Ä¶\n$ sample_or_qc &lt;fct&gt; Sample, Sample, Sample, Sample, Sample, Sample, Sample, S‚Ä¶\n$ tomato       &lt;fct&gt; HATS, HATS, HATS, HATS, HATS, HATS, HATS, HATS, HATS, HAT‚Ä¶\n$ rep_or_plot  &lt;chr&gt; \"402\", \"402\", \"402\", \"402\", \"402\", \"402\", \"402\", \"402\", \"‚Ä¶\n$ run_order    &lt;dbl&gt; 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 4‚Ä¶\n$ mz_rt        &lt;chr&gt; \"100.112032546963_2.7774892\", \"101.070926284391_0.6108881‚Ä¶\n$ rel_abund    &lt;dbl&gt; 26623.416, 105494.080, 413980.780, 196963.940, 75342.016,‚Ä¶\n\n\nAlso add separate columns for mz and rt, and making both numeric.\n\nmetab_plus_long &lt;- metab_plus_long %&gt;%\n  separate_wider_delim(cols = mz_rt,\n                       delim = \"_\",\n                       names = c(\"mz\", \"rt\"),\n                       cols_remove = FALSE) %&gt;%\n  mutate(across(.cols = c(\"mz\", \"rt\"), .fns = as.numeric)) # convert mz and rt to numeric\n\n# how did that go?\nhead(metab_plus_long)\n\n# A tibble: 6 √ó 9\n  sample_name  sample_or_qc tomato rep_or_plot run_order    mz    rt mz_rt      \n  &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      \n1 HATS_402_041 Sample       HATS   402                41  100. 2.78  100.112032‚Ä¶\n2 HATS_402_041 Sample       HATS   402                41  101. 0.611 101.070926‚Ä¶\n3 HATS_402_041 Sample       HATS   402                41  102. 0.641 102.054957‚Ä¶\n4 HATS_402_041 Sample       HATS   402                41  103. 2.54  103.054224‚Ä¶\n5 HATS_402_041 Sample       HATS   402                41  104. 1.07  104.052815‚Ä¶\n6 HATS_402_041 Sample       HATS   402                41  104. 0.630 104.059264‚Ä¶\n# ‚Ñπ 1 more variable: rel_abund &lt;dbl&gt;"
  },
  {
    "objectID": "activities/05_R.html#data-summaries",
    "href": "activities/05_R.html#data-summaries",
    "title": "Data analysis with R",
    "section": "Data summaries",
    "text": "Data summaries\nWhat mass range do I have?\n\nrange(metab_plus_long$mz)\n\n[1]  100.112 1589.722\n\n\nWhat retention time range do I have?\n\nrange(metab_plus_long$rt)\n\n[1] 0.5184004 7.4507394\n\n\nHow many samples are in each of my meta-data groups?\n\n# make wide data to make some calculations easier\nmetab_wide_meta &lt;- metab_plus_long %&gt;%\n  dplyr::select(-mz, -rt) %&gt;%\n  pivot_wider(names_from = mz_rt,\n              values_from = rel_abund)\n\n# by sample vs QC\nmetab_wide_meta %&gt;%\n  count(sample_or_qc)\n\n# A tibble: 2 √ó 2\n  sample_or_qc     n\n  &lt;fct&gt;        &lt;int&gt;\n1 QC               6\n2 Sample          36\n\n# by tomato\nmetab_wide_meta %&gt;%\n  count(tomato)\n\n# A tibble: 4 √ó 2\n  tomato     n\n  &lt;fct&gt;  &lt;int&gt;\n1 HATS      12\n2 LA2213    12\n3 OH8243    12\n4 QC         6\n\n\nWhat does my data coverage across mz and rt look like?\n\nmetab_plus_long %&gt;%\n  group_by(mz_rt) %&gt;% # so we only have one point per feature\n  ggplot(aes(x = rt, y = mz)) +\n  geom_point(alpha = 0.01) +\n  theme_minimal() +\n  labs(x = \"Retention time (min)\",\n       y = \"Mass to charge ratio (m/z)\",\n       title = \"m/z by retention time plot (all features)\",\n       subtitle = \"C18 reversed phase, positive ionization mode\")\n\n\n\n\nAll of this overlap makes me think we have replication of features.\nDistribution of masses\n\nmetab_plus_long %&gt;%\n  group_by(mz_rt) %&gt;%\n  ggplot(aes(x = mz)) +\n  geom_histogram(bins = 100) +\n  theme_minimal() +\n  labs(x = \"m/z\",\n       y = \"Number of features\",\n       title = \"Distribution of features by mass\")\n\n\n\n\nDistribution of retention times\n\nmetab_plus_long %&gt;%\n  group_by(mz_rt) %&gt;%\n  ggplot(aes(x = rt)) +\n  geom_density() +\n  theme_minimal() +\n  labs(x = \"Retention time\",\n       y = \"Number of features\",\n       title = \"Distribution of features by retention time\")"
  },
  {
    "objectID": "activities/05_R.html#missing-data",
    "href": "activities/05_R.html#missing-data",
    "title": "Data analysis with R",
    "section": "Missing data",
    "text": "Missing data\n\nSurveying missingness\nHow many missing values are there for each feature? In this dataset, missing values are coded as zero.\n\n# all data including QCs\n# how many missing values are there for each feature (row)\nna_by_feature &lt;- rowSums(is.na(MZ_RT_filt_PBremoved)) %&gt;%\n  as.data.frame() %&gt;%\n  rename(missing_values = 1)\n  \n\nna_by_feature %&gt;%\n  ggplot(aes(x = missing_values)) +\n  geom_histogram(bins = 40) + # since 40 samples\n  theme_minimal() + \n  labs(title = \"Number of missing values for each feature\",\n       x = \"Number of missing values\",\n       y = \"How many features have that \\nmany missing values\")\n\n\n\n\nHow many features have no missing values?\n\nna_by_feature %&gt;%\n  count(missing_values == 0)\n\n  missing_values == 0    n\n1               FALSE  628\n2                TRUE 1781\n\n\nHow many missing values are there for each sample?\n\n# all data including QCs\n# how many missing values are there for each feature (row)\nna_by_sample &lt;- colSums(is.na(MZ_RT_filt_PBremoved)) %&gt;%\n  as.data.frame() %&gt;%\n  rename(missing_values = 1) %&gt;%\n  rownames_to_column(var = \"feature\") %&gt;%\n  filter(!feature == \"mz_rt\")\n\nna_by_sample %&gt;%\n  ggplot(aes(x = missing_values)) +\n  geom_histogram(bins = 100) + # \n  theme_minimal() + \n  labs(title = \"Number of missing values for each sample\",\n       x = \"Number of missing values\",\n       y = \"How many samples have that \\nmany missing values\")\n\n\n\n\nWhich features have a lot of missing values?\n\ncontains_NAs_feature &lt;- metab_plus_long %&gt;%\n  group_by(mz_rt) %&gt;%\n  count(is.na(rel_abund)) %&gt;%\n  filter(`is.na(rel_abund)` == TRUE) %&gt;%\n  arrange(desc(n))\n\nhead(contains_NAs_feature)\n\n# A tibble: 6 √ó 3\n# Groups:   mz_rt [6]\n  mz_rt                      `is.na(rel_abund)`     n\n  &lt;chr&gt;                      &lt;lgl&gt;              &lt;int&gt;\n1 743.251838840705_6.577289  TRUE                  28\n2 628.382914819219_4.8645153 TRUE                  27\n3 465.285351543191_4.7723923 TRUE                  26\n4 399.246808492192_4.5366135 TRUE                  25\n5 421.259892834676_4.621516  TRUE                  25\n6 472.341839506857_6.440611  TRUE                  25\n\n\nWhich samples have a lot of missing values?\n\ncontains_NAs_sample &lt;- metab_plus_long %&gt;%\n  group_by(sample_name) %&gt;%\n  count(is.na(rel_abund)) %&gt;%\n  filter(`is.na(rel_abund)` == TRUE) %&gt;%\n  arrange(desc(n))\n\nhead(contains_NAs_sample)\n\n# A tibble: 6 √ó 3\n# Groups:   sample_name [6]\n  sample_name    `is.na(rel_abund)`     n\n  &lt;chr&gt;          &lt;lgl&gt;              &lt;int&gt;\n1 OH8243_805_057 TRUE                 305\n2 OH8243_806_027 TRUE                 300\n3 OH8243_801_036 TRUE                 238\n4 OH8243_810_049 TRUE                 222\n5 OH8243_811_028 TRUE                 221\n6 OH8243_808_038 TRUE                 214\n\n\nAre there any missing values in the QCs? (There shouldn‚Äôt be.)\n\nmetab_QC &lt;- MZ_RT_filt_PBremoved %&gt;%\n  dplyr::select(contains(\"QC\"))\n\nna_by_sample &lt;- colSums(is.na(metab_QC)) %&gt;%\n  as.data.frame() %&gt;%\n  rename(missing_values = 1) %&gt;%\n  rownames_to_column(var = \"feature\") %&gt;%\n  filter(!feature == \"mz_rt\")\n\nsum(na_by_sample$missing_values) # nope\n\n[1] 0\n\n\n\n\nImputing missing values\nThis is an optional step but some downstream analyses don‚Äôt handle missingness well. Here we are imputing missing data with half the lowest value observed for that feature.\n\n# grab only the feature data and leave metadata\nmetab_wide_meta_imputed &lt;- metab_wide_meta %&gt;%\n  dplyr::select(-c(1:5)) # the metadata columns\n\nmetab_wide_meta_imputed[] &lt;- lapply(metab_wide_meta_imputed,\n                                 function(x) ifelse(is.na(x), min(x, na.rm = TRUE)/2, x))\n\n# bind back the metadata\nmetab_wide_meta_imputed &lt;- bind_cols(metab_wide_meta[,1:5], metab_wide_meta_imputed)\n\n# try working from original MZ_RT_filt_PBremoved input file for notame later\nmetab_imputed &lt;- MZ_RT_filt_PBremoved %&gt;%\n  dplyr::select(-row_ID, -mz_rt, -mz, -rt)\n\nmetab_imputed[] &lt;- lapply(metab_imputed,\n                          function(x) ifelse(is.na(x), min(x, na.rm = TRUE)/2, x))\n\n# bind back metadata\nmetab_imputed &lt;- bind_cols (MZ_RT_filt_PBremoved$mz_rt, metab_imputed) %&gt;% # just add back mz_rt\n  rename(mz_rt = 1) # rename first column back to mz_rt\n\nNew names:\n‚Ä¢ `` -&gt; `...1`\n\n\nDid imputing work?\n\n# count missing values\nmetab_wide_meta_imputed %&gt;%\n  dplyr::select(-c(1:5)) %&gt;% # where the metadata is\n  is.na() %&gt;%\n  sum()\n\n[1] 0\n\n\nCreate long imputed dataset.\n\nmetab_long_meta_imputed &lt;- metab_wide_meta_imputed %&gt;%\n  pivot_longer(cols = 6:ncol(.),\n               names_to = \"mz_rt\",\n               values_to = \"rel_abund\")\n\nhead(metab_long_meta_imputed)\n\n# A tibble: 6 √ó 7\n  sample_name  sample_or_qc tomato rep_or_plot run_order mz_rt         rel_abund\n  &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;\n1 HATS_402_041 Sample       HATS   402                41 100.11203254‚Ä¶    26623.\n2 HATS_402_041 Sample       HATS   402                41 101.07092628‚Ä¶   105494.\n3 HATS_402_041 Sample       HATS   402                41 102.05495781‚Ä¶   413981.\n4 HATS_402_041 Sample       HATS   402                41 103.05422465‚Ä¶   196964.\n5 HATS_402_041 Sample       HATS   402                41 104.05281547‚Ä¶    75342.\n6 HATS_402_041 Sample       HATS   402                41 104.05926456‚Ä¶   911384.\n\n\nLet‚Äôs also make separate mz and rt columns.\n\nmetab_long_meta_imputed &lt;- metab_long_meta_imputed %&gt;%\n  separate_wider_delim(cols = mz_rt,\n                       delim = \"_\",\n                       names = c(\"mz\", \"rt\"),\n                       cols_remove = FALSE)\n\nmetab_long_meta_imputed$mz &lt;- as.numeric(metab_long_meta_imputed$mz)\nmetab_long_meta_imputed$rt &lt;- as.numeric(metab_long_meta_imputed$rt)"
  },
  {
    "objectID": "activities/05_R.html#feature-clustering-with-notame",
    "href": "activities/05_R.html#feature-clustering-with-notame",
    "title": "Data analysis with R",
    "section": "Feature clustering with notame",
    "text": "Feature clustering with notame\nWe want to cluster features that likely come from the same metabolite together, and we can do this using the package notame. You can learn more here.\n\nbrowseVignettes(\"notame\")\n\nLet‚Äôs make a m/z by retention time plot again before we start.\n\n(before_notame &lt;- metab_long_meta_imputed %&gt;%\n  group_by(mz_rt) %&gt;% # so we only have one point per feature\n  ggplot(aes(x = rt, y = mz)) +\n  geom_point(alpha = 0.01) +\n  theme_minimal() +\n  labs(x = \"Retention time (min)\",\n       y = \"Mass to charge ratio (m/z)\",\n       title = \"m/z by retention time plot before notame\",\n       subtitle = \"C18 reverse phase, positive ionization mode\"))\n\n\n\n\n\nWrangling data\nTranspose the wide data for notame and wrangle to the right format. Below is info from the documentation:\n\nData should be a data frame containing the abundances of features in each sample, one row per sample, each feature in a separate column\nFeatures should be a data frame containing information about the features, namely feature name (should be the same as the column name in data), mass and retention time\n\nGoing back to the original imported data and imputing from there seems kind of silly, but I had a lot of problems structuring this data to get find_connections() to run and not throw any errors because of names that weren‚Äôt the same between the features and the data inputs.\nIt is important that for the Data, your first sample is in row 2. The code below will get you there. If you‚Äôre wondering why the code is written this way instead of just using metab_wide_meta_imputed, this is why.\n\n# # create a data frame which is just the original metab data\n# transposed so samples are rows and features are columns\ndata_notame &lt;- data.frame(metab_imputed %&gt;%\n                          t())\n\ndata_notame &lt;- data_notame %&gt;%\n  tibble::rownames_to_column() %&gt;% # change samples from rownames to its own column\n  row_to_names(row_number = 1) # change the feature IDs (mz_rt) from first row obs into column names\n\n# change to results to numeric\n# it is important that the first row of data has the row number 2\n# i don't know why this is but save yourself all the time maria/jess spent figuring out\n# why this wasn't working\ndata_notame &lt;- data_notame %&gt;%\n  mutate(across(-mz_rt, as.numeric))\n\ntibble(data_notame)\n\n# A tibble: 42 √ó 2,410\n   mz_rt    100.112032546963_2.7‚Ä¶¬π 101.070926284391_0.6‚Ä¶¬≤ 102.054957817964_0.6‚Ä¶¬≥\n   &lt;chr&gt;                     &lt;dbl&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;\n 1 HATS_40‚Ä¶                 26623.                105494.                413981.\n 2 HATS_40‚Ä¶                 45481.                104196.                413246.\n 3 HATS_40‚Ä¶                 43958.                104900.                410671.\n 4 HATS_40‚Ä¶                 47214.                 90222.                422118.\n 5 HATS_40‚Ä¶                 46942.                115546.                379500.\n 6 HATS_40‚Ä¶                 32219.                 93990.                449261.\n 7 HATS_40‚Ä¶                 31184.                 95570.                433929.\n 8 HATS_40‚Ä¶                 35304.                115282.                332572.\n 9 HATS_41‚Ä¶                 45864.                101472.                392594 \n10 HATS_40‚Ä¶                 23644.                 97028.                390017.\n# ‚Ñπ 32 more rows\n# ‚Ñπ abbreviated names: ¬π‚Äã`100.112032546963_2.7774892`,\n#   ¬≤‚Äã`101.070926284391_0.6108881`, ¬≥‚Äã`102.054957817964_0.641104`\n# ‚Ñπ 2,406 more variables: `103.054224658561_2.5438855` &lt;dbl&gt;,\n#   `104.052815474906_1.065307` &lt;dbl&gt;, `104.059264569687_0.6302757` &lt;dbl&gt;,\n#   `104.070845078818_0.6292385` &lt;dbl&gt;, `104.107425371357_0.5997596` &lt;dbl&gt;,\n#   `104.124821538078_0.6135892` &lt;dbl&gt;, `104.130633537458_0.60107374` &lt;dbl&gt;, ‚Ä¶\n\n\nCreate df with features.\n\nfeatures &lt;- metab_long_meta_imputed %&gt;%\n  dplyr::select(mz_rt, mz, rt) %&gt;%\n  mutate(across(c(mz, rt), as.numeric)) %&gt;%\n  as.data.frame() %&gt;%\n  distinct()\n\nglimpse(features)\n\nRows: 2,409\nColumns: 3\n$ mz_rt &lt;chr&gt; \"100.112032546963_2.7774892\", \"101.070926284391_0.6108881\", \"102‚Ä¶\n$ mz    &lt;dbl&gt; 100.1120, 101.0709, 102.0550, 103.0542, 104.0528, 104.0593, 104.‚Ä¶\n$ rt    &lt;dbl&gt; 2.7774892, 0.6108881, 0.6411040, 2.5438855, 1.0653070, 0.6302757‚Ä¶\n\nclass(features)\n\n[1] \"data.frame\"\n\n\n\n\nFind connections\nSet cache = TRUE for this chunk since its a bit slow especially if you have a lot of features. Here, this step took 25 min for almost 7K features or 5 min for just over 2K features.\n\nconnection &lt;- find_connections(data = data_notame,\n                               features = features,\n                               corr_thresh = 0.9,\n                               rt_window = 1/60,\n                               name_col = \"mz_rt\",\n                               mz_col = \"mz\",\n                               rt_col = \"rt\")\n\nWarning: executing %dopar% sequentially: no parallel backend registered\n\n\n[1] 100\n[1] 200\n[1] 300\n[1] 400\n[1] 500\n[1] 600\n[1] 700\n[1] 800\n[1] 900\n[1] 1000\n[1] 1100\n[1] 1200\n[1] 1300\n[1] 1400\n[1] 1500\n[1] 1600\n[1] 1700\n[1] 1800\n[1] 1900\n[1] 2000\n[1] 2100\n[1] 2200\n[1] 2300\n[1] 2400\n[1] 2500\n[1] 2600\n[1] 2700\n[1] 2800\n[1] 2900\n[1] 3000\n[1] 3100\n[1] 3200\n[1] 3300\n[1] 3400\n[1] 3500\n[1] 3600\n[1] 3700\n[1] 3800\n[1] 3900\n[1] 4000\n[1] 4100\n[1] 4200\n[1] 4300\n[1] 4400\n[1] 4500\n[1] 4600\n[1] 4700\n[1] 4800\n[1] 4900\n[1] 5000\n[1] 5100\n[1] 5200\n[1] 5300\n[1] 5400\n[1] 5500\n[1] 5600\n[1] 5700\n[1] 5800\n[1] 5900\n[1] 6000\n[1] 6100\n[1] 6200\n[1] 6300\n[1] 6400\n[1] 6500\n[1] 6600\n[1] 6700\n[1] 6800\n\n\n\nhead(connection)\n\n                           x                           y       cor     rt_diff\n1  100.112032852018_2.777489  146.117590231148_2.7758384 0.9828013 -0.00165060\n2  100.112032852018_2.777489   146.143037302512_2.775242 0.9727044 -0.00224700\n3   101.0232571195_1.5106707   213.979752927845_1.510869 0.9596989  0.00019830\n4 101.070832397969_1.1185441  147.076510356935_1.1078178 0.9155650 -0.01072630\n5 101.070832397969_1.1185441    147.1022384601_1.1173519 0.9277277 -0.00119220\n6 101.070926035409_0.6108881 147.077120604255_0.60865843 0.9835768 -0.00222967\n    mz_diff\n1  46.00556\n2  46.03100\n3 112.95650\n4  46.00568\n5  46.03141\n6  46.00619\n\n\n\n\nClustering\nNow that we have found all of the features that are connected based on the parameterers we have set, we now need to find clusters.\n\nclusters &lt;- find_clusters(connections = connection, \n                          d_thresh = 0.8)\n\n571 components found\n\n\nWarning: executing %dopar% sequentially: no parallel backend registered\n\n\nComponent 100 / 571 \nComponent 200 / 571 \nComponent 300 / 571 \nComponent 400 / 571 \nComponent 500 / 571 \n453 components found\n\nComponent 100 / 453 \nComponent 200 / 453 \nComponent 300 / 453 \nComponent 400 / 453 \n123 components found\n\nComponent 100 / 123 \n62 components found\n\n23 components found\n\n19 components found\n\n16 components found\n\n13 components found\n\n11 components found\n\n4 components found\n\n7 components found\n\n11 components found\n\n7 components found\n\n4 components found\n\n2 components found\n\n8 components found\n\n1 components found\n\n1 components found\n\n\nAssign a cluster ID to each feature to keep, and the feature that is picked is the one with the highest median peak intensity across the samples.\n\n# assign a cluster ID to all features\n# clusters are named after feature with highest median peak height\nfeatures_clustered &lt;- assign_cluster_id(data_notame, \n                                        clusters, \n                                        features, \n                                        name_col = \"mz_rt\")\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\nWarning in max(features_tmp$MPA, na.rm = TRUE): no non-missing arguments to\nmax; returning -Inf\n\n\nExport out a list of your clusters this way you can use this later during metabolite ID.\n\n# export clustered feature list this way you have it\nwrite_csv(features_clustered,\n          \"data/features_notame-clusters.csv\")\n\nPull data out from the clusters and see how many features we removed/have now.\n\n# lets see how many features are removed when we only keep one feature per cluster\npulled &lt;- pull_clusters(data_notame, features_clustered, name_col = \"mz_rt\")\n\ncluster_data &lt;- pulled$cdata\ncluster_features &lt;- pulled$cfeatures\n\n# how many features did we originally have after filtering?\nnrow(metab_imputed)\n\n[1] 2409\n\n# how many features got removed during clustering?\nnrow(metab_imputed) - nrow(cluster_features)\n\n[1] 11\n\n# what percentage of the original features were removed?\n((nrow(metab_imputed) - nrow(cluster_features))/nrow(metab_imputed)) * 100\n\n[1] 0.456621\n\n# how many features do we have now?\nnrow(cluster_features)\n\n[1] 2398\n\n\nReduce our dataset to include only our new clusters. cluster_data contains only the retained clusters, while cluster_features tells you also which features are a part of each cluster.\n\n# combined metadata_plus with cluster_features\ncluster_data &lt;- cluster_data %&gt;%\n  rename(sample_name = mz_rt) # since this column is actually sample name\n\n# make a wide df\nmetab_imputed_clustered_wide &lt;- left_join(metab_wide_meta_imputed[,1:5], cluster_data,\n                                          by = \"sample_name\") \n\ndim(metab_imputed_clustered_wide) # we have 2474 features since 4 metadata columns\n\n[1]   42 2403\n\n# make a long/tidy df\nmetab_imputed_clustered_long &lt;- metab_imputed_clustered_wide %&gt;%\n  pivot_longer(cols = 6:ncol(.),\n               names_to = \"mz_rt\",\n               values_to = \"rel_abund\") %&gt;%\n  separate_wider_delim(cols = mz_rt, # make separate columns for mz and rt too\n                       delim = \"_\",\n                       names = c(\"mz\", \"rt\"),\n                       cols_remove = FALSE) %&gt;%\n  mutate(across(.cols = c(\"mz\", \"rt\"), .fns = as.numeric)) # make mz and rt numeric\n\nLet‚Äôs look at a m/z by retention time plot again after clustering.\n\n(after_notame &lt;- metab_imputed_clustered_long %&gt;%\n  group_by(mz_rt) %&gt;% # so we only have one point per feature\n  ggplot(aes(x = rt, y = mz)) +\n  geom_point(alpha = 0.01) +\n  theme_minimal() +\n  labs(x = \"Retention time (min)\",\n       y = \"Mass to charge ratio (m/z)\",\n       title = \"m/z by retention time plot after notame\",\n       subtitle = \"C18 reverse phase, positive ionization mode\"))\n\n\n\n\n\nbefore_notame / after_notame"
  },
  {
    "objectID": "activities/05_R.html#assessing-data-quality",
    "href": "activities/05_R.html#assessing-data-quality",
    "title": "Data analysis with R",
    "section": "Assessing data quality",
    "text": "Assessing data quality\nLet‚Äôs make sure that our data is of good quality.\n\nUntransformed data\nFirst we are going to convert the type of some of the columns to match what we want (e.g., run order converted to numeric, species to factor)\n\ntibble(metab_imputed_clustered_long)\n\n# A tibble: 100,716 √ó 9\n   sample_name  sample_or_qc tomato rep_or_plot run_order    mz    rt mz_rt     \n   &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     \n 1 HATS_402_041 Sample       HATS   402                41  100. 2.78  100.11203‚Ä¶\n 2 HATS_402_041 Sample       HATS   402                41  101. 0.611 101.07092‚Ä¶\n 3 HATS_402_041 Sample       HATS   402                41  102. 0.641 102.05495‚Ä¶\n 4 HATS_402_041 Sample       HATS   402                41  103. 2.54  103.05422‚Ä¶\n 5 HATS_402_041 Sample       HATS   402                41  104. 1.07  104.05281‚Ä¶\n 6 HATS_402_041 Sample       HATS   402                41  104. 0.630 104.05926‚Ä¶\n 7 HATS_402_041 Sample       HATS   402                41  104. 0.629 104.07084‚Ä¶\n 8 HATS_402_041 Sample       HATS   402                41  104. 0.600 104.10742‚Ä¶\n 9 HATS_402_041 Sample       HATS   402                41  104. 0.614 104.12482‚Ä¶\n10 HATS_402_041 Sample       HATS   402                41  104. 0.601 104.13063‚Ä¶\n# ‚Ñπ 100,706 more rows\n# ‚Ñπ 1 more variable: rel_abund &lt;dbl&gt;\n\n# make run_order numeric\nmetab_imputed_clustered_long$run_order &lt;- as.numeric(metab_imputed_clustered_long$run_order)\n\n# make treatment and sample_or_qc a factor (i.e., categorical)\nmetab_imputed_clustered_long$tomato &lt;- as.factor(metab_imputed_clustered_long$tomato)\nmetab_imputed_clustered_long$sample_or_qc &lt;- as.factor(metab_imputed_clustered_long$sample_or_qc)\n\n# did it work?\ntibble(metab_imputed_clustered_long)\n\n# A tibble: 100,716 √ó 9\n   sample_name  sample_or_qc tomato rep_or_plot run_order    mz    rt mz_rt     \n   &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     \n 1 HATS_402_041 Sample       HATS   402                41  100. 2.78  100.11203‚Ä¶\n 2 HATS_402_041 Sample       HATS   402                41  101. 0.611 101.07092‚Ä¶\n 3 HATS_402_041 Sample       HATS   402                41  102. 0.641 102.05495‚Ä¶\n 4 HATS_402_041 Sample       HATS   402                41  103. 2.54  103.05422‚Ä¶\n 5 HATS_402_041 Sample       HATS   402                41  104. 1.07  104.05281‚Ä¶\n 6 HATS_402_041 Sample       HATS   402                41  104. 0.630 104.05926‚Ä¶\n 7 HATS_402_041 Sample       HATS   402                41  104. 0.629 104.07084‚Ä¶\n 8 HATS_402_041 Sample       HATS   402                41  104. 0.600 104.10742‚Ä¶\n 9 HATS_402_041 Sample       HATS   402                41  104. 0.614 104.12482‚Ä¶\n10 HATS_402_041 Sample       HATS   402                41  104. 0.601 104.13063‚Ä¶\n# ‚Ñπ 100,706 more rows\n# ‚Ñπ 1 more variable: rel_abund &lt;dbl&gt;\n\n\nLet‚Äôs make a boxplot to see how the metabolite abundance looks across different samples.\n\nmetab_imputed_clustered_long %&gt;%\n  ggplot(aes(x = sample_name, y = rel_abund, fill = tomato)) +\n  geom_boxplot(alpha = 0.6) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\") +\n  labs(title = \"LC-MS (+) Feature Abundances by Sample\",\n       subtitle = \"Data is unscaled\",\n       y = \"Relative abundance\")\n\n\n\n\nCan‚Äôt really see anything because data is skewed.\n\n\nTransformed data\n\nLog2 transformed\nWe will log2 transform our data.\n\nmetab_imputed_clustered_long_log2 &lt;- metab_imputed_clustered_long %&gt;%\n  mutate(rel_abund = log2(rel_abund))\n\nAnd then plot.\n\nmetab_imputed_clustered_long_log2 %&gt;%\n  ggplot(aes(x = sample_name, y = rel_abund, fill = tomato)) +\n  geom_boxplot(alpha = 0.6) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90),\n        legend.position = \"none\") +\n  labs(title = \"LC-MS (+) Feature Abundances by Sample\",\n       subtitle = \"Data is log2 transformed\",\n       y = \"Relative abundance\")\n\n\n\n\nWe can also look at this data by run order to see if we have any overall run order effects visible.\n\nmetab_imputed_clustered_long_log2 %&gt;%\n  mutate(sample_name = fct_reorder(sample_name, run_order)) %&gt;%\n  ggplot(aes(x = sample_name, y = rel_abund, fill = tomato)) +\n  geom_boxplot(alpha = 0.6) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90)) +\n  labs(title = \"LC-MS (+) Feature Abundances by Sample\",\n       subtitle = \"Data is log2 transformed\",\n       y = \"Relative abundance\")\n\n\n\n\n\n\nLog10 transformed\nWe will log10 transform our data.\n\nmetab_imputed_clustered_long_log10 &lt;- metab_imputed_clustered_long %&gt;%\n  mutate(rel_abund = log10(rel_abund))\n\nWe can look at this data where we group by species.\n\nmetab_imputed_clustered_long_log10 %&gt;%\n  ggplot(aes(x = sample_name , y = rel_abund, fill = tomato)) +\n  geom_boxplot(alpha = 0.6) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90)) +\n  labs(title = \"LC-MS (+) Feature Abundances by Sample\",\n       subtitle = \"Data is log10 transformed\",\n       y = \"Relative abundance\")\n\n\n\n\nWe can also look at this data by run order to see if we have any overall run order effects visible.\n\nmetab_imputed_clustered_long_log10 %&gt;%\n  mutate(sample_name = fct_reorder(sample_name, run_order)) %&gt;%\n  ggplot(aes(x = sample_name , y = rel_abund, fill = tomato)) +\n  geom_boxplot(alpha = 0.6) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90)) +\n  labs(title = \"LC-MS (+) Feature Abundances by Sample\",\n       subtitle = \"Data is log10 transformed\",\n       y = \"Relative abundance\")\n\n\n\n\n\n\nPareto scaled\nPareto scaling scales but keeps the fidelity of the original differences in absolute measurement value more than autoscaling. Often data is Pareto scaled after log transofmration\n\nmetab_wide_meta_imputed_log2 &lt;- metab_imputed_clustered_long_log2 %&gt;%\n  select(-mz, -rt) %&gt;%\n  pivot_wider(names_from = \"mz_rt\",\n              values_from = \"rel_abund\")\n\nmetab_imputed_clustered_wide_log2_metabs &lt;- \n  metab_wide_meta_imputed_log2[,6:ncol(metab_wide_meta_imputed_log2)]\n\npareto_scaled &lt;- \n  IMIFA::pareto_scale(metab_imputed_clustered_wide_log2_metabs, center = FALSE)\n\npareto_scaled &lt;- bind_cols(metab_wide_meta_imputed_log2[,1:6], pareto_scaled)\n\nNew names:\n‚Ä¢ `100.112032546963_2.7774892` -&gt; `100.112032546963_2.7774892...6`\n‚Ä¢ `100.112032546963_2.7774892` -&gt; `100.112032546963_2.7774892...7`\n\n\n\npareto_scaled_long &lt;- pareto_scaled %&gt;%\n  pivot_longer(cols = 6:ncol(.),\n               names_to = \"mz_rt\",\n               values_to = \"rel_abund\")\n\npareto_scaled_long %&gt;%\n  # mutate(short_sample_name = fct_reorder(short_sample_name, treatment)) %&gt;%\n  ggplot(aes(x = sample_name, y = rel_abund, fill = tomato)) +\n  geom_boxplot(alpha = 0.6) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90)) +\n  labs(title = \"LC-MS (+) Feature Abundances by Sample\",\n       subtitle = \"Data is Pareto scaled\",\n       y = \"Relative abundance\")\n\n\n\n\nI think pareto scaling is making everything look super the same. I am going to use log2 transformed data for the rest of this analysis."
  },
  {
    "objectID": "activities/05_R.html#pcas",
    "href": "activities/05_R.html#pcas",
    "title": "Data analysis with R",
    "section": "PCAs",
    "text": "PCAs\n\nWith QCs\n\npca_qc &lt;- prcomp(metab_wide_meta_imputed_log2[,-c(1:5)], # remove metadata\n                 scale = FALSE, # we did our own scaling\n                 center = TRUE) # true is the default\n\nsummary(pca_qc)\n\nImportance of components:\n                           PC1     PC2     PC3      PC4     PC5     PC6     PC7\nStandard deviation     49.4976 23.4046 13.8835 11.02059 8.04863 6.79003 6.48999\nProportion of Variance  0.6508  0.1455  0.0512  0.03226 0.01721 0.01225 0.01119\nCumulative Proportion   0.6508  0.7963  0.8475  0.87980 0.89701 0.90926 0.92045\n                           PC8     PC9    PC10    PC11    PC12    PC13    PC14\nStandard deviation     5.07292 4.88781 4.83697 4.43058 4.33549 3.81750 3.53513\nProportion of Variance 0.00684 0.00635 0.00622 0.00521 0.00499 0.00387 0.00332\nCumulative Proportion  0.92728 0.93363 0.93984 0.94506 0.95005 0.95392 0.95724\n                         PC15    PC16    PC17    PC18    PC19    PC20    PC21\nStandard deviation     3.4730 3.32124 3.29971 3.15497 3.04386 2.96524 2.92502\nProportion of Variance 0.0032 0.00293 0.00289 0.00264 0.00246 0.00234 0.00227\nCumulative Proportion  0.9605 0.96338 0.96627 0.96891 0.97138 0.97371 0.97598\n                          PC22    PC23    PC24    PC25    PC26    PC27    PC28\nStandard deviation     2.73539 2.73116 2.65604 2.57754 2.56079 2.49134 2.40585\nProportion of Variance 0.00199 0.00198 0.00187 0.00176 0.00174 0.00165 0.00154\nCumulative Proportion  0.97797 0.97995 0.98183 0.98359 0.98533 0.98698 0.98852\n                          PC29    PC30    PC31    PC32    PC33    PC34   PC35\nStandard deviation     2.33757 2.27331 2.24557 2.15559 2.09508 2.06629 2.0303\nProportion of Variance 0.00145 0.00137 0.00134 0.00123 0.00117 0.00113 0.0011\nCumulative Proportion  0.98997 0.99134 0.99268 0.99392 0.99508 0.99622 0.9973\n                          PC36    PC37    PC38    PC39    PC40    PC41\nStandard deviation     1.81876 1.32424 1.19247 1.11571 1.10965 1.07477\nProportion of Variance 0.00088 0.00047 0.00038 0.00033 0.00033 0.00031\nCumulative Proportion  0.99819 0.99866 0.99904 0.99937 0.99969 1.00000\n                            PC42\nStandard deviation     3.374e-14\nProportion of Variance 0.000e+00\nCumulative Proportion  1.000e+00\n\n\nLook at how much variance is explained by each PC.\n\nimportance_qc &lt;- summary(pca_qc)$importance %&gt;%\n  as.data.frame()\n\nhead(importance_qc)\n\n                            PC1      PC2      PC3      PC4      PC5     PC6\nStandard deviation     49.49761 23.40456 13.88347 11.02059 8.048631 6.79003\nProportion of Variance  0.65083  0.14551  0.05120  0.03226 0.017210 0.01225\nCumulative Proportion   0.65083  0.79634  0.84754  0.87980 0.897010 0.90926\n                            PC7      PC8      PC9    PC10     PC11     PC12\nStandard deviation     6.489991 5.072918 4.887806 4.83697 4.430582 4.335495\nProportion of Variance 0.011190 0.006840 0.006350 0.00622 0.005210 0.004990\nCumulative Proportion  0.920450 0.927280 0.933630 0.93984 0.945060 0.950050\n                           PC13     PC14     PC15     PC16    PC17     PC18\nStandard deviation     3.817502 3.535135 3.472999 3.321239 3.29971 3.154974\nProportion of Variance 0.003870 0.003320 0.003200 0.002930 0.00289 0.002640\nCumulative Proportion  0.953920 0.957240 0.960450 0.963380 0.96627 0.968910\n                           PC19     PC20     PC21     PC22     PC23     PC24\nStandard deviation     3.043857 2.965241 2.925016 2.735389 2.731158 2.656045\nProportion of Variance 0.002460 0.002340 0.002270 0.001990 0.001980 0.001870\nCumulative Proportion  0.971380 0.973710 0.975980 0.977970 0.979950 0.981830\n                          PC25     PC26     PC27     PC28     PC29     PC30\nStandard deviation     2.57754 2.560789 2.491338 2.405849 2.337565 2.273312\nProportion of Variance 0.00176 0.001740 0.001650 0.001540 0.001450 0.001370\nCumulative Proportion  0.98359 0.985330 0.986980 0.988520 0.989970 0.991340\n                           PC31     PC32     PC33     PC34     PC35     PC36\nStandard deviation     2.245567 2.155586 2.095075 2.066294 2.030345 1.818759\nProportion of Variance 0.001340 0.001230 0.001170 0.001130 0.001100 0.000880\nCumulative Proportion  0.992680 0.993920 0.995080 0.996220 0.997310 0.998190\n                           PC37     PC38     PC39     PC40     PC41\nStandard deviation     1.324241 1.192475 1.115708 1.109645 1.074771\nProportion of Variance 0.000470 0.000380 0.000330 0.000330 0.000310\nCumulative Proportion  0.998660 0.999040 0.999370 0.999690 1.000000\n                               PC42\nStandard deviation     3.374155e-14\nProportion of Variance 0.000000e+00\nCumulative Proportion  1.000000e+00\n\n\nGenerate a scree plot.\n\nfviz_eig(pca_qc)\n\n\n\n\nGenerate a scores plot (points are samples) quickly with fviz_pca_ind.\n\nfviz_pca_ind(pca_qc)\n\n\n\n\nMake a scores plot but prettier.\n\n# create a df of pca_qc$x\nscores_raw_qc &lt;- as.data.frame(pca_qc$x)\n\n# bind meta-data\nscores_qc &lt;- bind_cols(metab_wide_meta_imputed_log2[,1:5], # first 5 columns\n                       scores_raw_qc)\n\nPlot.\n\n# create objects indicating percent variance explained by PC1 and PC2\nPC1_percent_qc &lt;- round((importance_qc[2,1])*100, # index 2nd row, 1st column, times 100\n                         1) # round to 1 decimal\nPC2_percent_qc &lt;- round((importance_qc[2,2])*100, 1) \n\n# plot\n# aes(text) is for setting tooltip with plotly later to indicate hover text\n(scores_qc_plot &lt;- scores_qc %&gt;%\n  ggplot(aes(x = PC1, y = PC2, fill = tomato, text = glue(\"Sample: {sample_name},\n                                                           Treatment: {tomato}\"))) +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\") +\n  geom_point(shape = 21, color = \"black\") +\n  theme_minimal() +\n  labs(x = glue(\"PC1: {PC1_percent_qc}%\"), \n       y = glue(\"PC2: {PC2_percent_qc}%\"), \n       title = \"PCA Scores Plot Colored by Tomato Type\"))\n\n\n\n\nThen make your scores plot ineractive so you can see who is who.\n\nggplotly(scores_qc_plot, tooltip = \"text\")\n\n\n\n\n\nMake a loadings plot (points are features) even though it might not be that useful.\n\nfviz_pca_var(pca_qc)\n\n\n\n\nSee what I mean? Not that useful. There are some functions in PCAtools that label only the points that most contribute to each PC. Could also do this manually if its of interest.\n\n\nWithout QCs\n\nmetab_wide_meta_imputed_log2_noqc &lt;- metab_wide_meta_imputed_log2 %&gt;%\n  filter(sample_or_qc == \"Sample\")\n\n\npca_noqc &lt;- prcomp(metab_wide_meta_imputed_log2_noqc[,-c(1:5)], # remove metadata\n                 scale = FALSE, # we did our own scaling\n                 center = TRUE) # true is the default\n\nsummary(pca_noqc)\n\nImportance of components:\n                           PC1     PC2      PC3     PC4     PC5     PC6     PC7\nStandard deviation     52.3444 25.0396 14.67720 9.71020 7.93050 7.25800 5.66967\nProportion of Variance  0.6618  0.1515  0.05203 0.02278 0.01519 0.01272 0.00776\nCumulative Proportion   0.6618  0.8133  0.86531 0.88808 0.90327 0.91600 0.92376\n                           PC8     PC9    PC10    PC11    PC12    PC13    PC14\nStandard deviation     5.36533 5.23938 4.79559 4.76426 4.16395 3.83026 3.77999\nProportion of Variance 0.00695 0.00663 0.00556 0.00548 0.00419 0.00354 0.00345\nCumulative Proportion  0.93071 0.93735 0.94290 0.94838 0.95257 0.95612 0.95957\n                         PC15    PC16    PC17    PC18    PC19    PC20    PC21\nStandard deviation     3.6393 3.57019 3.40914 3.29995 3.23544 3.14882 2.98205\nProportion of Variance 0.0032 0.00308 0.00281 0.00263 0.00253 0.00239 0.00215\nCumulative Proportion  0.9628 0.96584 0.96865 0.97128 0.97381 0.97621 0.97835\n                          PC22    PC23    PC24    PC25    PC26    PC27    PC28\nStandard deviation     2.95667 2.92415 2.79559 2.77350 2.71167 2.60577 2.52969\nProportion of Variance 0.00211 0.00207 0.00189 0.00186 0.00178 0.00164 0.00155\nCumulative Proportion  0.98047 0.98253 0.98442 0.98628 0.98805 0.98969 0.99124\n                          PC29    PC30    PC31    PC32    PC33    PC34    PC35\nStandard deviation     2.47680 2.43329 2.33897 2.26758 2.22361 2.18992 1.96582\nProportion of Variance 0.00148 0.00143 0.00132 0.00124 0.00119 0.00116 0.00093\nCumulative Proportion  0.99272 0.99415 0.99547 0.99671 0.99791 0.99907 1.00000\n                            PC36\nStandard deviation     3.496e-14\nProportion of Variance 0.000e+00\nCumulative Proportion  1.000e+00\n\n\nLook at how much variance is explained by each PC.\n\nimportance_noqc &lt;- summary(pca_noqc)$importance %&gt;%\n  as.data.frame()\n\nhead(importance_noqc)\n\n                            PC1      PC2      PC3      PC4      PC5      PC6\nStandard deviation     52.34437 25.03961 14.67720 9.710205 7.930496 7.258004\nProportion of Variance  0.66183  0.15145  0.05203 0.022780 0.015190 0.012720\nCumulative Proportion   0.66183  0.81327  0.86531 0.888080 0.903270 0.916000\n                            PC7      PC8      PC9     PC10     PC11     PC12\nStandard deviation     5.669667 5.365326 5.239375 4.795594 4.764263 4.163953\nProportion of Variance 0.007760 0.006950 0.006630 0.005560 0.005480 0.004190\nCumulative Proportion  0.923760 0.930710 0.937350 0.942900 0.948380 0.952570\n                           PC13     PC14     PC15     PC16     PC17     PC18\nStandard deviation     3.830256 3.779985 3.639319 3.570192 3.409143 3.299946\nProportion of Variance 0.003540 0.003450 0.003200 0.003080 0.002810 0.002630\nCumulative Proportion  0.956120 0.959570 0.962770 0.965840 0.968650 0.971280\n                           PC19    PC20     PC21     PC22     PC23     PC24\nStandard deviation     3.235437 3.14882 2.982051 2.956675 2.924148 2.795591\nProportion of Variance 0.002530 0.00239 0.002150 0.002110 0.002070 0.001890\nCumulative Proportion  0.973810 0.97621 0.978350 0.980470 0.982530 0.984420\n                           PC25     PC26     PC27     PC28     PC29     PC30\nStandard deviation     2.773496 2.711672 2.605774 2.529691 2.476795 2.433286\nProportion of Variance 0.001860 0.001780 0.001640 0.001550 0.001480 0.001430\nCumulative Proportion  0.986280 0.988050 0.989690 0.991240 0.992720 0.994150\n                           PC31     PC32     PC33     PC34     PC35\nStandard deviation     2.338967 2.267581 2.223606 2.189923 1.965822\nProportion of Variance 0.001320 0.001240 0.001190 0.001160 0.000930\nCumulative Proportion  0.995470 0.996710 0.997910 0.999070 1.000000\n                               PC36\nStandard deviation     3.496207e-14\nProportion of Variance 0.000000e+00\nCumulative Proportion  1.000000e+00\n\n\nGenerate a scree plot.\n\nfviz_eig(pca_noqc)\n\n\n\n\nGenerate a scores plot (points are samples) quickly with fviz_pca_ind.\n\nfviz_pca_ind(pca_noqc)\n\n\n\n\nMake a scores plot but prettier.\n\n# create a df of pca_qc$x\nscores_raw_noqc &lt;- as.data.frame(pca_noqc$x)\n\n# bind meta-data\nscores_noqc &lt;- bind_cols(metab_wide_meta_imputed_log2_noqc[,1:5], # metadata\n                         scores_raw_noqc)\n\nPlot.\n\n# create objects indicating percent variance explained by PC1 and PC2\nPC1_percent_noqc &lt;- round((importance_noqc[2,1])*100, # index 2nd row, 1st column, times 100\n                         1) # round to 1 decimal\nPC2_percent_noqc &lt;- round((importance_noqc[2,2])*100, 1) \n\n# plot\n# aes(text) is for setting tooltip with plotly later to indicate hover text\n(scores_noqc_plot &lt;- scores_noqc %&gt;%\n  ggplot(aes(x = PC1, y = PC2, fill = tomato, text = glue(\"Sample: {sample_name},\n                                                             Treatment: {tomato}\"))) +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  geom_vline(xintercept = 0, linetype = \"dashed\") +\n  geom_point(shape = 21, color = \"black\") +\n  theme_minimal() +\n  labs(x = glue(\"PC1: {PC1_percent_noqc}%\"), \n       y = glue(\"PC2: {PC2_percent_noqc}%\"), \n       title = \"PCA Scores Plot Colored by Tomato Type\"))\n\n\n\n\nThen make your scores plot ineractive so you can see who is who.\n\nggplotly(scores_noqc_plot, tooltip = \"text\")\n\n\n\n\n\nMake a loadings plot (points are features) even though it might not be that useful.\n\nfviz_pca_var(pca_noqc)\n\n\n\n\nSee what I mean? Not that useful. There are some functions in PCAtools that label only the points that most contribute to each PC. Could also do this manually if its of interest."
  },
  {
    "objectID": "activities/05_R.html#univariate-testing",
    "href": "activities/05_R.html#univariate-testing",
    "title": "Data analysis with R",
    "section": "Univariate Testing",
    "text": "Univariate Testing\nI am going to include some sample univariate testing for comparisons between two and more than two groups.\n\nANOVA - &gt; 2 groups\nJust to test it out, I‚Äôm going to test for significant differences between our three tomato groups.\n\n# run series of t-tests\nanova &lt;- metab_imputed_clustered_long_log2 %&gt;%\n  filter(!tomato == \"QC\") %&gt;% # remove QCs\n  dplyr::select(sample_name, tomato, mz_rt, rel_abund) %&gt;%\n  group_by(mz_rt) %&gt;%\n  anova_test(rel_abund ~ tomato)\n\n# adjust pvalues for multiple testing\nanova_padjusted &lt;- p.adjust(anova$p, method = \"BH\") %&gt;%\n  as.data.frame() %&gt;%\n  rename(p_adj = 1)\n\nanova_padj &lt;- bind_cols(as.data.frame(anova), anova_padjusted) %&gt;%\n  rename(padj = 9)\n\n# extract out only the significantly different features\nanova_sig &lt;- anova_padj %&gt;%\n  as.data.frame() %&gt;%\n  filter(p &lt;= 0.05)\n\n# how many features are significantly different between the groups?\nnrow(anova_sig)\n\n[1] 2231\n\n\nDo we think this is reasonable? What if I make a quick boxplot of the relative intensity of the feature that has the smallest p-value from this comparison (236.200891807883_6.022641).\n\nmetab_imputed_clustered_long_log2 %&gt;%\n  filter(mz_rt == \"236.200891807883_6.022641\") %&gt;%\n  ggplot(aes(x = tomato, y = rel_abund, color = tomato)) +\n  geom_boxplot(outlier.shape = NA) +\n  geom_jitter() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Sample type\",\n       y = \"Log2 relative abundance of 236.200891807883_6.022641\",\n       title = \"Difference in log2 relative abundance of 236.200891807883_6.022641 \\nbetween tomato types\")\n\n\n\n\nOk we can see why this is very different across the groups :)\n\n\nT-test, 2 groups\n\nNon-parametric\nData might not be normally distributed so I did a nonparametric test.\n\n# run series of t-tests\noh8243_hats_nonparam &lt;- metab_imputed_clustered_long_log2 %&gt;%\n  filter(tomato == \"OH8243\" | tomato == \"HATS\") %&gt;%\n  dplyr::select(sample_name, tomato, mz_rt, rel_abund) %&gt;%\n  group_by(mz_rt) %&gt;%\n  wilcox_test(rel_abund ~ tomato, \n         paired = FALSE, \n         detailed = TRUE, # gives you more detail in output\n         p.adjust.method = \"BH\") %&gt;% # Benjamini-Hochberg false discovery rate multiple testing correction\n  add_significance() %&gt;%\n  arrange(p)\n\n# extract out only the significantly different features\noh8243_hats_nonparam_sig &lt;- oh8243_hats_nonparam %&gt;%\n  filter(p &lt;= 0.05)\n\n# how many features are significantly different between the groups?\nnrow(oh8243_hats_nonparam_sig)\n\n[1] 1389\n\n\nLet‚Äôs do the same thing again here with a boxplot.\n\nmetab_imputed_clustered_long_log2 %&gt;%\n  filter(mz_rt == \"1004.54196498357_5.227879\") %&gt;%\n  filter(tomato == \"HATS\" | tomato == \"OH8243\") %&gt;%\n  ggplot(aes(x = tomato, y = rel_abund, color = tomato)) +\n  geom_boxplot(outlier.shape = NA) +\n  geom_jitter() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Sample type\",\n       y = \"Log2 relative abundance of 1004.54196498357_5.227879\",\n       title = \"Difference in log2 relative abundance of 1004.54196498357_5.227879 \\nbetween OH8243 and HATS\")\n\n\n\n\nWrite out the significantly different features.\n\nwrite_csv(oh8243_hats_nonparam_sig,\n          file = \"data/oh8243_hats_nonparam_sig.csv\")\n\n\n\nParametric\nOr we can assume data are normally distributed\n\n# run series of t-tests\noh8243_hats_param &lt;- metab_imputed_clustered_long_log2 %&gt;%\n  filter(tomato == \"OH8243\" | tomato == \"HATS\") %&gt;%\n  dplyr::select(sample_name, tomato, mz_rt, rel_abund) %&gt;%\n  group_by(mz_rt) %&gt;%\n  t_test(rel_abund ~ tomato, \n         paired = FALSE, \n         detailed = TRUE, # gives you more detail in output\n         p.adjust.method = \"BH\") %&gt;% # Benjamini-Hochberg false discovery rate multiple testing correction\n  add_significance() %&gt;%\n  arrange(p)\n\n# extract out only the significantly different features\noh8243_hats_param_sig &lt;- oh8243_hats_param %&gt;%\n  filter(p &lt;= 0.05)\n\n# how many features are significantly different between the groups?\nnrow(oh8243_hats_param_sig)\n\n[1] 1397\n\n\nLet‚Äôs do the same thing again here with a boxplot.\n\nmetab_imputed_clustered_long_log2 %&gt;%\n  filter(mz_rt == \"474.357920874411_5.0924287\") %&gt;%\n  filter(tomato == \"HATS\" | tomato == \"OH8243\") %&gt;%\n  ggplot(aes(x = tomato, y = rel_abund, color = tomato)) +\n  geom_boxplot(outlier.shape = NA) +\n  geom_jitter() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Sample type\",\n       y = \"Log2 relative abundance of 474.357920874411_5.0924287\",\n       title = \"Difference in log2 relative abundance of 474.357920874411_5.0924287 \\nbetween OH8243 and HATS\")\n\n\n\n\nWrite out the significantly different features.\n\nwrite_csv(oh8243_hats_nonparam_sig,\n          file = \"data/oh8243_hats_param_sig.csv\")\n\n\n\nVolcano plot\nLet‚Äôs make a volcano plot so we can see which features are significantly different between OH8243 and HATS.\nFirst we wrangle.\n\noh8243_hats_FC &lt;- metab_imputed_clustered_long_log2 %&gt;%\n  filter(tomato == \"OH8243\" | tomato == \"HATS\") %&gt;%\n  group_by(tomato, mz_rt) %&gt;%\n  summarize(mean = mean(rel_abund)) %&gt;%\n  pivot_wider(names_from = tomato, values_from = mean) %&gt;%\n  mutate(HATS_minus_OH8243_log2FC = (HATS - OH8243))\n\n`summarise()` has grouped output by 'tomato'. You can override using the\n`.groups` argument.\n\noh8243_hats_FC_pval &lt;- left_join(oh8243_hats_FC, oh8243_hats_param, by = \"mz_rt\") %&gt;%\n  mutate(neglog10p = -log10(p))\n\nhead(oh8243_hats_FC_pval)\n\n# A tibble: 6 √ó 21\n  mz_rt    HATS OH8243 HATS_minus_OH8243_lo‚Ä¶¬π estimate estimate1 estimate2 .y.  \n  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;                  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;\n1 100.11‚Ä¶  15.2  15.3                 -0.0850  -0.0850      15.2     15.3  rel_‚Ä¶\n2 1001.6‚Ä¶  12.7  12.8                 -0.0761  -0.0761      12.7     12.8  rel_‚Ä¶\n3 1001.8‚Ä¶  12.9  13.0                 -0.0343  -0.0343      12.9     13.0  rel_‚Ä¶\n4 1002.1‚Ä¶  12.7  12.8                 -0.119   -0.119       12.7     12.8  rel_‚Ä¶\n5 1004.5‚Ä¶  14.6   9.56                 5.07     5.07        14.6      9.56 rel_‚Ä¶\n6 1004.6‚Ä¶  10.3   8.97                 1.37     1.37        10.3      8.97 rel_‚Ä¶\n# ‚Ñπ abbreviated name: ¬π‚ÄãHATS_minus_OH8243_log2FC\n# ‚Ñπ 13 more variables: group1 &lt;chr&gt;, group2 &lt;chr&gt;, n1 &lt;int&gt;, n2 &lt;int&gt;,\n#   statistic &lt;dbl&gt;, p &lt;dbl&gt;, df &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;,\n#   method &lt;chr&gt;, alternative &lt;chr&gt;, p.signif &lt;chr&gt;, neglog10p &lt;dbl&gt;\n\n\nLooking at features that are at least 2 fold change between groups and significantly different at p&lt;0.05.\n\nhigher_HATS &lt;- oh8243_hats_FC_pval %&gt;%\n  filter(neglog10p &gt;= 1.3 & HATS_minus_OH8243_log2FC &gt;= 1)\n\nhigher_OH8243 &lt;- oh8243_hats_FC_pval %&gt;%\n  filter(neglog10p &gt;= 1.3 & HATS_minus_OH8243_log2FC &lt;= -1)\n\n(oh8243_hats_volcano &lt;- oh8243_hats_FC_pval %&gt;%\n  ggplot(aes(x = HATS_minus_OH8243_log2FC, y = neglog10p, text = mz_rt)) +\n  geom_point() +\n  geom_point(data = higher_HATS, \n             aes(x = HATS_minus_OH8243_log2FC, y = neglog10p),\n             color = \"red\") +\n  geom_point(data = higher_OH8243, \n             aes(x = HATS_minus_OH8243_log2FC, y = neglog10p),\n             color = \"blue\") +\n  geom_hline(yintercept = 1.3, linetype = \"dashed\") +\n  geom_vline(xintercept = -1, linetype = \"dashed\") +\n  geom_vline(xintercept = 1, linetype = \"dashed\") +\n  labs(x = \"-log2 fold change\",\n       y = \"-log10 p-value\",\n       title = \"OH8243 vs HATS, positive mode\",\n       subtitle = \"Higher in HATS on top right (red), higher in OH8243 on top left (blue)\",\n       caption = \"Dotted lines represent a 2 fold difference between groups and a p-value &lt; 0.05\"))\n\n\n\n\nMake the plot interactive.\n\nggplotly(oh8243_hats_volcano, tooltip = \"text\")"
  },
  {
    "objectID": "activities/03_mzmine.html",
    "href": "activities/03_mzmine.html",
    "title": "Spectral pre-processing with MZmine",
    "section": "",
    "text": "Now that we‚Äôve gone through the collection of LC-MS metabolomics data, we will take our raw datafiles and convert them into a feature table.\n\n\nWe are going to be using some sample data coming from the my lab. These samples are methanolic extracts (more details about their creation are described in Dzakovich et al., Plant Genome 2022) of tomatoes with 3 different genotypes:\n\nOH8243: a typical processing tomato\nLA2213: a wild currant tomato that is high in steroidal alkaloids\nHATS: a high alpha tomatine selection (HATS) that came from a breeding scheme crossing the previous two tomatoes and selecting fruits high in steroidal alkaloids.\n\nAdditionally, we have quality control (QC) samples that are made from pools of each of the tomato extracts, and process blanks (PB) which underwent the same extraction process but instead of adding tomato, added an equivalent mass of water.\nThe extracts were analyzed using a C18 column in positive ion mode on an Agilent 6546 QTOF-MS. The gradient portion of our method is from 0.5 - 7.5 min.\nYou can find a link here to a OneDrive folder that contains all the raw data files to download.\nSamples are named with the following structure:\n\nFirst term is the type of sample (OH8243, LA2213, HATS, QC or PB)\nThe second 3 digit number starting with 4XX, 6XX, or 8XX is a plot code. The QCs and PBs have a two digit number which represents tells you which replicate it is.\nThe last number is the run order\n\nI have not given you every sample from this run, so the run order numbers won‚Äôt be continuous. There are 12 of each of the tomato varieties, 6 QCs, and 3 PBs. If your MZmine is getting bogged down, you don‚Äôt need to use all of these samples, you can practice in using just the QCs. I will give you full feature tables for the data analysis next steps.\nDownload the raw data files and put them in a known location on your computer."
  },
  {
    "objectID": "activities/03_mzmine.html#our-data",
    "href": "activities/03_mzmine.html#our-data",
    "title": "Spectral pre-processing with MZmine",
    "section": "",
    "text": "We are going to be using some sample data coming from the my lab. These samples are methanolic extracts (more details about their creation are described in Dzakovich et al., Plant Genome 2022) of tomatoes with 3 different genotypes:\n\nOH8243: a typical processing tomato\nLA2213: a wild currant tomato that is high in steroidal alkaloids\nHATS: a high alpha tomatine selection (HATS) that came from a breeding scheme crossing the previous two tomatoes and selecting fruits high in steroidal alkaloids.\n\nAdditionally, we have quality control (QC) samples that are made from pools of each of the tomato extracts, and process blanks (PB) which underwent the same extraction process but instead of adding tomato, added an equivalent mass of water.\nThe extracts were analyzed using a C18 column in positive ion mode on an Agilent 6546 QTOF-MS. The gradient portion of our method is from 0.5 - 7.5 min.\nYou can find a link here to a OneDrive folder that contains all the raw data files to download.\nSamples are named with the following structure:\n\nFirst term is the type of sample (OH8243, LA2213, HATS, QC or PB)\nThe second 3 digit number starting with 4XX, 6XX, or 8XX is a plot code. The QCs and PBs have a two digit number which represents tells you which replicate it is.\nThe last number is the run order\n\nI have not given you every sample from this run, so the run order numbers won‚Äôt be continuous. There are 12 of each of the tomato varieties, 6 QCs, and 3 PBs. If your MZmine is getting bogged down, you don‚Äôt need to use all of these samples, you can practice in using just the QCs. I will give you full feature tables for the data analysis next steps.\nDownload the raw data files and put them in a known location on your computer."
  },
  {
    "objectID": "activities/03_mzmine.html#download-msconvert-from-proteowizard",
    "href": "activities/03_mzmine.html#download-msconvert-from-proteowizard",
    "title": "Spectral pre-processing with MZmine",
    "section": "2.1 Download MSConvert from ProteoWizard",
    "text": "2.1 Download MSConvert from ProteoWizard\nIf you don‚Äôt have ProteoWizard, you can download it here: https://proteowizard.sourceforge.io/. Once you download the program, open MSConvert."
  },
  {
    "objectID": "activities/03_mzmine.html#select-files-for-conversion",
    "href": "activities/03_mzmine.html#select-files-for-conversion",
    "title": "Spectral pre-processing with MZmine",
    "section": "2.2 Select files for conversion",
    "text": "2.2 Select files for conversion\n\n\n\nSelecting files to convert in MSConvert\n\n\n\nOpen up MSConvert and in the top left corner of the program, select the files you want to convert. Your directories are going to be different than mine depending on where your files are stored.\nSelect where on your computer you want the converted files to go, and indicate that location in Output Directory."
  },
  {
    "objectID": "activities/03_mzmine.html#set-parameters-for-conversion",
    "href": "activities/03_mzmine.html#set-parameters-for-conversion",
    "title": "Spectral pre-processing with MZmine",
    "section": "2.3 Set parameters for conversion",
    "text": "2.3 Set parameters for conversion\n\n\n\nSetting parameters for conversion in MSConvert\n\n\n\nUncheck zlib compression\nWe are going to convert our profile into centroided data which I think makes the deconvolution in MZmine easier. We will do that by under Filter, selecting Peak Picking, and picking the Vendor option under Algorithm. Here, we only have MS1 data so we only want MS level 1. We will add this to the table below.\nThe more files you have, the longer this will take, you can indicate that convert more than 1 file in parallel. Doing 4 at a time, about 40 samples took my lab data processing computer (which has a 128 MB RAM and 16 cores) a couple of minutes."
  },
  {
    "objectID": "activities/03_mzmine.html#using-mzmine-at-osc-ohio-supercomputer-center",
    "href": "activities/03_mzmine.html#using-mzmine-at-osc-ohio-supercomputer-center",
    "title": "Spectral pre-processing with MZmine",
    "section": "3.1 Using MZmine at OSC (Ohio Supercomputer Center)",
    "text": "3.1 Using MZmine at OSC (Ohio Supercomputer Center)\nSome parts of the MZmine pre-processing can be quite ram intensive and may struggle to run on your laptop. To solve this problem, you can run your deconvolution on a supercomputer. I‚Äôm providing here some instructions on how to do this at OSC.\n\n3.1.1 Create an OSC account\nYou can create an account at OSC at this link.\n\n\n3.1.2 Share your OSC username with Jess\nThis will allow Jess to add you to our OSC project which will direct the billing appropriately (to Jess, not to you).\n\n\n3.1.3 Log onto OSC\nNavigate to https://ondemand.osc.edu/ and log in. Make sure you are using PASXXXX.\n\n\n3.1.4 Download the portable Linux version of MZmine\nMZmine has a portal Linux version which you can download while on OSC, and then use. Navigate to https://ondemand.osc.edu/. You can open a Pitzer desktop session.\n\n\n\nAccessing Pitzer on OSC\n\n\nOnce you are in Pitzer desktop, you can open an internet browser and navigate to https://github.com/mzmine/mzmine3/releases/tag/v3.9.0. At the time I put this tutorial together, the most recent version of MZmine is 3.9.0. Download the version for the Linux portable version.\n\n\n3.1.5 Open MZmine\nOnce you download MZmine, unzip the file, right click on the bin directory and select Open a terminal here.\nThen in your terminal, execute the following code one line at a time:\n\nchmod a+x MZmine\n\n\n./MZmine\n\nThe MZmine GUI should now be open."
  },
  {
    "objectID": "activities/03_mzmine.html#using-mzmine-on-your-own-computer",
    "href": "activities/03_mzmine.html#using-mzmine-on-your-own-computer",
    "title": "Spectral pre-processing with MZmine",
    "section": "3.2 Using MZmine on your own computer",
    "text": "3.2 Using MZmine on your own computer\nIf you don‚Äôt have MZmine, you can download it at this link: https://mzmine.github.io/.\nMZmine has extremely good documentation, so if you want to read more about any particular parameter, you can do so here: https://mzmine.github.io/mzmine_documentation/index.html."
  },
  {
    "objectID": "activities/03_mzmine.html#save-your-project",
    "href": "activities/03_mzmine.html#save-your-project",
    "title": "Spectral pre-processing with MZmine",
    "section": "4.1 Save your project",
    "text": "4.1 Save your project\nYou can save your project after different steps, this process can take a little while, but it allows you to go back to any part of your workflow and look at results or make changes.\nIn the top toolbar, navigate to Project &gt; Save project as and put your project files in an appropriate directory on your computer. A good place would be in the parent directory where your data files are.\nYou can save your file as Referencing (small) given that you don‚Äôt move where the input files are. This takes up less space but can lead to later incompatibility projects if files get moved. The status bar at the bottom of MZmine will tell you your current status.\n\n\n\nSaving your project in MZmine"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Metabolomics short course, UFRGS üáßüá∑ May 2024",
    "section": "",
    "text": "Instructor: Jessica Cooperstone, Ph.D. Associate Professor, Horticulture and Crop Science, Food Science and Technology The Ohio State University\nThe purpose of this short course is to give students a conceptual and hands-on introduction to the metabolomics workflow, experimental design process, collection of data via LC combined with high resolution MS, data analysis process, and compound identification.\nBelow is an overview of the material to be covered in this workshop.\n\n\n\nTopic\n\n\nIntroduction to metabolomics\n\n\nStudy design and sample collection\n\n\nLC-MS data acquisition and pre-processing:\n\nBasics of LC and MS\nSample preparation\nData collection\nRaw data processing to create a feature table using MZmine\n\n\n\nData analysis using MetaboAnalyst:\n\nLook at your data and assess quality\nCreating principal components analysis (PCA) plots\nUnivariate group difference testing\nMultivariate analysis\n\n\n\nCompound ID:\n\nUsing MS1 and MS2 databases\nInterpreting MS/MS spectra\nConfirmation with authentic standards\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "activities/04_metaboanalyst.html",
    "href": "activities/04_metaboanalyst.html",
    "title": "Data analysis with MetaboAnalyst",
    "section": "",
    "text": "Now that we have a filtered, final feature table, we can get started on our data analysis, including understanding if our data is of good quality before we begin to make biological interpretations as to what our results mean. We are going to conduct this analysis using MetaboAnalyst which is at version 6.0 when I put together this tutorial. You can read more about MetaboAnalyist on their website or in their publications (Ewald et al. 2024).\n\n\nBefore we upload our data, let‚Äôs make sure its in a suitable format. If we go to the Data Formats link on the left side of the website, we can see example data sets which will help us format our data. Our data looks like this right out of MZmine:\n\n\n\nOur data, straight from MZmine\n\n\n\nOur data contains samples in rows, and features in columns.\n\nWe will start with doing statistics (one factor) and we have a peak intensity table, so the file called lcms_table.csv is a good one for us to look at.\n\n\n\nLCMS sample data\n\n\nIn this data, we have features in rows and samples in columns. There is also a header row which contains the unique sample names, and a second row called Label which contains the groups. We will need to adjust our data to look like this. This includes\n\nAdding a row called Label which contains the sample groups (here, QC, HATS, LA2213, or OH8243).\n\n\n\n\nAdd a row which contains Label and the tomato identities\n\n\n\nCreating a single column with the mz_rt as a unique identifier. We can do this with the function =CONCATENATE() in Excel. Then we can fill down the row. Then be sure to copy this column and Paste &gt; Paste special &gt; Values since when we later remove some of the other columns that are inputs to this one, the formulas will break.\n\n\n\n\nHow to combine the row m/z and row retention time columns to be one unique mz_rt\n\n\n\nNow we can remove row ID, row m/z and row retention time.\n\nOur data should now look like this:\n\n\n\nOur data ready to import into MetaboAnalyst"
  },
  {
    "objectID": "activities/04_metaboanalyst.html#data-formatting",
    "href": "activities/04_metaboanalyst.html#data-formatting",
    "title": "Data analysis with MetaboAnalyst",
    "section": "",
    "text": "Before we upload our data, let‚Äôs make sure its in a suitable format. If we go to the Data Formats link on the left side of the website, we can see example data sets which will help us format our data. Our data looks like this right out of MZmine:\n\n\n\nOur data, straight from MZmine\n\n\n\nOur data contains samples in rows, and features in columns.\n\nWe will start with doing statistics (one factor) and we have a peak intensity table, so the file called lcms_table.csv is a good one for us to look at.\n\n\n\nLCMS sample data\n\n\nIn this data, we have features in rows and samples in columns. There is also a header row which contains the unique sample names, and a second row called Label which contains the groups. We will need to adjust our data to look like this. This includes\n\nAdding a row called Label which contains the sample groups (here, QC, HATS, LA2213, or OH8243).\n\n\n\n\nAdd a row which contains Label and the tomato identities\n\n\n\nCreating a single column with the mz_rt as a unique identifier. We can do this with the function =CONCATENATE() in Excel. Then we can fill down the row. Then be sure to copy this column and Paste &gt; Paste special &gt; Values since when we later remove some of the other columns that are inputs to this one, the formulas will break.\n\n\n\n\nHow to combine the row m/z and row retention time columns to be one unique mz_rt\n\n\n\nNow we can remove row ID, row m/z and row retention time.\n\nOur data should now look like this:\n\n\n\nOur data ready to import into MetaboAnalyst"
  },
  {
    "objectID": "activities/02_design-experiment.html",
    "href": "activities/02_design-experiment.html",
    "title": "Design your own experiment",
    "section": "",
    "text": "Get together in small groups and spend ~10-15 min designing a metabolomics experiment around a research question of one (or more than one) of the group members. After this discussion period, we will reconvene in our larger group and each team will share the following information about your experiments:\n\nWhat was your research question?\nWhat is your hypothesis?\nWhat samples are you selecting to analyze?\nHow will they be collected?\n\n\n\n\n Back to top"
  }
]