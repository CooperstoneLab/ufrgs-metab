<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jessica Cooperstone">

<title>Data analysis with MetaboAnalyst</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="../lectures/01_intro.html" rel="" target="">
 <span class="dropdown-text">Introduction to metabolomics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/02_design-collection.html" rel="" target="">
 <span class="dropdown-text">Study design and sample collection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/03_lc-ms.html" rel="" target="">
 <span class="dropdown-text">LC-MS data acquisition and pre-processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/04_data-analysis.html" rel="" target="">
 <span class="dropdown-text">Data analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/05_compound-id.html" rel="" target="">
 <span class="dropdown-text">Compound ID</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-activities" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Activities</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-activities">    
        <li>
    <a class="dropdown-item" href="../activities/02_design-experiment.html" rel="" target="">
 <span class="dropdown-text">Design your own experiment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/03_mzmine.html" rel="" target="">
 <span class="dropdown-text">LC-MS pre-processing with MZmine</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/04_metaboanalyst.html" rel="" target="">
 <span class="dropdown-text">Data analysis with MetaboAnalyst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/05_R.html" rel="" target="">
 <span class="dropdown-text">Data analysis with R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://mzmine.github.io/" rel="" target="">
 <span class="dropdown-text">MZmine 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.metaboanalyst.ca/" rel="" target="">
 <span class="dropdown-text">MetaboAnalyst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hmdb.ca/" rel="" target="">
 <span class="dropdown-text">HMDB</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://buckeyemailosu-my.sharepoint.com/:f:/g/personal/cooperstone_1_osu_edu/Em__DQbIlCBBuadrLMNDr8gB7-_tQayjX1JSzSdubjwhQA?e=QZdzx4" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-cloud-arrow-down"></i></a>
    <a href="https://github.com/CooperstoneLab/ufrgs-metabolomics" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#data-formatting" id="toc-data-formatting" class="nav-link" data-scroll-target="#data-formatting"><span class="header-section-number">1.1</span> Data formatting</a></li>
  </ul></li>
  <li><a href="#import-into-metaboanalyst" id="toc-import-into-metaboanalyst" class="nav-link" data-scroll-target="#import-into-metaboanalyst"><span class="header-section-number">2</span> Import into MetaboAnalyst</a></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing"><span class="header-section-number">3</span> Data processing</a>
  <ul class="collapse">
  <li><a href="#data-check" id="toc-data-check" class="nav-link" data-scroll-target="#data-check"><span class="header-section-number">3.1</span> Data check</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="header-section-number">3.2</span> Missing values</a></li>
  <li><a href="#data-filters" id="toc-data-filters" class="nav-link" data-scroll-target="#data-filters"><span class="header-section-number">3.3</span> Data filters</a></li>
  </ul></li>
  <li><a href="#normalization" id="toc-normalization" class="nav-link" data-scroll-target="#normalization"><span class="header-section-number">4</span> Normalization</a></li>
  <li><a href="#statistics" id="toc-statistics" class="nav-link" data-scroll-target="#statistics"><span class="header-section-number">5</span> Statistics</a>
  <ul class="collapse">
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca"><span class="header-section-number">5.1</span> PCA</a></li>
  <li><a href="#pca-1" id="toc-pca-1" class="nav-link" data-scroll-target="#pca-1"><span class="header-section-number">5.2</span> PCA</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">5.3</span> ANOVA</a></li>
  <li><a href="#dendrogram-i.e.-hierarchical-clustering" id="toc-dendrogram-i.e.-hierarchical-clustering" class="nav-link" data-scroll-target="#dendrogram-i.e.-hierarchical-clustering"><span class="header-section-number">5.4</span> Dendrogram (i.e., hierarchical clustering)</a></li>
  <li><a href="#k-means-a-different-type-of-clustering" id="toc-k-means-a-different-type-of-clustering" class="nav-link" data-scroll-target="#k-means-a-different-type-of-clustering"><span class="header-section-number">5.5</span> K-means (a different type of clustering)</a></li>
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations"><span class="header-section-number">5.6</span> Correlations</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">5.7</span> Random forest</a></li>
  <li><a href="#pattern-hunter" id="toc-pattern-hunter" class="nav-link" data-scroll-target="#pattern-hunter"><span class="header-section-number">5.8</span> Pattern hunter</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data analysis with MetaboAnalyst</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jessica Cooperstone </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Now that we have a filtered, final feature table, we can get started on our data analysis, including understanding if our data is of good quality before we begin to make biological interpretations as to what our results mean. We are going to conduct this analysis using <a href="https://www.metaboanalyst.ca/">MetaboAnalyst</a> which is at version 6.0 when I put together this tutorial. You can read more about MetaboAnalyist on their website or in their publications <span class="citation" data-cites="ewald2024">(<a href="#ref-ewald2024" role="doc-biblioref">Ewald et al. 2024</a>)</span>.</p>
<section id="data-formatting" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="data-formatting"><span class="header-section-number">1.1</span> Data formatting</h2>
<p>Before we upload our data, let’s make sure its in a suitable format. If we go to the <a href="https://www.metaboanalyst.ca/docs/Format.xhtml">Data Formats link</a> on the left side of the website, we can see example data sets which will help us format our data. Our data looks like this right out of MZmine:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/raw.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Our data, straight from MZmine</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>Our data contains samples in rows, and features in columns.</p>
</blockquote>
<p>We will start with doing statistics (one factor) and we have a peak intensity table, so the file called <a href="https://www.xialab.ca/api/download/metaboanalyst/lcms_table.csv"><code>lcms_table.csv</code></a> is a good one for us to look at.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/lc-ms-table.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">LCMS sample data</figcaption>
</figure>
</div>
<p>In this data, we have features in rows and samples in columns. There is also a header row which contains the unique sample names, and a second row called Label which contains the groups. We will need to adjust our data to look like this. This includes</p>
<ul>
<li>Adding a row called Label which contains the sample groups (here, QC, HATS, LA2213, or OH8243).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/add-label.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Add a row which contains Label and the tomato identities</figcaption>
</figure>
</div>
<ul>
<li>Creating a single column with the mz_rt as a unique identifier. We can do this with the function <code>=CONCATENATE()</code> in Excel. Then we can fill down the row. Then be sure to copy this column and <code>Paste</code> &gt; <code>Paste special</code> &gt; <code>Values</code> since when we later remove some of the other columns that are inputs to this one, the formulas will break.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/add-mz_rt.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">How to combine the row m/z and row retention time columns to be one unique mz_rt</figcaption>
</figure>
</div>
<ul>
<li>Now we can remove row ID, row m/z and row retention time.</li>
</ul>
<p>Our data should now look like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/data-for-metaboanalyst.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Our data ready to import into MetaboAnalyst</figcaption>
</figure>
</div>
</section>
</section>
<section id="import-into-metaboanalyst" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import into MetaboAnalyst</h1>
<p>Remember that when you are using MetaboAnalyst through the web browser that it will eventually time out, so starting an analysis, and walking away for a period of time is not a good idea. Make sure you keep good notes on what you do during your analysis.</p>
<p>Navigate to <a href="https://www.metaboanalyst.ca/" class="uri">https://www.metaboanalyst.ca/</a> and click on the red “Click here to start button”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/metaboanalyst-start.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Get started in MetaboAnalyst</figcaption>
</figure>
</div>
<p>We have already processed out spectra so we are going to click on Statistical Analysis (one factor).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/metaboanalyst-start.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Begin statistical analysis in MetaboAnalyst</figcaption>
</figure>
</div>
<p>Now we want to upload our data. We have our file saved as a .csv and our data is as peak intensities. In our case, samples are in columns and data is unpaired. Once we have done this, we can press submit just to the right of our input.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/upload.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Upload our data</figcaption>
</figure>
</div>
</section>
<section id="data-processing" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data processing</h1>
<section id="data-check" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-check"><span class="header-section-number">3.1</span> Data check</h2>
<p>Once the data has been imported, we can first look at the data integrity check.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/integrity-check.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Data integrity check</figcaption>
</figure>
</div>
<p>We see that:</p>
<ul>
<li>Samples are in columns and features in rows</li>
<li>Our data is in <code>.csv</code> format</li>
<li>We have 42 samples and 2514 peaks - this is what we would expect</li>
<li>Samples are not paired - this is what we would expect</li>
<li>3 groups were dtected - I might expect 4 groups - OH8243, LA2213, HATS, and QCs. If we click the “Edit Groups” button we can see that the Label for each of our groups has inherited correctly, but that it seems like QC isn’t being counted as a group.</li>
<li>A total of 0 (0%) missing values were detected - this makes sense as data that is missing here is coded as zero.</li>
</ul>
<p>If we agree with this, we can click Proceed. MetaboAnalyst will bring you directly to the Data filtering step, but we can go back one to see how missing values are handled.</p>
</section>
<section id="missing-values" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="missing-values"><span class="header-section-number">3.2</span> Missing values</h2>
<p>Here you can tell MetaboAnalyst what you want done with missing values. Here we don’t have any, but if you did you could indicate:</p>
<ul>
<li>Whether you want to remove features that have a lot of missing values</li>
<li>What you want to do to estimate the remaining missing values.</li>
</ul>
</section>
<section id="data-filters" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="data-filters"><span class="header-section-number">3.3</span> Data filters</h2>
<p>In this step, we can filter variables based on different rules. These include:</p>
<ul>
<li>Features that are very variable i nthe QCs. We don’t need to do this because we already did it manually.</li>
<li>Features that are near constant across the conditions (i.e., those that have very low standard deviations)</li>
<li>Features that are very low</li>
</ul>
<p>I prefer to do this kind of filtering outside of MetaboAnalyst - you could do this in Excel if you wanted to. Here, we are not going to do any more filtering. We can just click Proceed (and skip this filtering).</p>
</section>
</section>
<section id="normalization" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Normalization</h1>
<p>We can normalize our samples in different ways. MetaboAnalyst gives is 3 categories of transformation types:</p>
<ul>
<li>Sample normalization for general adjustment for systemic differences across samples. Here would could adjust by weight, by a reference features, or by total signal.</li>
<li>Data transformation including by log (base 10), square root, or cubed room</li>
<li>Data scaling</li>
</ul>
<p>You can pick a nornalization and view the result. This is nice because you can see what your normalization will do before picking the most appropriate one.</p>
<p>For example, I am going to try just log10 transforming my samples. When I do this, I can look at the result from both a feature and sample view.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Feature view</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Sample view</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/log10-feature-view.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Feature view after log10 normalization</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/log10-sample-view.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Sample view after log10 normalization</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>I can contrast this with a log10 transformation and then Pareto scaling.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Feature view</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Sample view</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/log10-pareto-feature-view.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Feature view after log10 normalization</figcaption>
</figure>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/04/log10-pareto-sample-view.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Sample view after log10 normalization</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="statistics" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Statistics</h1>
<p>Now that our data is set, we can use different analysis methods to understand our data quality, and differences among sample groups. Remember, there are analyses we want to do both with and without the QCs. I like to see a PCA that includes the QCs, but then I’d remove them and retain our three tomato groups for further analysis.</p>
<p>Let’s look with our QCs at the PCA first, and then we will remove those samples.</p>
<section id="pca" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="pca"><span class="header-section-number">5.1</span> PCA</h2>
<p><img src="img/04/pca-qcs-scores-5PC.png" class="img-fluid"></p>
<p><img src="img/04/pca-qc-scree.png" class="img-fluid"></p>
<p><img src="img/04/pca-qc-scores.png" class="img-fluid"></p>
<p><img src="img/04/pca-qc-loadings.png" class="img-fluid"></p>
<p><img src="img/04/578.5296215_5.0895395_qc.png" class="img-fluid"></p>
<p>That that we can see that our QCs are tightly clustering together, we can save that PCA scores plot and remove our QC samples. We can do that by navigating to <code>Processing</code> &gt; <code>Data editor</code> in the left part of the browser.</p>
<p><img src="img/04/data-editor.png" class="img-fluid"></p>
<p>Don’t forget to re-normalize.</p>
</section>
<section id="pca-1" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="pca-1"><span class="header-section-number">5.2</span> PCA</h2>
</section>
<section id="anova" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="anova"><span class="header-section-number">5.3</span> ANOVA</h2>
</section>
<section id="dendrogram-i.e.-hierarchical-clustering" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="dendrogram-i.e.-hierarchical-clustering"><span class="header-section-number">5.4</span> Dendrogram (i.e., hierarchical clustering)</h2>
</section>
<section id="k-means-a-different-type-of-clustering" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="k-means-a-different-type-of-clustering"><span class="header-section-number">5.5</span> K-means (a different type of clustering)</h2>
</section>
<section id="correlations" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="correlations"><span class="header-section-number">5.6</span> Correlations</h2>
</section>
<section id="random-forest" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">5.7</span> Random forest</h2>
</section>
<section id="pattern-hunter" class="level2" data-number="5.8">




</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">5.8 Pattern hunter</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-ewald2024" class="csl-entry" role="listitem">
Ewald, Jessica D., Guangyan Zhou, Yao Lu, Jelena Kolic, Cara Ellis, James D. Johnson, Patrick E. Macdonald, and Jianguo Xia. 2024. <span>“Web-Based Multi-Omics Integration Using the Analyst Software Suite.”</span> <em>Nature Protocols</em>, February. <a href="https://doi.org/10.1038/s41596-023-00950-4">https://doi.org/10.1038/s41596-023-00950-4</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Created with RStudio and <a href="https://quarto.org/">Quarto</a> <br> © Jessica Cooperstone, 2024, License: <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a> <br> <a href="https://osu-codeclub.github.io/#category=website">Want to make a website like this one?</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>