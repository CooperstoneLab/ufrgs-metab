<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jessica Cooperstone">

<title>Data analysis with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="../lectures/01_intro.html" rel="" target="">
 <span class="dropdown-text">Introduction to metabolomics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/02_design-collection.html" rel="" target="">
 <span class="dropdown-text">Study design and sample collection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/03_lc-ms.html" rel="" target="">
 <span class="dropdown-text">LC-MS data acquisition and pre-processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/04_data-analysis.html" rel="" target="">
 <span class="dropdown-text">Data analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/05_compound-id.html" rel="" target="">
 <span class="dropdown-text">Compound ID</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-activities" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Activities</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-activities">    
        <li>
    <a class="dropdown-item" href="../activities/02_design-experiment.html" rel="" target="">
 <span class="dropdown-text">Design your own experiment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/03_mzmine.html" rel="" target="">
 <span class="dropdown-text">LC-MS pre-processing with MZmine</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/04_metaboanalyst.html" rel="" target="">
 <span class="dropdown-text">Data analysis with MetaboAnalyst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/05_R.html" rel="" target="">
 <span class="dropdown-text">Data analysis with R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://mzio.io/" rel="" target="">
 <span class="dropdown-text">MZmine</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.metaboanalyst.ca/" rel="" target="">
 <span class="dropdown-text">MetaboAnalyst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hmdb.ca/" rel="" target="">
 <span class="dropdown-text">HMDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="http://ondemand.osc.edu/" rel="" target="">
 <span class="dropdown-text">Ohio Supercomputer Center (OSC)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://buckeyemailosu-my.sharepoint.com/:f:/g/personal/cooperstone_1_osu_edu/Em__DQbIlCBBuadrLMNDr8gB7-_tQayjX1JSzSdubjwhQA?e=QZdzx4" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-cloud-arrow-down"></i></a>
    <a href="https://github.com/CooperstoneLab/ufrgs-metab" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries">Load libraries</a></li>
  <li><a href="#read-in-data" id="toc-read-in-data" class="nav-link" data-scroll-target="#read-in-data">Read in Data</a></li>
  <li><a href="#rt-filter-if-necessary" id="toc-rt-filter-if-necessary" class="nav-link" data-scroll-target="#rt-filter-if-necessary">RT filter if necessary</a></li>
  </ul></li>
  <li><a href="#cleaning-up-data" id="toc-cleaning-up-data" class="nav-link" data-scroll-target="#cleaning-up-data">Cleaning up data</a>
  <ul class="collapse">
  <li><a href="#create-mz_rt" id="toc-create-mz_rt" class="nav-link" data-scroll-target="#create-mz_rt">Create mz_rt</a></li>
  <li><a href="#clean-up-file-names" id="toc-clean-up-file-names" class="nav-link" data-scroll-target="#clean-up-file-names">Clean up file names</a></li>
  </ul></li>
  <li><a href="#start-filtering" id="toc-start-filtering" class="nav-link" data-scroll-target="#start-filtering">Start filtering</a>
  <ul class="collapse">
  <li><a href="#check-for-duplicates" id="toc-check-for-duplicates" class="nav-link" data-scroll-target="#check-for-duplicates">Check for duplicates</a>
  <ul class="collapse">
  <li><a href="#cv-function" id="toc-cv-function" class="nav-link" data-scroll-target="#cv-function">CV function</a></li>
  </ul></li>
  <li><a href="#counting-qcs" id="toc-counting-qcs" class="nav-link" data-scroll-target="#counting-qcs">Counting QCs</a></li>
  <li><a href="#filter-on-qc-cv" id="toc-filter-on-qc-cv" class="nav-link" data-scroll-target="#filter-on-qc-cv">Filter on QC CV</a></li>
  <li><a href="#merge-back-the-rest-of-the-data" id="toc-merge-back-the-rest-of-the-data" class="nav-link" data-scroll-target="#merge-back-the-rest-of-the-data">Merge back the rest of the data</a></li>
  <li><a href="#process-blanks" id="toc-process-blanks" class="nav-link" data-scroll-target="#process-blanks">Process blanks</a></li>
  <li><a href="#save-your-file" id="toc-save-your-file" class="nav-link" data-scroll-target="#save-your-file">Save your file</a></li>
  </ul></li>
  <li><a href="#start-analysis" id="toc-start-analysis" class="nav-link" data-scroll-target="#start-analysis">Start analysis</a>
  <ul class="collapse">
  <li><a href="#wrangle-sample-names" id="toc-wrangle-sample-names" class="nav-link" data-scroll-target="#wrangle-sample-names">Wrangle sample names</a></li>
  <li><a href="#data-summaries" id="toc-data-summaries" class="nav-link" data-scroll-target="#data-summaries">Data summaries</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">Missing data</a>
  <ul class="collapse">
  <li><a href="#surveying-missingness" id="toc-surveying-missingness" class="nav-link" data-scroll-target="#surveying-missingness">Surveying missingness</a></li>
  <li><a href="#imputing-missing-values" id="toc-imputing-missing-values" class="nav-link" data-scroll-target="#imputing-missing-values">Imputing missing values</a></li>
  </ul></li>
  <li><a href="#feature-clustering-with-notame" id="toc-feature-clustering-with-notame" class="nav-link" data-scroll-target="#feature-clustering-with-notame">Feature clustering with <code>notame</code></a>
  <ul class="collapse">
  <li><a href="#wrangling-data" id="toc-wrangling-data" class="nav-link" data-scroll-target="#wrangling-data">Wrangling data</a></li>
  <li><a href="#find-connections" id="toc-find-connections" class="nav-link" data-scroll-target="#find-connections">Find connections</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  </ul></li>
  <li><a href="#assessing-data-quality" id="toc-assessing-data-quality" class="nav-link" data-scroll-target="#assessing-data-quality">Assessing data quality</a>
  <ul class="collapse">
  <li><a href="#untransformed-data" id="toc-untransformed-data" class="nav-link" data-scroll-target="#untransformed-data">Untransformed data</a></li>
  <li><a href="#transformed-data" id="toc-transformed-data" class="nav-link" data-scroll-target="#transformed-data">Transformed data</a></li>
  </ul></li>
  <li><a href="#pcas" id="toc-pcas" class="nav-link" data-scroll-target="#pcas">PCAs</a>
  <ul class="collapse">
  <li><a href="#with-qcs" id="toc-with-qcs" class="nav-link" data-scroll-target="#with-qcs">With QCs</a></li>
  <li><a href="#without-qcs" id="toc-without-qcs" class="nav-link" data-scroll-target="#without-qcs">Without QCs</a></li>
  </ul></li>
  <li><a href="#univariate-testing" id="toc-univariate-testing" class="nav-link" data-scroll-target="#univariate-testing">Univariate Testing</a>
  <ul class="collapse">
  <li><a href="#anova---2-groups" id="toc-anova---2-groups" class="nav-link" data-scroll-target="#anova---2-groups">ANOVA - &gt; 2 groups</a></li>
  <li><a href="#t-test-2-groups" id="toc-t-test-2-groups" class="nav-link" data-scroll-target="#t-test-2-groups">T-test, 2 groups</a></li>
  </ul></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-means clustering</a></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">Hierarchical clustering</a></li>
  <li><a href="#pls-da" id="toc-pls-da" class="nav-link" data-scroll-target="#pls-da">PLS-DA</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">Random forest</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data analysis with R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jessica Cooperstone </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We aren’t going to go over this in the workshop, but I wanted to show you an example of the workflow my team might use for doing the first pass analysis of metabolomics data. We are going to use the feature table directly from MZmine (without any filtering) and will conduct our filtering and analysis in R.</p>
<section id="load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="load-libraries">Load libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># visualizing PCA results</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue) <span class="co"># for easy pasting</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># quick interactive plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(proxyC) <span class="co"># more efficient large matrices</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table) <span class="co"># easy transposing</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># for cleaning names and checking duplicates</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(notame) <span class="co"># for collapsing ions coming from the same metabolite</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel) <span class="co"># for parallelizing notame specifically</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># for making multi-panel plots</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix) <span class="co"># for additional univariate functionality</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(philentropy) <span class="co"># for hierarchical clustering</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro) <span class="co"># for hierarchical clustering plotting</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ropls) <span class="co"># for pls</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># for random forest</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for random forest confusion matrices</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># this is at the end hoping that the default select will be that from dplyr</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for everything</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you get deconvoluted data from MZmine or similar programs, you need to wrangle your data in such a way that you can conduct your analysis on it.</p>
</section>
<section id="read-in-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-data">Read in Data</h2>
<p>First we want to read in our raw data. The code here is to read in data directly from MZmine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>metabdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/Feature_list_MZmine_2560.csv"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_names =</span> <span class="cn">TRUE</span>) <span class="co"># has headers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 2560 Columns: 49
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," dbl
(48): row ID, row m/z, row retention time, HATS_402_041.mzML Peak height... lgl
(1): ...49
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...49`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metabdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2560   49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at beginning of the dataset</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>metabdata[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 8 × 8
  `row ID` `row m/z` `row retention time` `HATS_402_041.mzML Peak height`
     &lt;dbl&gt;     &lt;dbl&gt;                &lt;dbl&gt;                           &lt;dbl&gt;
1     3106      100.                2.78                           26623.
2      364      101.                0.611                         105494.
3      453      102.                0.641                         413981.
4     5568      103.                3.98                            9505.
5     2723      103.                2.54                          196964.
6     1424      104.                1.07                           75342.
7      397      104.                0.630                         911384.
8      426      104.                0.629                        2498815 
# ℹ 4 more variables: `HATS_403_037.mzML Peak height` &lt;dbl&gt;,
#   `HATS_404_040.mzML Peak height` &lt;dbl&gt;,
#   `HATS_401_022.mzML Peak height` &lt;dbl&gt;,
#   `HATS_408_043.mzML Peak height` &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features do we have?</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(metabdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2560</code></pre>
</div>
</div>
<p>Note there is no metadata included in this file. Just m/z, retention time, and a column for each sample, where values are peak heights. We are using peak height instead of peak area because it is less dependent on bad peak shape which you get sometimes with metabolomics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(metabdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] "row ID"                          "row m/z"                        
 [3] "row retention time"              "HATS_402_041.mzML Peak height"  
 [5] "HATS_403_037.mzML Peak height"   "HATS_404_040.mzML Peak height"  
 [7] "HATS_401_022.mzML Peak height"   "HATS_408_043.mzML Peak height"  
 [9] "HATS_405_025.mzML Peak height"   "HATS_406_055.mzML Peak height"  
[11] "HATS_407_059.mzML Peak height"   "HATS_412_019.mzML Peak height"  
[13] "HATS_409_056.mzML Peak height"   "HATS_410_018.mzML Peak height"  
[15] "HATS_411_044.mzML Peak height"   "LA2213_602_035.mzML Peak height"
[17] "LA2213_603_045.mzML Peak height" "LA2213_601_051.mzML Peak height"
[19] "LA2213_604_016.mzML Peak height" "LA2213_605_017.mzML Peak height"
[21] "LA2213_607_032.mzML Peak height" "LA2213_608_024.mzML Peak height"
[23] "LA2213_606_033.mzML Peak height" "LA2213_609_058.mzML Peak height"
[25] "LA2213_610_050.mzML Peak height" "LA2213_612_046.mzML Peak height"
[27] "OH8243_801_036.mzML Peak height" "OH8243_802_026.mzML Peak height"
[29] "OH8243_803_030.mzML Peak height" "OH8243_805_057.mzML Peak height"
[31] "LA2213_611_061.mzML Peak height" "OH8243_804_029.mzML Peak height"
[33] "OH8243_806_027.mzML Peak height" "OH8243_809_063.mzML Peak height"
[35] "OH8243_807_053.mzML Peak height" "OH8243_810_049.mzML Peak height"
[37] "OH8243_808_038.mzML Peak height" "OH8243_812_060.mzML Peak height"
[39] "OH8243_811_028.mzML Peak height" "PB_02_006.mzML Peak height"     
[41] "PB_03_007.mzML Peak height"      "PB_01_005.mzML Peak height"     
[43] "QC_02_031.mzML Peak height"      "QC_04_047.mzML Peak height"     
[45] "QC_01_023.mzML Peak height"      "QC_03_039.mzML Peak height"     
[47] "QC_05_054.mzML Peak height"      "QC_06_062.mzML Peak height"     
[49] "...49"                          </code></pre>
</div>
</div>
<p>It looks like we have an extra blank column at the end - if we look at our raw data we can see OH9243_811_028 is the last sample, so I am going to remove the last column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>metabdata <span class="ot">&lt;-</span> metabdata[,<span class="sc">-</span><span class="dv">49</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(metabdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] "row ID"                          "row m/z"                        
 [3] "row retention time"              "HATS_402_041.mzML Peak height"  
 [5] "HATS_403_037.mzML Peak height"   "HATS_404_040.mzML Peak height"  
 [7] "HATS_401_022.mzML Peak height"   "HATS_408_043.mzML Peak height"  
 [9] "HATS_405_025.mzML Peak height"   "HATS_406_055.mzML Peak height"  
[11] "HATS_407_059.mzML Peak height"   "HATS_412_019.mzML Peak height"  
[13] "HATS_409_056.mzML Peak height"   "HATS_410_018.mzML Peak height"  
[15] "HATS_411_044.mzML Peak height"   "LA2213_602_035.mzML Peak height"
[17] "LA2213_603_045.mzML Peak height" "LA2213_601_051.mzML Peak height"
[19] "LA2213_604_016.mzML Peak height" "LA2213_605_017.mzML Peak height"
[21] "LA2213_607_032.mzML Peak height" "LA2213_608_024.mzML Peak height"
[23] "LA2213_606_033.mzML Peak height" "LA2213_609_058.mzML Peak height"
[25] "LA2213_610_050.mzML Peak height" "LA2213_612_046.mzML Peak height"
[27] "OH8243_801_036.mzML Peak height" "OH8243_802_026.mzML Peak height"
[29] "OH8243_803_030.mzML Peak height" "OH8243_805_057.mzML Peak height"
[31] "LA2213_611_061.mzML Peak height" "OH8243_804_029.mzML Peak height"
[33] "OH8243_806_027.mzML Peak height" "OH8243_809_063.mzML Peak height"
[35] "OH8243_807_053.mzML Peak height" "OH8243_810_049.mzML Peak height"
[37] "OH8243_808_038.mzML Peak height" "OH8243_812_060.mzML Peak height"
[39] "OH8243_811_028.mzML Peak height" "PB_02_006.mzML Peak height"     
[41] "PB_03_007.mzML Peak height"      "PB_01_005.mzML Peak height"     
[43] "QC_02_031.mzML Peak height"      "QC_04_047.mzML Peak height"     
[45] "QC_01_023.mzML Peak height"      "QC_03_039.mzML Peak height"     
[47] "QC_05_054.mzML Peak height"      "QC_06_062.mzML Peak height"     </code></pre>
</div>
</div>
</section>
<section id="rt-filter-if-necessary" class="level2">
<h2 class="anchored" data-anchor-id="rt-filter-if-necessary">RT filter if necessary</h2>
<p>You might have deconvoluted more data than you plan to use in your analysis. For example, you may want to exclude the first bit and last bit of your run, since you do not expect to have good reproducibility in those areas.</p>
<p>Here, we are filtering to only include features that elute between 0.5-7.5 min of this 10 min run. Let’s check what we have.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(metabdata<span class="sc">$</span><span class="st">`</span><span class="at">row retention time</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 0.5184004 7.4863230</code></pre>
</div>
</div>
<p>Our data is already filtered for our desired retention time range, so we don’t need to do anything. Below is some code you could use to filter if you needed to.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>metabdata_RTfilt <span class="ot">&lt;-</span> metabdata <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(<span class="st">`</span><span class="at">row retention time</span><span class="st">`</span>, <span class="fl">0.5</span>, <span class="fl">7.5</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># did it work?</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(metabdata_RTfilt<span class="sc">$</span><span class="st">`</span><span class="at">row retention time</span><span class="st">`</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features do we have?</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metabdata_RTfilt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="cleaning-up-data" class="level1">
<h1>Cleaning up data</h1>
<section id="create-mz_rt" class="level2">
<h2 class="anchored" data-anchor-id="create-mz_rt">Create mz_rt</h2>
<p>This creates a unique identifier for each feature using its mass-to-charge ratio (m/z) and retention time (RT).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>MZ_RT <span class="ot">&lt;-</span> metabdata <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mz =</span> <span class="st">`</span><span class="at">row m/z</span><span class="st">`</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">rt =</span> <span class="st">`</span><span class="at">row retention time</span><span class="st">`</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">row_ID =</span> <span class="st">`</span><span class="at">row ID</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(mz_rt, <span class="fu">c</span>(mz, rt), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co"># Combine m/z &amp; rt with _ in between</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row_ID, mz, rt, mz_rt, <span class="fu">everything</span>()) <span class="co"># reorder and move row_ID to front</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># how does our df look?</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>MZ_RT[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 8 × 8
  row_ID    mz    rt mz_rt         HATS_402_041.mzML Pe…¹ HATS_403_037.mzML Pe…²
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                          &lt;dbl&gt;                  &lt;dbl&gt;
1   3106  100. 2.78  100.11203254…                 26623.                 45481.
2    364  101. 0.611 101.07092628…                105494.                104196.
3    453  102. 0.641 102.05495781…                413981.                413246.
4   5568  103. 3.98  103.05420188…                  9505.                 24041.
5   2723  103. 2.54  103.05422465…                196964.                232544.
6   1424  104. 1.07  104.05281547…                 75342.                 72664.
7    397  104. 0.630 104.05926456…                911384.                  3235.
8    426  104. 0.629 104.07084507…               2498815                3274537.
# ℹ abbreviated names: ¹​`HATS_402_041.mzML Peak height`,
#   ²​`HATS_403_037.mzML Peak height`
# ℹ 2 more variables: `HATS_404_040.mzML Peak height` &lt;dbl&gt;,
#   `HATS_401_022.mzML Peak height` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="clean-up-file-names" class="level2">
<h2 class="anchored" data-anchor-id="clean-up-file-names">Clean up file names</h2>
<p>We are using <a href="https://stringr.tidyverse.org/reference/str_remove.html"><code>str_remove()</code></a> to remove some information we do not need in our sample names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove stuff from the end of file names, ".mzML Peak height"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>new_col_names <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(<span class="fu">colnames</span>(MZ_RT), <span class="st">".mzML Peak height"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># did it work?</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>new_col_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] "row_ID"         "mz"             "rt"             "mz_rt"         
 [5] "HATS_402_041"   "HATS_403_037"   "HATS_404_040"   "HATS_401_022"  
 [9] "HATS_408_043"   "HATS_405_025"   "HATS_406_055"   "HATS_407_059"  
[13] "HATS_412_019"   "HATS_409_056"   "HATS_410_018"   "HATS_411_044"  
[17] "LA2213_602_035" "LA2213_603_045" "LA2213_601_051" "LA2213_604_016"
[21] "LA2213_605_017" "LA2213_607_032" "LA2213_608_024" "LA2213_606_033"
[25] "LA2213_609_058" "LA2213_610_050" "LA2213_612_046" "OH8243_801_036"
[29] "OH8243_802_026" "OH8243_803_030" "OH8243_805_057" "LA2213_611_061"
[33] "OH8243_804_029" "OH8243_806_027" "OH8243_809_063" "OH8243_807_053"
[37] "OH8243_810_049" "OH8243_808_038" "OH8243_812_060" "OH8243_811_028"
[41] "PB_02_006"      "PB_03_007"      "PB_01_005"      "QC_02_031"     
[45] "QC_04_047"      "QC_01_023"      "QC_03_039"      "QC_05_054"     
[49] "QC_06_062"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign our new column names to MZ_RT</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MZ_RT) <span class="ot">&lt;-</span> new_col_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What are our sample names?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MZ_RT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] "row_ID"         "mz"             "rt"             "mz_rt"         
 [5] "HATS_402_041"   "HATS_403_037"   "HATS_404_040"   "HATS_401_022"  
 [9] "HATS_408_043"   "HATS_405_025"   "HATS_406_055"   "HATS_407_059"  
[13] "HATS_412_019"   "HATS_409_056"   "HATS_410_018"   "HATS_411_044"  
[17] "LA2213_602_035" "LA2213_603_045" "LA2213_601_051" "LA2213_604_016"
[21] "LA2213_605_017" "LA2213_607_032" "LA2213_608_024" "LA2213_606_033"
[25] "LA2213_609_058" "LA2213_610_050" "LA2213_612_046" "OH8243_801_036"
[29] "OH8243_802_026" "OH8243_803_030" "OH8243_805_057" "LA2213_611_061"
[33] "OH8243_804_029" "OH8243_806_027" "OH8243_809_063" "OH8243_807_053"
[37] "OH8243_810_049" "OH8243_808_038" "OH8243_812_060" "OH8243_811_028"
[41] "PB_02_006"      "PB_03_007"      "PB_01_005"      "QC_02_031"     
[45] "QC_04_047"      "QC_01_023"      "QC_03_039"      "QC_05_054"     
[49] "QC_06_062"     </code></pre>
</div>
</div>
</section>
</section>
<section id="start-filtering" class="level1">
<h1>Start filtering</h1>
<section id="check-for-duplicates" class="level2">
<h2 class="anchored" data-anchor-id="check-for-duplicates">Check for duplicates</h2>
<p>Sometimes you end up with duplicate data after deconvolution with MZmine. Here, we are going to check for complete, perfect duplicates and remove them. The function <code>get_dupes()</code> is from the package <code>janitor</code>.</p>
<p>We don’t want row_ID to be considered here since those are unique per row.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_dupes</span>(MZ_RT <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>row_ID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No variable names specified - using all columns.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: mz, rt, mz_rt, HATS_402_041, HATS_403_037, HATS_404_040, HATS_401_022, HATS_408_043, HATS_405_025, ... and 39 other variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 0 × 49
# ℹ 49 variables: mz &lt;dbl&gt;, rt &lt;dbl&gt;, mz_rt &lt;chr&gt;, HATS_402_041 &lt;dbl&gt;,
#   HATS_403_037 &lt;dbl&gt;, HATS_404_040 &lt;dbl&gt;, HATS_401_022 &lt;dbl&gt;,
#   HATS_408_043 &lt;dbl&gt;, HATS_405_025 &lt;dbl&gt;, HATS_406_055 &lt;dbl&gt;,
#   HATS_407_059 &lt;dbl&gt;, HATS_412_019 &lt;dbl&gt;, HATS_409_056 &lt;dbl&gt;,
#   HATS_410_018 &lt;dbl&gt;, HATS_411_044 &lt;dbl&gt;, LA2213_602_035 &lt;dbl&gt;,
#   LA2213_603_045 &lt;dbl&gt;, LA2213_601_051 &lt;dbl&gt;, LA2213_604_016 &lt;dbl&gt;,
#   LA2213_605_017 &lt;dbl&gt;, LA2213_607_032 &lt;dbl&gt;, LA2213_608_024 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>We have no exact duplicate, this is great! I’m including some code that you can use to remove duplicates if you have them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>MZ_RT <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">%in%</span> <span class="fu">c</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mz_rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>MZ_RT_nodupes <span class="ot">&lt;-</span> MZ_RT <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>row_ID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"insert your duplicated row_IDs here"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This should remove 5 rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(MZ_RT) <span class="sc">-</span> <span class="fu">nrow</span>(MZ_RT_nodupes) <span class="co"># ok good</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cv-function" class="level3">
<h3 class="anchored" data-anchor-id="cv-function">CV function</h3>
<p>Since base R does not have a function to calculate coefficient of variance, let’s write one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">mean</span>(x))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="counting-qcs" class="level2">
<h2 class="anchored" data-anchor-id="counting-qcs">Counting QCs</h2>
<p>Subset QCs and filter features to keep only those that are present in 100% of QCs. You could change this parameter based on your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check dimensions of current df</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MZ_RT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2560   49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>MZ_RT_QCs <span class="ot">&lt;-</span> MZ_RT <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mz_rt, <span class="fu">contains</span>(<span class="st">"QC"</span>)) <span class="sc">%&gt;%</span> <span class="co"># select QCs</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(.)) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="co"># remove rows that have 1 or more NAs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check dimensions of QCs filtered df</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MZ_RT_QCs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2560    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features got removed with this filtering?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(MZ_RT) <span class="sc">-</span> <span class="fu">nrow</span>(MZ_RT_QCs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 0</code></pre>
</div>
</div>
<p>It looks like we didn’t actually remove anything by doing this.</p>
</section>
<section id="filter-on-qc-cv" class="level2">
<h2 class="anchored" data-anchor-id="filter-on-qc-cv">Filter on QC CV</h2>
<p>Here we are removing features that have a CV of more than 30% in the QCs. The rationale is that if a feature cannot be reproducibly measured in samples that are all the same, it should not be included in our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate CV row-wise (1 means row-wise)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>QC_CV <span class="ot">&lt;-</span> <span class="fu">apply</span>(MZ_RT_QCs[, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(MZ_RT_QCs)], <span class="dv">1</span>, cv)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bind the CV vector back to the QC df</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>MZ_RT_QCs_CV <span class="ot">&lt;-</span> <span class="fu">cbind</span>(MZ_RT_QCs, QC_CV)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for keeping features with QC_CV &lt;= 0.30 (or 30%)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>MZ_RT_QCs_CVfilt <span class="ot">&lt;-</span> MZ_RT_QCs_CV <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(QC_CV <span class="sc">&lt;=</span> <span class="fl">0.30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How many features did I remove with this CV filtering?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(MZ_RT_QCs) <span class="sc">-</span> <span class="fu">nrow</span>(MZ_RT_QCs_CVfilt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 46</code></pre>
</div>
</div>
</section>
<section id="merge-back-the-rest-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="merge-back-the-rest-of-the-data">Merge back the rest of the data</h2>
<p>MZ_RT_QCs_CVfilt only contains the QCs, We want to keep only the rows that are present in this df, and then merge back all of the other samples present in MZ_RT. We will do this by creating a vector that has the mz_rt features we want to keep, and then using <code>filter()</code> and <code>%in%</code> to keep only features that are a part of this list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MZ_RT_QCs_CVfilt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2514    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MZ_RT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2560   49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a character vector of the mz_rt features we want to keep</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e., the ones that passed our previous filtering steps</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>features_to_keep <span class="ot">&lt;-</span> <span class="fu">as.character</span>(MZ_RT_QCs_CVfilt<span class="sc">$</span>mz_rt)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt <span class="ot">&lt;-</span> MZ_RT <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">%in%</span> features_to_keep)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MZ_RT_filt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2514   49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_dupes</span>(MZ_RT_filt <span class="sc">%&gt;%</span> <span class="fu">select</span>(mz_rt)) <span class="co"># good no dupes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No variable names specified - using all columns.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: mz_rt</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 0 × 2
# ℹ 2 variables: mz_rt &lt;chr&gt;, dupe_count &lt;int&gt;</code></pre>
</div>
</div>
<p>You should have the same number of features in MZ_RT_QCs_CVfilt as you do in your new filtered df MZ_RT_filt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(MZ_RT_QCs_CVfilt<span class="sc">$</span>mz_rt, MZ_RT_filt<span class="sc">$</span>mz_rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="process-blanks" class="level2">
<h2 class="anchored" data-anchor-id="process-blanks">Process blanks</h2>
<p>We want to remove features that are present in our process blanks as they are not coming from compounds present in our samples. In this dataset, there are three process blanks (a sample that includes all the extraction materials, minus the sample, here the tomato was replaced by mass with water) has “PB” in the sample name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grab the name of the column/sample that is the process blank</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_subset</span>(<span class="fu">colnames</span>(MZ_RT_filt), <span class="st">"PB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] "PB_02_006" "PB_03_007" "PB_01_005"</code></pre>
</div>
</div>
<p>Calculate the average value across the QCs, then remove features that are not at least 10x higher in the QCs than in the process blank. To do this we will use <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/apply"><code>apply()</code></a>.</p>
<p><code>apply(X, MARGIN, FUN,...)</code> where X is your df, MARGIN is 1 for row-wise, and 2 for col-wise, and FUN is your function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull avg peak height across QCs</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>avg_height_QC <span class="ot">&lt;-</span> <span class="fu">apply</span>(MZ_RT_QCs_CVfilt[, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(MZ_RT_QCs_CVfilt)], <span class="dv">1</span>, mean)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bind back to rest of data</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt_QC_avg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(MZ_RT_filt, avg_height_QC)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check dimensions</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MZ_RT_filt_QC_avg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2514   50</code></pre>
</div>
</div>
<p>Pull the name of your process blank, and make a new column that indicates how many fold higher your peak height is in your average QC vs your process blank.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull name of process blank so we can remember them</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_subset</span>(<span class="fu">colnames</span>(MZ_RT_filt), <span class="st">"PB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] "PB_02_006" "PB_03_007" "PB_01_005"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a new column that has a value of how many fold higher peak height is</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in QCs as compared to PB</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># here there is only  one PB, but would be better to have &gt; 1 but this is ok</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># then you can avg your PBs together and do the same thing</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt_PB <span class="ot">&lt;-</span> MZ_RT_filt_QC_avg <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_height_PB =</span> ((PB_02_006 <span class="sc">+</span> PB_01_005 <span class="sc">+</span> PB_03_007)<span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fold_higher_in_QC =</span> avg_height_QC<span class="sc">/</span>avg_height_PB) <span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row_ID, mz_rt, mz, rt, avg_height_QC, avg_height_PB, fold_higher_in_QC)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MZ_RT_filt_PB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>  row_ID                      mz_rt       mz        rt avg_height_QC
1   3106 100.112032546963_2.7774892 100.1120 2.7774892      40408.18
2    364 101.070926284391_0.6108881 101.0709 0.6108881      78630.77
3    453  102.054957817964_0.641104 102.0550 0.6411040     420303.10
4   5568 103.054201883867_3.9781477 103.0542 3.9781477      15405.02
5   2723 103.054224658561_2.5438855 103.0542 2.5438855     215913.13
6   1424  104.052815474906_1.065307 104.0528 1.0653070     119092.77
  avg_height_PB fold_higher_in_QC
1     1479.6998         27.308366
2      719.0611        109.351996
3     3059.5315        137.374986
4     1894.2296          8.132607
5     1617.7699        133.463439
6        0.0000               Inf</code></pre>
</div>
</div>
<p>We want to keep features that are at least 10x higher in QCs than process blanks, and we also want to keep Infs, because an Inf indicates that a feature absent in the process blanks (i.e., you get an Inf because you’re trying to divide by zero).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keep features that are present at least 10x higher in QCs vs PB</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or, keep NAs because those are absent in blank</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>PB_features_to_keep <span class="ot">&lt;-</span> MZ_RT_filt_PB <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fold_higher_in_QC <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">|</span> <span class="fu">is.infinite</span>(fold_higher_in_QC)) </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(PB_features_to_keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2409    7</code></pre>
</div>
</div>
<p>How many features did we remove?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(MZ_RT_filt_QC_avg) <span class="sc">-</span> <span class="fu">nrow</span>(PB_features_to_keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 105</code></pre>
</div>
</div>
<p>Removed some garbage!</p>
<p>Bind back metdata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt_PBremoved <span class="ot">&lt;-</span> MZ_RT_filt_QC_avg <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">%in%</span> PB_features_to_keep<span class="sc">$</span>mz_rt)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(MZ_RT_filt_PBremoved)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2409</code></pre>
</div>
</div>
<p>Do we have any duplicate features?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_dupes</span>(MZ_RT_filt_PBremoved, mz_rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: mz_rt</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] mz_rt          dupe_count     row_ID         mz             rt            
 [6] HATS_402_041   HATS_403_037   HATS_404_040   HATS_401_022   HATS_408_043  
[11] HATS_405_025   HATS_406_055   HATS_407_059   HATS_412_019   HATS_409_056  
[16] HATS_410_018   HATS_411_044   LA2213_602_035 LA2213_603_045 LA2213_601_051
[21] LA2213_604_016 LA2213_605_017 LA2213_607_032 LA2213_608_024 LA2213_606_033
[26] LA2213_609_058 LA2213_610_050 LA2213_612_046 OH8243_801_036 OH8243_802_026
[31] OH8243_803_030 OH8243_805_057 LA2213_611_061 OH8243_804_029 OH8243_806_027
[36] OH8243_809_063 OH8243_807_053 OH8243_810_049 OH8243_808_038 OH8243_812_060
[41] OH8243_811_028 PB_02_006      PB_03_007      PB_01_005      QC_02_031     
[46] QC_04_047      QC_01_023      QC_03_039      QC_05_054      QC_06_062     
[51] avg_height_QC 
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<p>Good, we shouldn’t because we handled this already.</p>
<p>Remove samples that we don’t need anymore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MZ_RT_filt_PBremoved)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] "row_ID"         "mz"             "rt"             "mz_rt"         
 [5] "HATS_402_041"   "HATS_403_037"   "HATS_404_040"   "HATS_401_022"  
 [9] "HATS_408_043"   "HATS_405_025"   "HATS_406_055"   "HATS_407_059"  
[13] "HATS_412_019"   "HATS_409_056"   "HATS_410_018"   "HATS_411_044"  
[17] "LA2213_602_035" "LA2213_603_045" "LA2213_601_051" "LA2213_604_016"
[21] "LA2213_605_017" "LA2213_607_032" "LA2213_608_024" "LA2213_606_033"
[25] "LA2213_609_058" "LA2213_610_050" "LA2213_612_046" "OH8243_801_036"
[29] "OH8243_802_026" "OH8243_803_030" "OH8243_805_057" "LA2213_611_061"
[33] "OH8243_804_029" "OH8243_806_027" "OH8243_809_063" "OH8243_807_053"
[37] "OH8243_810_049" "OH8243_808_038" "OH8243_812_060" "OH8243_811_028"
[41] "PB_02_006"      "PB_03_007"      "PB_01_005"      "QC_02_031"     
[45] "QC_04_047"      "QC_01_023"      "QC_03_039"      "QC_05_054"     
[49] "QC_06_062"      "avg_height_QC" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt_PBremoved <span class="ot">&lt;-</span> MZ_RT_filt_PBremoved <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>PB_02_006, <span class="sc">-</span>PB_01_005, <span class="sc">-</span>PB_03_007, <span class="sc">-</span>avg_height_QC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-your-file" class="level2">
<h2 class="anchored" data-anchor-id="save-your-file">Save your file</h2>
<p>Now you have a list of features present in your samples after filtering for CV in QCs, and removing all the extraneous columns we added to help us do this, along with removing any process blanks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(MZ_RT_filt_PBremoved,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data/post_filtering_6892.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="start-analysis" class="level1">
<h1>Start analysis</h1>
<p>Take a quick look at our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at first 5 rows, first 5 columns </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt_PBremoved[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>  row_ID       mz        rt                      mz_rt HATS_402_041
1   3106 100.1120 2.7774892 100.112032546963_2.7774892     26623.42
2    364 101.0709 0.6108881 101.070926284391_0.6108881    105494.08
3    453 102.0550 0.6411040  102.054957817964_0.641104    413980.78
4   2723 103.0542 2.5438855 103.054224658561_2.5438855    196963.94
5   1424 104.0528 1.0653070  104.052815474906_1.065307     75342.02
  HATS_403_037 HATS_404_040 HATS_401_022 HATS_408_043 HATS_405_025
1     45481.48     43957.91     47214.43     46941.94     32218.73
2    104196.20    104899.95     90222.12    115545.70     93989.97
3    413245.72    410670.90    422117.53    379500.50    449261.47
4    232544.06    233201.03    201711.90    317119.03    196461.58
5     72663.66     98486.46     78438.71    128792.77     69918.09</code></pre>
</div>
</div>
<p>What are our column names?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MZ_RT_filt_PBremoved)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] "row_ID"         "mz"             "rt"             "mz_rt"         
 [5] "HATS_402_041"   "HATS_403_037"   "HATS_404_040"   "HATS_401_022"  
 [9] "HATS_408_043"   "HATS_405_025"   "HATS_406_055"   "HATS_407_059"  
[13] "HATS_412_019"   "HATS_409_056"   "HATS_410_018"   "HATS_411_044"  
[17] "LA2213_602_035" "LA2213_603_045" "LA2213_601_051" "LA2213_604_016"
[21] "LA2213_605_017" "LA2213_607_032" "LA2213_608_024" "LA2213_606_033"
[25] "LA2213_609_058" "LA2213_610_050" "LA2213_612_046" "OH8243_801_036"
[29] "OH8243_802_026" "OH8243_803_030" "OH8243_805_057" "LA2213_611_061"
[33] "OH8243_804_029" "OH8243_806_027" "OH8243_809_063" "OH8243_807_053"
[37] "OH8243_810_049" "OH8243_808_038" "OH8243_812_060" "OH8243_811_028"
[41] "QC_02_031"      "QC_04_047"      "QC_01_023"      "QC_03_039"     
[45] "QC_05_054"      "QC_06_062"     </code></pre>
</div>
</div>
<p>In our dataset, missing data is coded as zero, so let’s change this so they’re coded as NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>MZ_RT_filt_PBremoved[MZ_RT_filt_PBremoved <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="wrangle-sample-names" class="level2">
<h2 class="anchored" data-anchor-id="wrangle-sample-names">Wrangle sample names</h2>
<p>Here, the samples are in columns and the features are in rows. Samples are coded so that the first number is the treatment code, and the last code is the run order. We don’t need pos. We are going to transpose the data so that samples are in rows and features are in tables, and we will also import the metadata about the samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>metab_t <span class="ot">&lt;-</span> MZ_RT_filt_PBremoved <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>row_ID, <span class="sc">-</span>mz, <span class="sc">-</span>rt) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"mz_rt"</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make the first row the column names</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(metab_t) <span class="ot">&lt;-</span> metab_t[<span class="dv">1</span>,]</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># then remove the first row and rename the column that should be called sample_name</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>metab_t <span class="ot">&lt;-</span> metab_t[<span class="sc">-</span><span class="dv">1</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sample_name =</span> mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>((<span class="fu">across</span>(<span class="at">.cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(.), <span class="at">.fns =</span> as.numeric)))</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>metab_t[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>    sample_name 100.112032546963_2.7774892 101.070926284391_0.6108881
2  HATS_402_041                   26623.42                  105494.08
3  HATS_403_037                   45481.48                  104196.20
4  HATS_404_040                   43957.91                  104899.95
5  HATS_401_022                   47214.43                   90222.12
6  HATS_408_043                   46941.94                  115545.70
7  HATS_405_025                   32218.73                   93989.97
8  HATS_406_055                   31183.91                   95570.40
9  HATS_407_059                   35303.91                  115281.73
10 HATS_412_019                   45864.24                  101472.12
11 HATS_409_056                   23643.99                   97027.94
   102.054957817964_0.641104 103.054224658561_2.5438855
2                   413980.8                   196963.9
3                   413245.7                   232544.1
4                   410670.9                   233201.0
5                   422117.5                   201711.9
6                   379500.5                   317119.0
7                   449261.5                   196461.6
8                   433928.6                   172716.3
9                   332571.8                   233300.6
10                  392594.0                   236538.0
11                  390017.1                   159840.7
   104.052815474906_1.065307 104.059264569687_0.6302757
2                   75342.02                 911384.440
3                   72663.66                   3234.576
4                   98486.46                   4026.670
5                   78438.71                   3363.092
6                  128792.77                   3529.039
7                   69918.09                1575439.000
8                   64246.62                   2767.284
9                   88647.18                   2967.580
10                  78838.38                   3400.089
11                  71890.95                   3651.530
   104.070845078818_0.6292385 104.107425371357_0.5997596
2                     2498815                    4192158
3                     3274537                    4506788
4                     3265155                    4466335
5                     3602852                    4506087
6                     4000426                    4407152
7                     2522760                    4389543
8                     2374514                    4441916
9                     3509658                    4643859
10                    3862798                    4476118
11                    3250134                    4585277
   104.124821538078_0.6135892
2                    158717.3
3                    246090.9
4                    240655.1
5                    246382.4
6                    264137.5
7                    146173.3
8                    223540.2
9                    258637.6
10                   247997.0
11                   246773.9</code></pre>
</div>
</div>
<p>Add in the metadata and make a new column that will indicate whether a sample is a “sample” or a “QC”. Extract the metadata out of the column names. The metadata we have for the samples we are no longer using (process blanks etc) are removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>metab_plus <span class="ot">&lt;-</span> metab_t <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_or_qc =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(sample_name, <span class="st">"QC"</span>), </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">true =</span> <span class="st">"QC"</span>, <span class="at">false =</span> <span class="st">"Sample"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> sample_name, <span class="at">delim =</span> <span class="st">"_"</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"tomato"</span>, <span class="st">"rep_or_plot"</span>, <span class="st">"run_order"</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, sample_or_qc, tomato, rep_or_plot, run_order, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_or_qc =</span> <span class="fu">as.factor</span>(sample_or_qc),</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">tomato =</span> <span class="fu">as.factor</span>(tomato),</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">run_order =</span> <span class="fu">as.numeric</span>(run_order))</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># how does it look</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>metab_plus[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 5 × 8
  sample_name  sample_or_qc tomato rep_or_plot run_order 100.112032546963_2.77…¹
  &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt;                   &lt;dbl&gt;
1 HATS_402_041 Sample       HATS   402                41                  26623.
2 HATS_403_037 Sample       HATS   403                37                  45481.
3 HATS_404_040 Sample       HATS   404                40                  43958.
4 HATS_401_022 Sample       HATS   401                22                  47214.
5 HATS_408_043 Sample       HATS   408                43                  46942.
# ℹ abbreviated name: ¹​`100.112032546963_2.7774892`
# ℹ 2 more variables: `101.070926284391_0.6108881` &lt;dbl&gt;,
#   `102.054957817964_0.641104` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Go from wide to long data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>metab_plus_long <span class="ot">&lt;-</span> metab_plus <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(sample_name, sample_or_qc, tomato, rep_or_plot, run_order,),  <span class="co"># remove metadata</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"mz_rt"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(metab_plus_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Rows: 101,178
Columns: 7
$ sample_name  &lt;chr&gt; "HATS_402_041", "HATS_402_041", "HATS_402_041", "HATS_402…
$ sample_or_qc &lt;fct&gt; Sample, Sample, Sample, Sample, Sample, Sample, Sample, S…
$ tomato       &lt;fct&gt; HATS, HATS, HATS, HATS, HATS, HATS, HATS, HATS, HATS, HAT…
$ rep_or_plot  &lt;chr&gt; "402", "402", "402", "402", "402", "402", "402", "402", "…
$ run_order    &lt;dbl&gt; 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 4…
$ mz_rt        &lt;chr&gt; "100.112032546963_2.7774892", "101.070926284391_0.6108881…
$ rel_abund    &lt;dbl&gt; 26623.416, 105494.080, 413980.780, 196963.940, 75342.016,…</code></pre>
</div>
</div>
<p>Also add separate columns for mz and rt, and making both numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>metab_plus_long <span class="ot">&lt;-</span> metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> mz_rt,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"mz"</span>, <span class="st">"rt"</span>),</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"mz"</span>, <span class="st">"rt"</span>), <span class="at">.fns =</span> as.numeric)) <span class="co"># convert mz and rt to numeric</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"># how did that go?</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(metab_plus_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 6 × 9
  sample_name  sample_or_qc tomato rep_or_plot run_order    mz    rt mz_rt      
  &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
1 HATS_402_041 Sample       HATS   402                41  100. 2.78  100.112032…
2 HATS_402_041 Sample       HATS   402                41  101. 0.611 101.070926…
3 HATS_402_041 Sample       HATS   402                41  102. 0.641 102.054957…
4 HATS_402_041 Sample       HATS   402                41  103. 2.54  103.054224…
5 HATS_402_041 Sample       HATS   402                41  104. 1.07  104.052815…
6 HATS_402_041 Sample       HATS   402                41  104. 0.630 104.059264…
# ℹ 1 more variable: rel_abund &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="data-summaries" class="level2">
<h2 class="anchored" data-anchor-id="data-summaries">Data summaries</h2>
<p>What mass range do I have?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(metab_plus_long<span class="sc">$</span>mz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1]  100.112 1589.722</code></pre>
</div>
</div>
<p>What retention time range do I have?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(metab_plus_long<span class="sc">$</span>rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 0.5184004 7.4507394</code></pre>
</div>
</div>
<p>How many samples are in each of my meta-data groups?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make wide data to make some calculations easier</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>metab_wide_meta <span class="ot">&lt;-</span> metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>mz, <span class="sc">-</span>rt) <span class="sc">%&gt;%</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> mz_rt,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> rel_abund)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># by sample vs QC</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>metab_wide_meta <span class="sc">%&gt;%</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sample_or_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 2 × 2
  sample_or_qc     n
  &lt;fct&gt;        &lt;int&gt;
1 QC               6
2 Sample          36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by tomato</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>metab_wide_meta <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 4 × 2
  tomato     n
  &lt;fct&gt;  &lt;int&gt;
1 HATS      12
2 LA2213    12
3 OH8243    12
4 QC         6</code></pre>
</div>
</div>
<p>What does my data coverage across mz and rt look like?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span> <span class="co"># so we only have one point per feature</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rt, <span class="at">y =</span> mz)) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Retention time (min)"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mass to charge ratio (m/z)"</span>,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"m/z by retention time plot (all features)"</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"C18 reversed phase, positive ionization mode"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>All of this overlap makes me think we have replication of features.</p>
<p>Distribution of masses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mz)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"m/z"</span>,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of features"</span>,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of features by mass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Distribution of retention times</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rt)) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Retention time"</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of features"</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of features by retention time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
</section>
<section id="missing-data" class="level2">
<h2 class="anchored" data-anchor-id="missing-data">Missing data</h2>
<section id="surveying-missingness" class="level3">
<h3 class="anchored" data-anchor-id="surveying-missingness">Surveying missingness</h3>
<p>How many missing values are there for each feature? In this dataset, missing values are coded as zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all data including QCs</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># how many missing values are there for each feature (row)</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>na_by_feature <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(MZ_RT_filt_PBremoved)) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">missing_values =</span> <span class="dv">1</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>na_by_feature <span class="sc">%&gt;%</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> missing_values)) <span class="sc">+</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>) <span class="sc">+</span> <span class="co"># since 40 samples</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of missing values for each feature"</span>,</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of missing values"</span>,</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"How many features have that </span><span class="sc">\n</span><span class="st">many missing values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>How many features have no missing values?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>na_by_feature <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(missing_values <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>  missing_values == 0    n
1               FALSE  628
2                TRUE 1781</code></pre>
</div>
</div>
<p>How many missing values are there for each sample?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all data including QCs</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># how many missing values are there for each feature (row)</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>na_by_sample <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(MZ_RT_filt_PBremoved)) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">missing_values =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"feature"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>feature <span class="sc">==</span> <span class="st">"mz_rt"</span>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>na_by_sample <span class="sc">%&gt;%</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> missing_values)) <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="co"># </span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of missing values for each sample"</span>,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of missing values"</span>,</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"How many samples have that </span><span class="sc">\n</span><span class="st">many missing values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Which features have a lot of missing values?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>contains_NAs_feature <span class="ot">&lt;-</span> metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">is.na</span>(rel_abund)) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">is.na(rel_abund)</span><span class="st">`</span> <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(contains_NAs_feature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 6 × 3
# Groups:   mz_rt [6]
  mz_rt                      `is.na(rel_abund)`     n
  &lt;chr&gt;                      &lt;lgl&gt;              &lt;int&gt;
1 743.251838840705_6.577289  TRUE                  28
2 628.382914819219_4.8645153 TRUE                  27
3 465.285351543191_4.7723923 TRUE                  26
4 399.246808492192_4.5366135 TRUE                  25
5 421.259892834676_4.621516  TRUE                  25
6 472.341839506857_6.440611  TRUE                  25</code></pre>
</div>
</div>
<p>Which samples have a lot of missing values?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>contains_NAs_sample <span class="ot">&lt;-</span> metab_plus_long <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_name) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">is.na</span>(rel_abund)) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">is.na(rel_abund)</span><span class="st">`</span> <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(contains_NAs_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 6 × 3
# Groups:   sample_name [6]
  sample_name    `is.na(rel_abund)`     n
  &lt;chr&gt;          &lt;lgl&gt;              &lt;int&gt;
1 OH8243_805_057 TRUE                 305
2 OH8243_806_027 TRUE                 300
3 OH8243_801_036 TRUE                 238
4 OH8243_810_049 TRUE                 222
5 OH8243_811_028 TRUE                 221
6 OH8243_808_038 TRUE                 214</code></pre>
</div>
</div>
<p>Are there any missing values in the QCs? (There shouldn’t be.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>metab_QC <span class="ot">&lt;-</span> MZ_RT_filt_PBremoved <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"QC"</span>))</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>na_by_sample <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(metab_QC)) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">missing_values =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"feature"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>feature <span class="sc">==</span> <span class="st">"mz_rt"</span>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(na_by_sample<span class="sc">$</span>missing_values) <span class="co"># nope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="imputing-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="imputing-missing-values">Imputing missing values</h3>
<p>This is an optional step but some downstream analyses don’t handle missingness well. Here we are imputing missing data with half the lowest value observed for that feature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grab only the feature data and leave metadata</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>metab_wide_meta_imputed <span class="ot">&lt;-</span> metab_wide_meta <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="co"># the metadata columns</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>metab_wide_meta_imputed[] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(metab_wide_meta_imputed,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">2</span>, x))</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co"># bind back the metadata</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>metab_wide_meta_imputed <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(metab_wide_meta[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], metab_wide_meta_imputed)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co"># try working from original MZ_RT_filt_PBremoved input file for notame later</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>metab_imputed <span class="ot">&lt;-</span> MZ_RT_filt_PBremoved <span class="sc">%&gt;%</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>row_ID, <span class="sc">-</span>mz_rt, <span class="sc">-</span>mz, <span class="sc">-</span>rt)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>metab_imputed[] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(metab_imputed,</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>                          <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">2</span>, x))</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="co"># bind back metadata</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>metab_imputed <span class="ot">&lt;-</span> <span class="fu">bind_cols</span> (MZ_RT_filt_PBremoved<span class="sc">$</span>mz_rt, metab_imputed) <span class="sc">%&gt;%</span> <span class="co"># just add back mz_rt</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mz_rt =</span> <span class="dv">1</span>) <span class="co"># rename first column back to mz_rt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
</div>
<p>Did imputing work?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count missing values</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>metab_wide_meta_imputed <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span> <span class="co"># where the metadata is</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 0</code></pre>
</div>
</div>
<p>Create long imputed dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>metab_long_meta_imputed <span class="ot">&lt;-</span> metab_wide_meta_imputed <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(.),</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"mz_rt"</span>,</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(metab_long_meta_imputed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 6 × 7
  sample_name  sample_or_qc tomato rep_or_plot run_order mz_rt         rel_abund
  &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;
1 HATS_402_041 Sample       HATS   402                41 100.11203254…    26623.
2 HATS_402_041 Sample       HATS   402                41 101.07092628…   105494.
3 HATS_402_041 Sample       HATS   402                41 102.05495781…   413981.
4 HATS_402_041 Sample       HATS   402                41 103.05422465…   196964.
5 HATS_402_041 Sample       HATS   402                41 104.05281547…    75342.
6 HATS_402_041 Sample       HATS   402                41 104.05926456…   911384.</code></pre>
</div>
</div>
<p>Let’s also make separate mz and rt columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>metab_long_meta_imputed <span class="ot">&lt;-</span> metab_long_meta_imputed <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> mz_rt,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"mz"</span>, <span class="st">"rt"</span>),</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>metab_long_meta_imputed<span class="sc">$</span>mz <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(metab_long_meta_imputed<span class="sc">$</span>mz)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>metab_long_meta_imputed<span class="sc">$</span>rt <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(metab_long_meta_imputed<span class="sc">$</span>rt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="feature-clustering-with-notame" class="level2">
<h2 class="anchored" data-anchor-id="feature-clustering-with-notame">Feature clustering with <code>notame</code></h2>
<p>We want to cluster features that likely come from the same metabolite together, and we can do this using the package <code>notame</code>. You can learn more <a href="http://127.0.0.1:24885/library/notame/doc/feature_clustering.html">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">browseVignettes</span>(<span class="st">"notame"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s make a m/z by retention time plot again before we start.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(before_notame <span class="ot">&lt;-</span> metab_long_meta_imputed <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span> <span class="co"># so we only have one point per feature</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rt, <span class="at">y =</span> mz)) <span class="sc">+</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Retention time (min)"</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mass to charge ratio (m/z)"</span>,</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"m/z by retention time plot before notame"</span>,</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"C18 reverse phase, positive ionization mode"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<section id="wrangling-data" class="level3">
<h3 class="anchored" data-anchor-id="wrangling-data">Wrangling data</h3>
<p>Transpose the wide data for notame and wrangle to the right format. Below is info from the documentation:</p>
<ul>
<li>Data should be a data frame containing the abundances of features in each sample, one row per sample, each feature in a separate column</li>
<li>Features should be a data frame containing information about the features, namely feature name (should be the same as the column name in data), mass and retention time</li>
</ul>
<p>Going back to the original imported data and imputing from there seems kind of silly, but I had a lot of problems structuring this data to get find_connections() to run and not throw any errors because of names that weren’t the same between the features and the data inputs.</p>
<p>It is important that for the Data, your first sample is in row 2. The code below will get you there. If you’re wondering why the code is written this way instead of just using metab_wide_meta_imputed, this is why.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # create a data frame which is just the original metab data</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># transposed so samples are rows and features are columns</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>data_notame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(metab_imputed <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">t</span>())</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>data_notame <span class="ot">&lt;-</span> data_notame <span class="sc">%&gt;%</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> <span class="co"># change samples from rownames to its own column</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_to_names</span>(<span class="at">row_number =</span> <span class="dv">1</span>) <span class="co"># change the feature IDs (mz_rt) from first row obs into column names</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="co"># change to results to numeric</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="co"># it is important that the first row of data has the row number 2</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="co"># i don't know why this is but save yourself all the time maria/jess spent figuring out</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="co"># why this wasn't working</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>data_notame <span class="ot">&lt;-</span> data_notame <span class="sc">%&gt;%</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>mz_rt, as.numeric))</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(data_notame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 42 × 2,410
   mz_rt    100.112032546963_2.7…¹ 101.070926284391_0.6…² 102.054957817964_0.6…³
   &lt;chr&gt;                     &lt;dbl&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;
 1 HATS_40…                 26623.                105494.                413981.
 2 HATS_40…                 45481.                104196.                413246.
 3 HATS_40…                 43958.                104900.                410671.
 4 HATS_40…                 47214.                 90222.                422118.
 5 HATS_40…                 46942.                115546.                379500.
 6 HATS_40…                 32219.                 93990.                449261.
 7 HATS_40…                 31184.                 95570.                433929.
 8 HATS_40…                 35304.                115282.                332572.
 9 HATS_41…                 45864.                101472.                392594 
10 HATS_40…                 23644.                 97028.                390017.
# ℹ 32 more rows
# ℹ abbreviated names: ¹​`100.112032546963_2.7774892`,
#   ²​`101.070926284391_0.6108881`, ³​`102.054957817964_0.641104`
# ℹ 2,406 more variables: `103.054224658561_2.5438855` &lt;dbl&gt;,
#   `104.052815474906_1.065307` &lt;dbl&gt;, `104.059264569687_0.6302757` &lt;dbl&gt;,
#   `104.070845078818_0.6292385` &lt;dbl&gt;, `104.107425371357_0.5997596` &lt;dbl&gt;,
#   `104.124821538078_0.6135892` &lt;dbl&gt;, `104.130633537458_0.60107374` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Create df with features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> metab_long_meta_imputed <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mz_rt, mz, rt) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(mz, rt), as.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Rows: 2,409
Columns: 3
$ mz_rt &lt;chr&gt; "100.112032546963_2.7774892", "101.070926284391_0.6108881", "102…
$ mz    &lt;dbl&gt; 100.1120, 101.0709, 102.0550, 103.0542, 104.0528, 104.0593, 104.…
$ rt    &lt;dbl&gt; 2.7774892, 0.6108881, 0.6411040, 2.5438855, 1.0653070, 0.6302757…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] "data.frame"</code></pre>
</div>
</div>
</section>
<section id="find-connections" class="level3">
<h3 class="anchored" data-anchor-id="find-connections">Find connections</h3>
<p>Set <code>cache = TRUE</code> for this chunk since its a bit slow especially if you have a lot of features. Here, this step took 25 min for almost 7K features or 5 min for just over 2K features.</p>
<div class="cell" data-hash="05_R_cache/html/unnamed-chunk-57_bb4073a3649c190896f09408f415d3d0">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>connection <span class="ot">&lt;-</span> <span class="fu">find_connections</span>(<span class="at">data =</span> data_notame,</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">features =</span> features,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">corr_thresh =</span> <span class="fl">0.9</span>,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rt_window =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">60</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">name_col =</span> <span class="st">"mz_rt"</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">mz_col =</span> <span class="st">"mz"</span>,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rt_col =</span> <span class="st">"rt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 100
[1] 200
[1] 300
[1] 400
[1] 500
[1] 600
[1] 700
[1] 800
[1] 900
[1] 1000
[1] 1100
[1] 1200
[1] 1300
[1] 1400
[1] 1500
[1] 1600
[1] 1700
[1] 1800
[1] 1900
[1] 2000
[1] 2100
[1] 2200
[1] 2300
[1] 2400</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(connection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>                           x                           y       cor     rt_diff
1 100.112032546963_2.7774892  146.117590231148_2.7758389 0.9828013 -0.00165030
2 101.070926284391_0.6108881  147.077120604255_0.6086585 0.9835768 -0.00222960
3 101.070926284391_0.6108881   147.22323215244_0.6100122 0.9045387 -0.00087590
4 101.070926284391_0.6108881  147.250378998592_0.6080253 0.9604805 -0.00286280
5  102.054957817964_0.641104 148.061209408145_0.63665396 0.9906094 -0.00445004
6  102.054957817964_0.641104 149.063907598478_0.63694835 0.9823400 -0.00415565
   mz_diff
1 46.00556
2 46.00619
3 46.15231
4 46.17945
5 46.00625
6 47.00895</code></pre>
</div>
</div>
</section>
<section id="clustering" class="level3">
<h3 class="anchored" data-anchor-id="clustering">Clustering</h3>
<p>Now that we have found all of the features that are connected based on the parameterers we have set, we now need to find clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">find_clusters</span>(<span class="at">connections =</span> connection, </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">d_thresh =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>285 components found</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Component 100 / 285 
Component 200 / 285 
147 components found

Component 100 / 147 
35 components found

7 components found

7 components found

8 components found

7 components found</code></pre>
</div>
</div>
<p>Assign a cluster ID to each feature to keep, and the feature that is picked is the one with the highest median peak intensity across the samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign a cluster ID to all features</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># clusters are named after feature with highest median peak height</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>features_clustered <span class="ot">&lt;-</span> <span class="fu">assign_cluster_id</span>(data_notame, </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>                                        clusters, </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>                                        features, </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">name_col =</span> <span class="st">"mz_rt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Export out a list of your clusters this way you can use this later during metabolite ID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export clustered feature list this way you have it</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(features_clustered,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"data/features_notame-clusters.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pull data out from the clusters and see how many features we removed/have now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lets see how many features are removed when we only keep one feature per cluster</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>pulled <span class="ot">&lt;-</span> <span class="fu">pull_clusters</span>(data_notame, features_clustered, <span class="at">name_col =</span> <span class="st">"mz_rt"</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> pulled<span class="sc">$</span>cdata</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>cluster_features <span class="ot">&lt;-</span> pulled<span class="sc">$</span>cfeatures</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features did we originally have after filtering?</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(metab_imputed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 2409</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features got removed during clustering?</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(metab_imputed) <span class="sc">-</span> <span class="fu">nrow</span>(cluster_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 1131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what percentage of the original features were removed?</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>((<span class="fu">nrow</span>(metab_imputed) <span class="sc">-</span> <span class="fu">nrow</span>(cluster_features))<span class="sc">/</span><span class="fu">nrow</span>(metab_imputed)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 46.94894</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features do we have now?</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(cluster_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 1278</code></pre>
</div>
</div>
<p>Reduce our dataset to include only our new clusters. <code>cluster_data</code> contains only the retained clusters, while <code>cluster_features</code> tells you also which features are a part of each cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combined metadata_plus with cluster_features</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> cluster_data <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sample_name =</span> mz_rt) <span class="co"># since this column is actually sample name</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make a wide df</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_wide <span class="ot">&lt;-</span> <span class="fu">left_join</span>(metab_wide_meta_imputed[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], cluster_data,</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">by =</span> <span class="st">"sample_name"</span>) </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metab_imputed_clustered_wide) <span class="co"># we have 2474 features since 4 metadata columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1]   42 1283</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a long/tidy df</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long <span class="ot">&lt;-</span> metab_imputed_clustered_wide <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(.),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"mz_rt"</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> mz_rt, <span class="co"># make separate columns for mz and rt too</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>,</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"mz"</span>, <span class="st">"rt"</span>),</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"mz"</span>, <span class="st">"rt"</span>), <span class="at">.fns =</span> as.numeric)) <span class="co"># make mz and rt numeric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at a m/z by retention time plot again after clustering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>(after_notame <span class="ot">&lt;-</span> metab_imputed_clustered_long <span class="sc">%&gt;%</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span> <span class="co"># so we only have one point per feature</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rt, <span class="at">y =</span> mz)) <span class="sc">+</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Retention time (min)"</span>,</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mass to charge ratio (m/z)"</span>,</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"m/z by retention time plot after notame"</span>,</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"C18 reverse phase, positive ionization mode"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>before_notame <span class="sc">/</span> after_notame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
</section>
</section>
<section id="assessing-data-quality" class="level2">
<h2 class="anchored" data-anchor-id="assessing-data-quality">Assessing data quality</h2>
<p>Let’s make sure that our data is of good quality.</p>
<section id="untransformed-data" class="level3">
<h3 class="anchored" data-anchor-id="untransformed-data">Untransformed data</h3>
<p>First we are going to convert the type of some of the columns to match what we want (e.g., run order converted to numeric, species to factor)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(metab_imputed_clustered_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 53,676 × 9
   sample_name  sample_or_qc tomato rep_or_plot run_order    mz    rt mz_rt     
   &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
 1 HATS_402_041 Sample       HATS   402                41  104. 0.630 104.05926…
 2 HATS_402_041 Sample       HATS   402                41  104. 0.629 104.07084…
 3 HATS_402_041 Sample       HATS   402                41  104. 0.600 104.10742…
 4 HATS_402_041 Sample       HATS   402                41  104. 0.614 104.12482…
 5 HATS_402_041 Sample       HATS   402                41  109. 0.522 108.96194…
 6 HATS_402_041 Sample       HATS   402                41  110. 0.520 110.00910…
 7 HATS_402_041 Sample       HATS   402                41  111. 1.12  111.00780…
 8 HATS_402_041 Sample       HATS   402                41  112. 2.25  112.05052…
 9 HATS_402_041 Sample       HATS   402                41  112. 0.710 112.05058…
10 HATS_402_041 Sample       HATS   402                41  112. 0.533 112.08688…
# ℹ 53,666 more rows
# ℹ 1 more variable: rel_abund &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make run_order numeric</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long<span class="sc">$</span>run_order <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(metab_imputed_clustered_long<span class="sc">$</span>run_order)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make treatment and sample_or_qc a factor (i.e., categorical)</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long<span class="sc">$</span>tomato <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(metab_imputed_clustered_long<span class="sc">$</span>tomato)</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long<span class="sc">$</span>sample_or_qc <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(metab_imputed_clustered_long<span class="sc">$</span>sample_or_qc)</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co"># did it work?</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(metab_imputed_clustered_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 53,676 × 9
   sample_name  sample_or_qc tomato rep_or_plot run_order    mz    rt mz_rt     
   &lt;chr&gt;        &lt;fct&gt;        &lt;fct&gt;  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
 1 HATS_402_041 Sample       HATS   402                41  104. 0.630 104.05926…
 2 HATS_402_041 Sample       HATS   402                41  104. 0.629 104.07084…
 3 HATS_402_041 Sample       HATS   402                41  104. 0.600 104.10742…
 4 HATS_402_041 Sample       HATS   402                41  104. 0.614 104.12482…
 5 HATS_402_041 Sample       HATS   402                41  109. 0.522 108.96194…
 6 HATS_402_041 Sample       HATS   402                41  110. 0.520 110.00910…
 7 HATS_402_041 Sample       HATS   402                41  111. 1.12  111.00780…
 8 HATS_402_041 Sample       HATS   402                41  112. 2.25  112.05052…
 9 HATS_402_041 Sample       HATS   402                41  112. 0.710 112.05058…
10 HATS_402_041 Sample       HATS   402                41  112. 0.533 112.08688…
# ℹ 53,666 more rows
# ℹ 1 more variable: rel_abund &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Let’s make a boxplot to see how the metabolite abundance looks across different samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_name, <span class="at">y =</span> rel_abund, <span class="at">fill =</span> tomato)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LC-MS (+) Feature Abundances by Sample"</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data is unscaled"</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relative abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Can’t really see anything because data is skewed.</p>
</section>
<section id="transformed-data" class="level3">
<h3 class="anchored" data-anchor-id="transformed-data">Transformed data</h3>
<section id="log2-transformed" class="level4">
<h4 class="anchored" data-anchor-id="log2-transformed">Log2 transformed</h4>
<p>We will log2 transform our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log2 <span class="ot">&lt;-</span> metab_imputed_clustered_long <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_abund =</span> <span class="fu">log2</span>(rel_abund))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_name, <span class="at">y =</span> rel_abund, <span class="at">fill =</span> tomato)) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LC-MS (+) Feature Abundances by Sample"</span>,</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data is log2 transformed"</span>,</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relative abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>We can also look at this data by run order to see if we have any overall run order effects visible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_name =</span> <span class="fu">fct_reorder</span>(sample_name, run_order)) <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_name, <span class="at">y =</span> rel_abund, <span class="at">fill =</span> tomato)) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LC-MS (+) Feature Abundances by Sample"</span>,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data is log2 transformed"</span>,</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relative abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
</section>
<section id="log10-transformed" class="level4">
<h4 class="anchored" data-anchor-id="log10-transformed">Log10 transformed</h4>
<p>We will log10 transform our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log10 <span class="ot">&lt;-</span> metab_imputed_clustered_long <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_abund =</span> <span class="fu">log10</span>(rel_abund))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can look at this data where we group by species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log10 <span class="sc">%&gt;%</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_name , <span class="at">y =</span> rel_abund, <span class="at">fill =</span> tomato)) <span class="sc">+</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LC-MS (+) Feature Abundances by Sample"</span>,</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data is log10 transformed"</span>,</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relative abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>We can also look at this data by run order to see if we have any overall run order effects visible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log10 <span class="sc">%&gt;%</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_name =</span> <span class="fu">fct_reorder</span>(sample_name, run_order)) <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_name , <span class="at">y =</span> rel_abund, <span class="at">fill =</span> tomato)) <span class="sc">+</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LC-MS (+) Feature Abundances by Sample"</span>,</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data is log10 transformed"</span>,</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relative abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
</section>
<section id="pareto-scaled" class="level4">
<h4 class="anchored" data-anchor-id="pareto-scaled">Pareto scaled</h4>
<p>Pareto scaling scales but keeps the fidelity of the original differences in absolute measurement value more than autoscaling. Often data is Pareto scaled after log transofmration</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>metab_wide_meta_imputed_log2 <span class="ot">&lt;-</span> metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>mz, <span class="sc">-</span>rt) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"mz_rt"</span>,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="st">"rel_abund"</span>)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_wide_log2_metabs <span class="ot">&lt;-</span> </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  metab_wide_meta_imputed_log2[,<span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(metab_wide_meta_imputed_log2)]</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>pareto_scaled <span class="ot">&lt;-</span> </span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>  IMIFA<span class="sc">::</span><span class="fu">pareto_scale</span>(metab_imputed_clustered_wide_log2_metabs, <span class="at">center =</span> <span class="cn">FALSE</span>)</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>pareto_scaled <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(metab_wide_meta_imputed_log2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], pareto_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `104.059264569687_0.6302757` -&gt; `104.059264569687_0.6302757...6`
• `104.059264569687_0.6302757` -&gt; `104.059264569687_0.6302757...7`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>pareto_scaled_long <span class="ot">&lt;-</span> pareto_scaled <span class="sc">%&gt;%</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(.),</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"mz_rt"</span>,</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>pareto_scaled_long <span class="sc">%&gt;%</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(short_sample_name = fct_reorder(short_sample_name, treatment)) %&gt;%</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_name, <span class="at">y =</span> rel_abund, <span class="at">fill =</span> tomato)) <span class="sc">+</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LC-MS (+) Feature Abundances by Sample"</span>,</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data is Pareto scaled"</span>,</span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relative abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>I think pareto scaling is making everything look super the same. I am going to use log2 transformed data for the rest of this analysis.</p>
</section>
</section>
</section>
<section id="pcas" class="level2">
<h2 class="anchored" data-anchor-id="pcas">PCAs</h2>
<section id="with-qcs" class="level3">
<h3 class="anchored" data-anchor-id="with-qcs">With QCs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>pca_qc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(metab_wide_meta_imputed_log2[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="co"># remove metadata</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="co"># we did our own scaling</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">center =</span> <span class="cn">TRUE</span>) <span class="co"># true is the default</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Importance of components:
                           PC1     PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     31.5978 13.9066 9.93235 8.13835 6.00911 5.27438 4.89711
Proportion of Variance  0.6171  0.1195 0.06098 0.04094 0.02232 0.01719 0.01482
Cumulative Proportion   0.6171  0.7367 0.79762 0.83856 0.86088 0.87807 0.89289
                           PC8     PC9    PC10    PC11    PC12   PC13    PC14
Standard deviation     4.15326 3.77844 3.63247 3.37842 3.25481 2.9004 2.79743
Proportion of Variance 0.01066 0.00882 0.00816 0.00705 0.00655 0.0052 0.00484
Cumulative Proportion  0.90356 0.91238 0.92054 0.92759 0.93414 0.9393 0.94417
                          PC15    PC16    PC17    PC18    PC19   PC20    PC21
Standard deviation     2.60922 2.50876 2.47274 2.33790 2.28918 2.2393 2.12246
Proportion of Variance 0.00421 0.00389 0.00378 0.00338 0.00324 0.0031 0.00278
Cumulative Proportion  0.94838 0.95227 0.95605 0.95943 0.96267 0.9658 0.96855
                          PC22    PC23    PC24    PC25    PC26    PC27    PC28
Standard deviation     2.11490 2.06807 2.02501 1.95844 1.86445 1.82459 1.76587
Proportion of Variance 0.00276 0.00264 0.00253 0.00237 0.00215 0.00206 0.00193
Cumulative Proportion  0.97132 0.97396 0.97650 0.97887 0.98102 0.98307 0.98500
                          PC29    PC30    PC31    PC32    PC33    PC34    PC35
Standard deviation     1.74077 1.67539 1.67410 1.65514 1.58903 1.53161 1.45988
Proportion of Variance 0.00187 0.00173 0.00173 0.00169 0.00156 0.00145 0.00132
Cumulative Proportion  0.98687 0.98861 0.99034 0.99203 0.99359 0.99504 0.99636
                          PC36    PC37   PC38    PC39    PC40   PC41     PC42
Standard deviation     1.41771 1.01189 0.9033 0.84205 0.82590 0.8036 2.29e-14
Proportion of Variance 0.00124 0.00063 0.0005 0.00044 0.00042 0.0004 0.00e+00
Cumulative Proportion  0.99760 0.99824 0.9987 0.99918 0.99960 1.0000 1.00e+00</code></pre>
</div>
</div>
<p>Look at how much variance is explained by each PC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>importance_qc <span class="ot">&lt;-</span> <span class="fu">summary</span>(pca_qc)<span class="sc">$</span>importance <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(importance_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>                            PC1      PC2      PC3      PC4      PC5      PC6
Standard deviation     31.59782 13.90658 9.932345 8.138347 6.009109 5.274385
Proportion of Variance  0.61711  0.11953 0.060980 0.040940 0.022320 0.017190
Cumulative Proportion   0.61711  0.73665 0.797620 0.838560 0.860880 0.878070
                            PC7      PC8      PC9     PC10     PC11     PC12
Standard deviation     4.897111 4.153257 3.778439 3.632472 3.378419 3.254811
Proportion of Variance 0.014820 0.010660 0.008820 0.008160 0.007050 0.006550
Cumulative Proportion  0.892890 0.903560 0.912380 0.920540 0.927590 0.934140
                           PC13     PC14     PC15     PC16     PC17     PC18
Standard deviation     2.900409 2.797427 2.609218 2.508758 2.472735 2.337897
Proportion of Variance 0.005200 0.004840 0.004210 0.003890 0.003780 0.003380
Cumulative Proportion  0.939340 0.944170 0.948380 0.952270 0.956050 0.959430
                          PC19    PC20     PC21     PC22     PC23     PC24
Standard deviation     2.28918 2.23927 2.122464 2.114901 2.068071 2.025009
Proportion of Variance 0.00324 0.00310 0.002780 0.002760 0.002640 0.002530
Cumulative Proportion  0.96267 0.96577 0.968550 0.971320 0.973960 0.976500
                           PC25     PC26     PC27     PC28     PC29     PC30
Standard deviation     1.958436 1.864446 1.824592 1.765867 1.740772 1.675393
Proportion of Variance 0.002370 0.002150 0.002060 0.001930 0.001870 0.001730
Cumulative Proportion  0.978870 0.981020 0.983070 0.985000 0.986870 0.988610
                           PC31     PC32     PC33     PC34     PC35     PC36
Standard deviation     1.674095 1.655141 1.589032 1.531608 1.459883 1.417712
Proportion of Variance 0.001730 0.001690 0.001560 0.001450 0.001320 0.001240
Cumulative Proportion  0.990340 0.992030 0.993590 0.995040 0.996360 0.997600
                           PC37      PC38      PC39      PC40      PC41
Standard deviation     1.011887 0.9032848 0.8420541 0.8258958 0.8035735
Proportion of Variance 0.000630 0.0005000 0.0004400 0.0004200 0.0004000
Cumulative Proportion  0.998240 0.9987400 0.9991800 0.9996000 1.0000000
                               PC42
Standard deviation     2.289946e-14
Proportion of Variance 0.000000e+00
Cumulative Proportion  1.000000e+00</code></pre>
</div>
</div>
<p>Generate a scree plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Generate a scores plot (points are samples) quickly with <code>fviz_pca_ind</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Make a scores plot but prettier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a df of pca_qc$x</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>scores_raw_qc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_qc<span class="sc">$</span>x)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bind meta-data</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>scores_qc <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(metab_wide_meta_imputed_log2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="co"># first 5 columns</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>                       scores_raw_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create objects indicating percent variance explained by PC1 and PC2</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>PC1_percent_qc <span class="ot">&lt;-</span> <span class="fu">round</span>((importance_qc[<span class="dv">2</span>,<span class="dv">1</span>])<span class="sc">*</span><span class="dv">100</span>, <span class="co"># index 2nd row, 1st column, times 100</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1</span>) <span class="co"># round to 1 decimal</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>PC2_percent_qc <span class="ot">&lt;-</span> <span class="fu">round</span>((importance_qc[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>) </span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co"># aes(text) is for setting tooltip with plotly later to indicate hover text</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>(scores_qc_plot <span class="ot">&lt;-</span> scores_qc <span class="sc">%&gt;%</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">fill =</span> tomato, <span class="at">text =</span> <span class="fu">glue</span>(<span class="st">"Sample: {sample_name},</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="st">                                                           Treatment: {tomato}"</span>))) <span class="sc">+</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">glue</span>(<span class="st">"PC1: {PC1_percent_qc}%"</span>), </span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">glue</span>(<span class="st">"PC2: {PC2_percent_qc}%"</span>), </span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"PCA Scores Plot by Tomato Type"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Then make your scores plot ineractive so you can see who is who.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(scores_qc_plot, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4c0e64c87ec37c4d5172" style="width:85%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4c0e64c87ec37c4d5172">{"x":{"data":[{"x":[-42.71804774848831,52.891467354057013],"y":[0,0],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[-22.521517659224166,22.493899831481976],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-25.331595139643152,-18.760720311718202,-23.247397893227461,-17.780312045613801,-17.000430129788825,-22.093923251278191,-22.704654415276394,-22.824151562282587,-15.973458203347162,-17.527001339151724,-16.624935445412479,-17.360633536229113],"y":[19.29413378190775,18.032197076736104,19.38310866648191,18.378238826153886,15.465055808239471,19.404415940087762,16.806490812512482,20.447744490995333,13.938518015671134,18.16039717837371,18.055711297485534,13.714701483657695],"text":["Sample: HATS_402_041,<br />Treatment: HATS","Sample: HATS_403_037,<br />Treatment: HATS","Sample: HATS_404_040,<br />Treatment: HATS","Sample: HATS_401_022,<br />Treatment: HATS","Sample: HATS_408_043,<br />Treatment: HATS","Sample: HATS_405_025,<br />Treatment: HATS","Sample: HATS_406_055,<br />Treatment: HATS","Sample: HATS_407_059,<br />Treatment: HATS","Sample: HATS_412_019,<br />Treatment: HATS","Sample: HATS_409_056,<br />Treatment: HATS","Sample: HATS_410_018,<br />Treatment: HATS","Sample: HATS_411_044,<br />Treatment: HATS"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"HATS","legendgroup":"HATS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39.061590030565391,47.178889905413065,47.938148779412771,44.709272186112074,44.243805510360403,43.951464924029679,43.67938366934704,47.617824555308431,43.552405837841292,41.340545270919677,42.325335024877454,48.545580303941314],"y":[2.8767528703281688,-1.1087512243440436,0.36503265747992802,-2.0044056231215133,-5.4246301151692018,-2.2111868967630319,-5.4264698193517633,-8.0776625413470349,-7.68332483484674,-9.9347899060636529,-8.6671565960091588,-6.572720193563141],"text":["Sample: LA2213_602_035,<br />Treatment: LA2213","Sample: LA2213_603_045,<br />Treatment: LA2213","Sample: LA2213_601_051,<br />Treatment: LA2213","Sample: LA2213_604_016,<br />Treatment: LA2213","Sample: LA2213_605_017,<br />Treatment: LA2213","Sample: LA2213_607_032,<br />Treatment: LA2213","Sample: LA2213_608_024,<br />Treatment: LA2213","Sample: LA2213_606_033,<br />Treatment: LA2213","Sample: LA2213_609_058,<br />Treatment: LA2213","Sample: LA2213_610_050,<br />Treatment: LA2213","Sample: LA2213_612_046,<br />Treatment: LA2213","Sample: LA2213_611_061,<br />Treatment: LA2213"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"LA2213","legendgroup":"LA2213","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-25.11247224824994,-27.813450740678466,-28.774114487757643,-33.605892912350384,-32.701730834578157,-38.37216069837261,-31.803245391896422,-30.936376602672933,-28.448511748096127,-28.351965987209837,-33.71177105513145,-28.311895019167299],"y":[-19.378611137502524,-8.6464347844086316,-17.832617289946295,-20.475362318737524,-17.741040319294616,-18.423917139977167,-15.107607216645901,-18.507288093261653,-15.433568337308229,-17.544317484188021,-11.398240086693765,-18.955171425956706],"text":["Sample: OH8243_801_036,<br />Treatment: OH8243","Sample: OH8243_802_026,<br />Treatment: OH8243","Sample: OH8243_803_030,<br />Treatment: OH8243","Sample: OH8243_805_057,<br />Treatment: OH8243","Sample: OH8243_804_029,<br />Treatment: OH8243","Sample: OH8243_806_027,<br />Treatment: OH8243","Sample: OH8243_809_063,<br />Treatment: OH8243","Sample: OH8243_807_053,<br />Treatment: OH8243","Sample: OH8243_810_049,<br />Treatment: OH8243","Sample: OH8243_808_038,<br />Treatment: OH8243","Sample: OH8243_812_060,<br />Treatment: OH8243","Sample: OH8243_811_028,<br />Treatment: OH8243"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"OH8243","legendgroup":"OH8243","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[11.979171969704041,12.17651504162577,11.613857256612484,11.879761391128952,11.770993957796284,11.608255384134196],"y":[6.9874202542070556,6.9114972616573658,7.2326228518737485,7.052770261489429,6.903545719776111,7.1449181293856663],"text":["Sample: QC_02_031,<br />Treatment: QC","Sample: QC_04_047,<br />Treatment: QC","Sample: QC_01_023,<br />Treatment: QC","Sample: QC_03_039,<br />Treatment: QC","Sample: QC_05_054,<br />Treatment: QC","Sample: QC_06_062,<br />Treatment: QC"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"QC","legendgroup":"QC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"PCA Scores Plot by Tomato Type","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-42.71804774848831,52.891467354057013],"tickmode":"array","ticktext":["-25","0","25","50"],"tickvals":[-25,0,25.000000000000007,50.000000000000007],"categoryorder":"array","categoryarray":["-25","0","25","50"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"PC1: 61.7%","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-22.521517659224166,22.493899831481976],"tickmode":"array","ticktext":["-20","-10","0","10","20"],"tickvals":[-20,-9.9999999999999982,-3.5527136788005009e-15,10,20],"categoryorder":"array","categoryarray":["-20","-10","0","10","20"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"PC2: 12%","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"tomato","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c0f2b778bf6":{"yintercept":{},"type":"scatter"},"c0f3585d9c5":{"xintercept":{}},"c0f669c2ff6":{"x":{},"y":{},"fill":{},"text":{}}},"cur_data":"c0f2b778bf6","visdat":{"c0f2b778bf6":["function (y) ","x"],"c0f3585d9c5":["function (y) ","x"],"c0f669c2ff6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Make a loadings plot (points are features) even though it might not be that useful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_qc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>See what I mean? Not that useful. There are some functions in PCAtools that label only the points that most contribute to each PC. Could also do this manually if its of interest.</p>
</section>
<section id="without-qcs" class="level3">
<h3 class="anchored" data-anchor-id="without-qcs">Without QCs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>metab_wide_meta_imputed_log2_noqc <span class="ot">&lt;-</span> metab_wide_meta_imputed_log2 <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample_or_qc <span class="sc">==</span> <span class="st">"Sample"</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>pca_noqc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(metab_wide_meta_imputed_log2_noqc[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)], <span class="co"># remove metadata</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="co"># we did our own scaling</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">center =</span> <span class="cn">TRUE</span>) <span class="co"># true is the default</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_noqc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Importance of components:
                           PC1     PC2      PC3     PC4     PC5     PC6     PC7
Standard deviation     33.8130 14.8180 10.35429 7.37824 5.87947 5.66811 4.56144
Proportion of Variance  0.6381  0.1225  0.05983 0.03038 0.01929 0.01793 0.01161
Cumulative Proportion   0.6381  0.7606  0.82044 0.85082 0.87011 0.88804 0.89965
                           PC8     PC9    PC10    PC11    PC12    PC13   PC14
Standard deviation     4.19510 3.94170 3.65660 3.52261 3.15233 3.02541 2.8696
Proportion of Variance 0.00982 0.00867 0.00746 0.00693 0.00555 0.00511 0.0046
Cumulative Proportion  0.90947 0.91815 0.92561 0.93253 0.93808 0.94319 0.9478
                          PC15   PC16    PC17    PC18    PC19    PC20   PC21
Standard deviation     2.72814 2.6756 2.53288 2.49238 2.42314 2.30610 2.2782
Proportion of Variance 0.00415 0.0040 0.00358 0.00347 0.00328 0.00297 0.0029
Cumulative Proportion  0.95194 0.9559 0.95951 0.96298 0.96626 0.96922 0.9721
                          PC22    PC23    PC24    PC25    PC26    PC27    PC28
Standard deviation     2.22947 2.21499 2.12382 2.02431 1.99311 1.91079 1.88658
Proportion of Variance 0.00277 0.00274 0.00252 0.00229 0.00222 0.00204 0.00199
Cumulative Proportion  0.97489 0.97763 0.98015 0.98244 0.98465 0.98669 0.98868
                          PC29    PC30   PC31    PC32    PC33    PC34    PC35
Standard deviation     1.81478 1.80964 1.7951 1.71348 1.65351 1.57592 1.53143
Proportion of Variance 0.00184 0.00183 0.0018 0.00164 0.00153 0.00139 0.00131
Cumulative Proportion  0.99051 0.99234 0.9941 0.99578 0.99731 0.99869 1.00000
                            PC36
Standard deviation     2.318e-14
Proportion of Variance 0.000e+00
Cumulative Proportion  1.000e+00</code></pre>
</div>
</div>
<p>Look at how much variance is explained by each PC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>importance_noqc <span class="ot">&lt;-</span> <span class="fu">summary</span>(pca_noqc)<span class="sc">$</span>importance <span class="sc">%&gt;%</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(importance_noqc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>                            PC1      PC2      PC3      PC4      PC5      PC6
Standard deviation     33.81302 14.81805 10.35429 7.378238 5.879475 5.668112
Proportion of Variance  0.63807  0.12254  0.05983 0.030380 0.019290 0.017930
Cumulative Proportion   0.63807  0.76061  0.82044 0.850820 0.870110 0.888040
                            PC7      PC8      PC9     PC10     PC11     PC12
Standard deviation     4.561444 4.195102 3.941697 3.656604 3.522607 3.152326
Proportion of Variance 0.011610 0.009820 0.008670 0.007460 0.006930 0.005550
Cumulative Proportion  0.899650 0.909470 0.918150 0.925610 0.932530 0.938080
                           PC13     PC14     PC15     PC16     PC17     PC18
Standard deviation     3.025414 2.869611 2.728145 2.675604 2.532883 2.492383
Proportion of Variance 0.005110 0.004600 0.004150 0.004000 0.003580 0.003470
Cumulative Proportion  0.943190 0.947780 0.951940 0.955930 0.959510 0.962980
                           PC19     PC20     PC21     PC22     PC23     PC24
Standard deviation     2.423142 2.306101 2.278208 2.229472 2.214987 2.123819
Proportion of Variance 0.003280 0.002970 0.002900 0.002770 0.002740 0.002520
Cumulative Proportion  0.966260 0.969220 0.972120 0.974890 0.977630 0.980150
                           PC25     PC26     PC27     PC28    PC29     PC30
Standard deviation     2.024309 1.993108 1.910792 1.886578 1.81478 1.809644
Proportion of Variance 0.002290 0.002220 0.002040 0.001990 0.00184 0.001830
Cumulative Proportion  0.982440 0.984650 0.986690 0.988680 0.99051 0.992340
                           PC31     PC32     PC33    PC34     PC35      PC36
Standard deviation     1.795088 1.713483 1.653513 1.57592 1.531426 2.318e-14
Proportion of Variance 0.001800 0.001640 0.001530 0.00139 0.001310 0.000e+00
Cumulative Proportion  0.994140 0.995780 0.997310 0.99869 1.000000 1.000e+00</code></pre>
</div>
</div>
<p>Generate a scree plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_noqc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Generate a scores plot (points are samples) quickly with <code>fviz_pca_ind</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_noqc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Make a scores plot but prettier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a df of pca_qc$x</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>scores_raw_noqc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_noqc<span class="sc">$</span>x)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bind meta-data</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>scores_noqc <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(metab_wide_meta_imputed_log2_noqc[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="co"># metadata</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>                         scores_raw_noqc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create objects indicating percent variance explained by PC1 and PC2</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>PC1_percent_noqc <span class="ot">&lt;-</span> <span class="fu">round</span>((importance_noqc[<span class="dv">2</span>,<span class="dv">1</span>])<span class="sc">*</span><span class="dv">100</span>, <span class="co"># index 2nd row, 1st column, times 100</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1</span>) <span class="co"># round to 1 decimal</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>PC2_percent_noqc <span class="ot">&lt;-</span> <span class="fu">round</span>((importance_noqc[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>) </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co"># aes(text) is for setting tooltip with plotly later to indicate hover text</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>(scores_noqc_plot <span class="ot">&lt;-</span> scores_noqc <span class="sc">%&gt;%</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">fill =</span> tomato, <span class="at">text =</span> <span class="fu">glue</span>(<span class="st">"Sample: {sample_name},</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="st">                                                             Treatment: {tomato}"</span>))) <span class="sc">+</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">glue</span>(<span class="st">"PC1: {PC1_percent_noqc}%"</span>), </span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">glue</span>(<span class="st">"PC2: {PC2_percent_noqc}%"</span>), </span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"PCA Scores Plot Colored by Tomato Type"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Then make your scores plot ineractive so you can see who is who.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(scores_noqc_plot, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-42f2ff4de202fd921474" style="width:85%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-42f2ff4de202fd921474">{"x":{"data":[{"x":[-40.364007857948458,54.829012577743249],"y":[0,0],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[-21.148687475491649,24.323847517111925],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-23.247926541027194,-17.01460981157415,-21.492407054359045,-16.352411757104854,-15.279093830300736,-20.425813900949517,-20.879736345089743,-21.202512600982278,-14.148816185439633,-15.660159482739925,-15.151097260002544,-15.698492281147127],"y":[22.256914108357218,19.073148932135734,20.537396372000437,18.037424773967938,16.397170912923023,20.325773147984297,18.107017379524653,21.185153482333593,15.00009672152513,19.77915367651017,18.027982585704777,14.101788661465127],"text":["Sample: HATS_402_041,<br />Treatment: HATS","Sample: HATS_403_037,<br />Treatment: HATS","Sample: HATS_404_040,<br />Treatment: HATS","Sample: HATS_401_022,<br />Treatment: HATS","Sample: HATS_408_043,<br />Treatment: HATS","Sample: HATS_405_025,<br />Treatment: HATS","Sample: HATS_406_055,<br />Treatment: HATS","Sample: HATS_407_059,<br />Treatment: HATS","Sample: HATS_412_019,<br />Treatment: HATS","Sample: HATS_409_056,<br />Treatment: HATS","Sample: HATS_410_018,<br />Treatment: HATS","Sample: HATS_411_044,<br />Treatment: HATS"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"HATS","legendgroup":"HATS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[41.197496146707152,49.19390040807874,49.690954710967176,46.565551720345631,46.485142673360663,45.999931580234247,45.813531195634781,49.708039340271419,45.760136244321423,43.55337216029254,44.256184589140645,50.502057103393625],"y":[5.6463497818195947,0.98548108100048248,1.5298005579330336,-0.68567134151091036,-2.7463376594032098,-0.11074802759695603,-3.0962459324403602,-6.1520676078960692,-5.2247387794599609,-7.6598986159520068,-7.45016178133681,-5.0665860771480604],"text":["Sample: LA2213_602_035,<br />Treatment: LA2213","Sample: LA2213_603_045,<br />Treatment: LA2213","Sample: LA2213_601_051,<br />Treatment: LA2213","Sample: LA2213_604_016,<br />Treatment: LA2213","Sample: LA2213_605_017,<br />Treatment: LA2213","Sample: LA2213_607_032,<br />Treatment: LA2213","Sample: LA2213_608_024,<br />Treatment: LA2213","Sample: LA2213_606_033,<br />Treatment: LA2213","Sample: LA2213_609_058,<br />Treatment: LA2213","Sample: LA2213_610_050,<br />Treatment: LA2213","Sample: LA2213_612_046,<br />Treatment: LA2213","Sample: LA2213_611_061,<br />Treatment: LA2213"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"LA2213","legendgroup":"LA2213","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-22.749855936664936,-25.644282578772472,-26.664038556752057,-31.27910438087698,-30.492160042136828,-36.037052383598834,-29.826129553186817,-28.823984684475974,-26.330228659388418,-26.404676672796079,-31.838838385890497,-26.082868987491427],"y":[-18.243778927431407,-7.5345656947482897,-17.557822790648085,-19.081754066736941,-16.934378104175952,-16.935019693964815,-15.223208285149676,-18.28575169276591,-15.006861889545327,-17.957813848453711,-11.7193163765793,-18.317924982241465],"text":["Sample: OH8243_801_036,<br />Treatment: OH8243","Sample: OH8243_802_026,<br />Treatment: OH8243","Sample: OH8243_803_030,<br />Treatment: OH8243","Sample: OH8243_805_057,<br />Treatment: OH8243","Sample: OH8243_804_029,<br />Treatment: OH8243","Sample: OH8243_806_027,<br />Treatment: OH8243","Sample: OH8243_809_063,<br />Treatment: OH8243","Sample: OH8243_807_053,<br />Treatment: OH8243","Sample: OH8243_810_049,<br />Treatment: OH8243","Sample: OH8243_808_038,<br />Treatment: OH8243","Sample: OH8243_812_060,<br />Treatment: OH8243","Sample: OH8243_811_028,<br />Treatment: OH8243"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"OH8243","legendgroup":"OH8243","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"PCA Scores Plot Colored by Tomato Type","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-40.364007857948458,54.829012577743249],"tickmode":"array","ticktext":["-40","-20","0","20","40"],"tickvals":[-40,-20,0,20.000000000000007,39.999999999999993],"categoryorder":"array","categoryarray":["-40","-20","0","20","40"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"PC1: 63.8%","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-21.148687475491649,24.323847517111925],"tickmode":"array","ticktext":["-20","-10","0","10","20"],"tickvals":[-20,-10,0,10,20],"categoryorder":"array","categoryarray":["-20","-10","0","10","20"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"PC2: 12.3%","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"tomato","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c0f366b7a99":{"yintercept":{},"type":"scatter"},"c0f4a3deeb8":{"xintercept":{}},"c0f2803981c":{"x":{},"y":{},"fill":{},"text":{}}},"cur_data":"c0f366b7a99","visdat":{"c0f366b7a99":["function (y) ","x"],"c0f4a3deeb8":["function (y) ","x"],"c0f2803981c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Make a loadings plot (points are features) even though it might not be that useful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_noqc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>See what I mean? Not that useful. There are some functions in PCAtools that label only the points that most contribute to each PC. Could also do this manually if its of interest.</p>
</section>
</section>
<section id="univariate-testing" class="level2">
<h2 class="anchored" data-anchor-id="univariate-testing">Univariate Testing</h2>
<p>I am going to include some sample univariate testing for comparisons between two and more than two groups.</p>
<section id="anova---2-groups" class="level3">
<h3 class="anchored" data-anchor-id="anova---2-groups">ANOVA - &gt; 2 groups</h3>
<p>Just to test it out, I’m going to test for significant differences between our three tomato groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run series of t-tests</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>tomato <span class="sc">==</span> <span class="st">"QC"</span>) <span class="sc">%&gt;%</span> <span class="co"># remove QCs</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_name, tomato, mz_rt, rel_abund) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(rel_abund <span class="sc">~</span> tomato)</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust pvalues for multiple testing</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>anova_padjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(anova<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">p_adj =</span> <span class="dv">1</span>)</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>anova_padj <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="fu">as.data.frame</span>(anova), anova_padjusted) <span class="sc">%&gt;%</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">padj =</span> <span class="dv">9</span>)</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a><span class="co"># extract out only the significantly different features</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>anova_sig <span class="ot">&lt;-</span> anova_padj <span class="sc">%&gt;%</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features are significantly different between the groups?</span></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(anova_sig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 1156</code></pre>
</div>
</div>
<p>Do we think this is reasonable? What if I make a quick boxplot of the relative intensity of the feature that has the smallest p-value from this comparison (236.200891807883_6.022641).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">==</span> <span class="st">"236.200891807883_6.022641"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tomato, <span class="at">y =</span> rel_abund, <span class="at">color =</span> tomato)) <span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample type"</span>,</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log2 relative abundance of 236.200891807883_6.022641"</span>,</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Difference in log2 relative abundance of 236.200891807883_6.022641 </span><span class="sc">\n</span><span class="st">between tomato types"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Ok we can see why this is very different across the groups :)</p>
</section>
<section id="t-test-2-groups" class="level3">
<h3 class="anchored" data-anchor-id="t-test-2-groups">T-test, 2 groups</h3>
<section id="non-parametric" class="level4">
<h4 class="anchored" data-anchor-id="non-parametric">Non-parametric</h4>
<p>Data might not be normally distributed so I did a nonparametric test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run series of t-tests</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>oh8243_hats_nonparam <span class="ot">&lt;-</span> metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tomato <span class="sc">==</span> <span class="st">"OH8243"</span> <span class="sc">|</span> tomato <span class="sc">==</span> <span class="st">"HATS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_name, tomato, mz_rt, rel_abund) <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(rel_abund <span class="sc">~</span> tomato, </span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">paired =</span> <span class="cn">FALSE</span>, </span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">detailed =</span> <span class="cn">TRUE</span>, <span class="co"># gives you more detail in output</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>) <span class="sc">%&gt;%</span> <span class="co"># Benjamini-Hochberg false discovery rate multiple testing correction</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="co"># extract out only the significantly different features</span></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>oh8243_hats_nonparam_sig <span class="ot">&lt;-</span> oh8243_hats_nonparam <span class="sc">%&gt;%</span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features are significantly different between the groups?</span></span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(oh8243_hats_nonparam_sig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 663</code></pre>
</div>
</div>
<p>Let’s do the same thing again here with a boxplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">==</span> <span class="st">"1004.54196498357_5.227879"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tomato <span class="sc">==</span> <span class="st">"HATS"</span> <span class="sc">|</span> tomato <span class="sc">==</span> <span class="st">"OH8243"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tomato, <span class="at">y =</span> rel_abund, <span class="at">color =</span> tomato)) <span class="sc">+</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample type"</span>,</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log2 relative abundance of 1004.54196498357_5.227879"</span>,</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Difference in log2 relative abundance of 1004.54196498357_5.227879 </span><span class="sc">\n</span><span class="st">between OH8243 and HATS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Write out the significantly different features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(oh8243_hats_nonparam_sig,</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"data/oh8243_hats_nonparam_sig.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parametric" class="level4">
<h4 class="anchored" data-anchor-id="parametric">Parametric</h4>
<p>Or we can assume data are normally distributed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run series of t-tests</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>oh8243_hats_param <span class="ot">&lt;-</span> metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tomato <span class="sc">==</span> <span class="st">"OH8243"</span> <span class="sc">|</span> tomato <span class="sc">==</span> <span class="st">"HATS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_name, tomato, mz_rt, rel_abund) <span class="sc">%&gt;%</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(rel_abund <span class="sc">~</span> tomato, </span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">paired =</span> <span class="cn">FALSE</span>, </span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">detailed =</span> <span class="cn">TRUE</span>, <span class="co"># gives you more detail in output</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>) <span class="sc">%&gt;%</span> <span class="co"># Benjamini-Hochberg false discovery rate multiple testing correction</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p)</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a><span class="co"># extract out only the significantly different features</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>oh8243_hats_param_sig <span class="ot">&lt;-</span> oh8243_hats_param <span class="sc">%&gt;%</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a><span class="co"># how many features are significantly different between the groups?</span></span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(oh8243_hats_param_sig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] 663</code></pre>
</div>
</div>
<p>Let’s do the same thing again here with a boxplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">==</span> <span class="st">"474.357920874411_5.0924287"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tomato <span class="sc">==</span> <span class="st">"HATS"</span> <span class="sc">|</span> tomato <span class="sc">==</span> <span class="st">"OH8243"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tomato, <span class="at">y =</span> rel_abund, <span class="at">color =</span> tomato)) <span class="sc">+</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample type"</span>,</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log2 relative abundance of 474.357920874411_5.0924287"</span>,</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Difference in log2 relative abundance of 474.357920874411_5.0924287 </span><span class="sc">\n</span><span class="st">between OH8243 and HATS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mz_rt <span class="sc">==</span> <span class="st">"474.357920874411_5.0924287"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tomato <span class="sc">==</span> <span class="st">"HATS"</span> <span class="sc">|</span> tomato <span class="sc">==</span> <span class="st">"OH8243"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tomato, <span class="at">y =</span> rel_abund, <span class="at">color =</span> tomato)) <span class="sc">+</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample type"</span>,</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log2 relative abundance of 474.3579_5.092"</span>,</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Difference in log2 relative abundance of 474.3579_5.092 </span><span class="sc">\n</span><span class="st">between OH8243 and HATS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Write out the significantly different features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(oh8243_hats_nonparam_sig,</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"data/oh8243_hats_param_sig.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="volcano-plot" class="level4">
<h4 class="anchored" data-anchor-id="volcano-plot">Volcano plot</h4>
<p>Let’s make a volcano plot so we can see which features are significantly different between OH8243 and HATS.</p>
<p>First we wrangle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>oh8243_hats_FC <span class="ot">&lt;-</span> metab_imputed_clustered_long_log2 <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tomato <span class="sc">==</span> <span class="st">"OH8243"</span> <span class="sc">|</span> tomato <span class="sc">==</span> <span class="st">"HATS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tomato, mz_rt) <span class="sc">%&gt;%</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rel_abund)) <span class="sc">%&gt;%</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> tomato, <span class="at">values_from =</span> mean) <span class="sc">%&gt;%</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HATS_minus_OH8243_log2FC =</span> (HATS <span class="sc">-</span> OH8243))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tomato'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>oh8243_hats_FC_pval <span class="ot">&lt;-</span> <span class="fu">left_join</span>(oh8243_hats_FC, oh8243_hats_param, <span class="at">by =</span> <span class="st">"mz_rt"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neglog10p =</span> <span class="sc">-</span><span class="fu">log10</span>(p))</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(oh8243_hats_FC_pval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code># A tibble: 6 × 21
  mz_rt    HATS OH8243 HATS_minus_OH8243_lo…¹ estimate estimate1 estimate2 .y.  
  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;                  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1 1002.1…  12.7  12.8                 -0.119   -0.119       12.7     12.8  rel_…
2 1004.5…  14.6   9.56                 5.07     5.07        14.6      9.56 rel_…
3 1007.2…  11.3  11.7                 -0.428   -0.428       11.3     11.7  rel_…
4 1007.5…  11.5  12.1                 -0.592   -0.592       11.5     12.1  rel_…
5 1010.4…  12.4  12.3                  0.0519   0.0519      12.4     12.3  rel_…
6 1010.7…  12.9  12.4                  0.514    0.514       12.9     12.4  rel_…
# ℹ abbreviated name: ¹​HATS_minus_OH8243_log2FC
# ℹ 13 more variables: group1 &lt;chr&gt;, group2 &lt;chr&gt;, n1 &lt;int&gt;, n2 &lt;int&gt;,
#   statistic &lt;dbl&gt;, p &lt;dbl&gt;, df &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;,
#   method &lt;chr&gt;, alternative &lt;chr&gt;, p.signif &lt;chr&gt;, neglog10p &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Looking at features that are at least 2 fold change between groups and significantly different at p&lt;0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>higher_HATS <span class="ot">&lt;-</span> oh8243_hats_FC_pval <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neglog10p <span class="sc">&gt;=</span> <span class="fl">1.3</span> <span class="sc">&amp;</span> HATS_minus_OH8243_log2FC <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>higher_OH8243 <span class="ot">&lt;-</span> oh8243_hats_FC_pval <span class="sc">%&gt;%</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neglog10p <span class="sc">&gt;=</span> <span class="fl">1.3</span> <span class="sc">&amp;</span> HATS_minus_OH8243_log2FC <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>(oh8243_hats_volcano <span class="ot">&lt;-</span> oh8243_hats_FC_pval <span class="sc">%&gt;%</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> HATS_minus_OH8243_log2FC, <span class="at">y =</span> neglog10p, <span class="at">text =</span> mz_rt)) <span class="sc">+</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> higher_HATS, </span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> HATS_minus_OH8243_log2FC, <span class="at">y =</span> neglog10p),</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> higher_OH8243, </span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> HATS_minus_OH8243_log2FC, <span class="at">y =</span> neglog10p),</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.3</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"-log2 fold change"</span>,</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"-log10 p-value"</span>,</span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"OH8243 vs HATS, positive mode"</span>,</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Higher in HATS on top right (red), higher in OH8243 on top left (blue)"</span>,</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Dotted lines represent a 2 fold difference between groups and a p-value &lt; 0.05"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Make the plot interactive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(oh8243_hats_volcano, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0118ef327d0f8b788195" style="width:85%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0118ef327d0f8b788195">{"x":{"data":[{"x":[-0.11885035534316302,5.0746725700195494,-0.42769733939266885,-0.59151087521995649,0.051881947879023116,0.51388678401196053,0.4142218567740148,0.91208938705925391,1.7416825348450544,0.581039818406067,-2.1434970554148602,0.42165077146503549,1.4198669960226091,-0.073997223308456483,4.4519721892129738,2.9533196860688236,-2.1486096377567154,-0.095358558958281492,3.0294567650920303,2.7689818055707995,-1.7731374158578319,0.33915711161651174,-0.061264207358544098,0.0054021441170881701,0.40892965095215139,-0.51112657387429294,-0.70189760933357626,0.72739778381065534,-0.07286026815394564,2.5607189865653304,1.8179519885913074,4.8404748321980176,0.47163400027879732,-0.2381928073227062,1.0550907549046862,0.46510071096485639,2.9840628354511267,0.82599472823436848,0.090177422459539969,-0.86363012593487909,0.11205984316831596,1.3645308255661899,0.2047238082017877,1.8991479112405116,0.45848422091442309,4.3051079072949925,0.39996848626633152,0.41835017995887824,0.46127748610863151,0.22909038494302614,0.18675127449878914,0.2118077965625762,3.2336801027267423,0.04236696089389369,0.18665778169844494,0.26148648568488575,0.37597848752944252,0.24320575483102758,-0.39823744908179748,0.29832814113698625,0.1879867953834804,0.17559431391523184,-0.0097293688862567507,0.14871130993160619,0.29410131312981846,0.75335218455611752,0.25076281164307979,0.26601262454417984,0.30179622181900179,0.011674165402926207,1.5237781711871392,0.084118742275752112,0.067419076160954106,0.010070750773161663,0.05316108619039106,0.19592941156298593,-0.082231576313445132,-0.076560565800964042,0.17246025397178322,-0.021044518520191957,-0.075688507524256821,0.021681859967301875,0.18951416149847411,0.0039883766373769447,-0.30627405626911219,0.39073463066815606,-0.28217383947525398,-0.29055580860573826,-1.1866971177749068,0.14106457858243182,0.17583446118488233,-0.056793328855926362,0.072652054492680307,-0.28281549551177676,-0.10525764306485996,0.088419845431284116,0.39455263363115023,0.37096748686562719,-0.52064752120978319,1.445387275100277,-0.24564042816778375,0.056711165897912252,0.25398130982629397,-0.26465441883417284,-0.15277348082508801,-0.75320298167616073,1.4408639214543619,1.178511052654553,1.1764103908796972,1.1378768611546306,-0.3427102994146054,0.39499790329923812,0.15765996479220057,-0.50220606293982328,1.5285940307615924,-0.2648690146430468,-5.1277872185526832,0.59640539756314936,-0.57980382093111338,-3.1236968352869372,-2.7040804257439515,-0.40899052956723381,-0.31937672667315198,-0.0033258538877412036,-3.446133165348547,-3.063504149111818,-0.14124507768340955,-1.9101878648127162,-3.0533043621042868,-2.2740608922281744,0.078587141242429936,0.099888160191415665,0.080677342924921902,-1.2709667566862421,0.060378978411099737,-0.55927498917367657,-0.1774108051703891,-0.43574441089820581,-0.30288671918673771,-2.7473536601764241,-1.5701346729045653,-0.061216101634432363,-0.058572445797837602,-0.40343529946159151,0.56400347791764638,0.2529023766360261,0.47211169076186366,-0.048412135536544554,-0.41302772735274118,-0.2670484897924652,-0.06081266368842364,1.5403753846483195,1.6191396692097424,0.69946543485378498,2.0802263275594992,0.3466361421990527,-0.014988371378436227,1.6375975437070238,0.15925072925740658,0.15267410228274514,-3.9953728323406903,0.17511523400261098,0.3578281578411282,-0.15747139991576375,0.38517376926329305,0.32448444142936417,0.098671022281351384,0.1052769038987762,-1.5763355414523073,-0.23020255270164469,-0.085539742671059571,0.28149383726369948,0.36825684226442057,0.38381804228576222,0.2797903736261862,-0.20530662827856005,0.35249282153818129,-0.084640925945418388,-0.1400907661259545,-0.15569744185790668,0.14466492041721146,0.30691151130247718,0.12705420303805504,0.25151073236187216,0.23624030590602985,0.21428542815934826,0.26783658726069781,-0.118345523447692,0.25167534363649224,0.21338699160352093,0.02211227765258883,0.1227190269806826,0.11380092777374884,0.78955879343940616,-0.034164092344893149,0.22418002830126404,0.15994148086549131,-0.07359556956016533,-0.29192213688758528,-0.17568069367843187,0.047333866650291156,0.12772387568785604,0.1110026215780362,-0.051945125251094737,0.16396062485404173,0.24288886947419464,0.27599716775191929,-0.1378155831338006,0.43572922621247301,0.60056560882089371,0.81703506681385818,0.7124724627636656,1.4608240107030728,0.39165142951221199,-0.34233393390352518,0.06276621864499532,-0.36795456503562107,-0.20973374557288338,-0.97518120308374634,0.07050532542771748,-0.18766889132498754,-0.7355459550510588,0.31077425199558739,0.093464366778441388,-0.0029169967691107246,0.1221247207791869,0.2845002917776327,0.10540626954192689,-0.032612268612362882,-0.35451193825729632,-0.51383122930611513,0.056786511528937211,0.52169612151832467,-0.25748815256272906,0.61573410679684493,0.83998977098239003,-0.25070822756447342,-0.19367369949033986,-0.31791740858280093,-0.064123267274244,0.050402163490456786,0.90209056590882852,-0.21925716313658583,0.2581756695327222,-0.24480087388628036,0.052569197602640116,-0.17168302082390419,0.048016042536449532,-0.14971883832853905,-1.0568269906090038,0.23717103335934731,-0.29611877725700886,0.011889857774750823,-0.63099305584279008,0.14794052932375834,0.31515352241093098,0.16624778256229256,0.05665741313393724,0.77325683751131535,0.15690568595863397,0.28033230842822832,-0.43321393562999333,-0.93258662865468622,-0.31679317042752331,-0.024830168051261481,0.055664792892164527,-0.22004777482100124,-0.57065245435306444,-0.21453102249914657,-0.84336167819705921,0.74705112893672876,-0.18903198528331444,-1.001645587340418,0.11037447976282522,-0.004550969823061024,-0.33243240605110635,0.1133446716927331,0.031656277765721441,-0.36350326301915814,0.010877983968676119,0.51480470791538302,-0.30001094299899123,0.10199251222066508,0.59204140473788414,-0.78778727749885746,0.1307399408416785,-0.94114242399486869,0.056399054143284388,9.8540541745961718e-05,0.21596047352360692,0.20272218601536274,-0.16412555846994081,0.65129809728520982,-0.4531252943151074,0.10718092822864556,-0.52256685775040168,0.031794489432622086,0.068092584031301584,-0.30081612830162108,-0.17027709117094858,-1.3154495509062425,0.4168018384469363,-1.0875335912325852,-0.22131539703835301,0.1724227237252336,0.61570452694435929,0.14758479950689818,0.10839638860613299,0.21389483708723844,0.25729891332696297,-0.28815389033864847,-0.6260990673322091,0.22137628784824059,0.25762925973083561,0.26303421774999691,0.23662469905476868,1.3289633613783476,0.0045527169108492416,-0.18419694382751217,-0.065589975657776023,0.069259807705510212,0.0019734983417354357,0.077625122536232993,0.014472901686660933,-0.26914515025678121,0.48544962881888942,-0.22067410271088583,-0.20011176143139586,0.81162949586674848,0.63523271380495316,0.055767657402411075,0.15624672437505893,0.39594471138654619,0.26252583143565644,-0.039511169031431592,-0.27814782891024947,-0.15731919034829289,-0.19517211942667601,-0.27017369983336437,0.10596187729047024,0.33421010100182968,0.87209110162493886,0.4449403851528082,0.19198918888530159,-0.77807922303690091,0.044364913041613718,0.081321722790010043,-1.4911749923945923,-1.2710423403984343,-0.24571719309948747,-0.20374542921919314,0.091205700880575336,0.43310451373422865,0.41657122084855125,-0.43898621718346753,-0.2295331298571579,0.57150191530839045,-0.41181721391179948,0.045038892448864942,-0.70428471049319263,-0.040941609292778125,0.14131438928247064,1.0997154974177707,2.6930894817008078,0.24455288134522668,0.22834417033931942,0.18952577142946758,0.15487519485407297,0.30041365860584612,-0.33643835239192299,0.72353065272322326,0.24022997703071169,0.16737961764115283,0.12733223138853234,-0.11954626680891067,0.059464687937424543,-0.50456192326187121,-0.19261181750084688,0.2191939085721657,0.010855738749182109,0.39734115143543747,0.71813260288669412,0.092278065940966769,-0.19758044340352754,-0.074671785462934182,-0.75713208690179989,-0.87800517289577229,0.034303695048468086,-0.062031791518119661,0.61828949456605109,1.1398388328284756,1.6111007247202735,0.88632065210094879,1.2955716329581168,0.38693374222678401,-0.47283145675052474,1.0271622033919545,0.017019943104333635,-0.1411202109980696,-0.26479755113207304,-0.37198844869060643,0.0015656498376994676,-0.27299137494012271,-0.18883631291016556,-0.38147105579889207,-0.55920630139810612,0.18048148548325926,0.33359409207392332,-0.08673430529593773,0.19328282543239261,1.3636377045814339,-0.54547967201467351,0.24613378153740761,-0.36251397931281204,-0.45680813610002069,0.28326043902686671,0.14905440529818215,-0.039317992966154236,0.16326107539601686,-0.79948630762211792,-0.26850884213990156,-0.1264608217755363,0.11515310556820069,-0.48733450201771689,-0.58805313066137188,-0.59539052498628564,1.0750437344576564,0.57559745131150208,0.90314393142973337,0.48629551120180992,-0.037035276233311265,-0.057767807080299605,0.1719938510897201,0.13380279828144204,-0.83208997451541222,0.36635043255538413,-0.027971637868475341,0.26838039646613154,-1.1216271404237617,0.73860516754558247,0.68186175206133193,0.091354441106902939,0.17501046164457357,0.28283405217246482,0.13986349707442614,0.72309492919823626,-0.37209891048756383,-0.25545687600109268,-0.0047360663978910367,-0.15682139532485806,-0.49047744911291957,0.80563592959664909,-0.21080152991649648,-0.10289319644601491,0.36795548476613504,-0.21560509969586228,0.65423576902233904,-0.045240802112921585,1.0840395399464242,-0.63447667932591045,-0.62970043447380952,0.31617620422258064,0.16211736143007016,0.15820024113277142,-0.28049467383599058,0.69689018186110552,-0.076448336303403863,-0.26008438671880896,0.051818948691209954,1.008827523842271,0.56987499521856577,0.023274043520874699,-0.12476757861198706,0.65939080662147731,0.82285360227874804,-0.16267583588140155,0.048595160847790808,0.31451535748920811,-0.43717537037340293,-0.17197362899931967,0.90988262472559001,-0.22151363065882634,-0.37957291204976507,-0.20243711558146771,-0.33568359748302612,1.3313412931840549,-0.37899894349599705,0.25875460056889743,-0.0043897796454785976,0.52085418589350496,-0.13207334246197,0.49920751977911948,0.071334995514936494,0.53282967302668816,0.51558140089111859,0.084155953112761139,0.22939342314117539,-0.36314203967336844,0.0045527169108492416,0.11501964551443855,-0.22118768668216937,0.67588605863244844,-0.36164002386262162,0.56289881114266471,0.081207104375524253,-0.16703866745896079,0.11075229035992606,-0.10552894042906757,0.30407831393600482,0.78602398323717182,-0.2211034850700635,-0.19484426769368035,0.09970090904289286,-0.026107393442185156,0.82661136068567664,0.45467063347468617,0.74427559204260163,0.44612604529230815,-0.16165707946855257,-0.77874442468123561,-0.33920448626827593,-0.36721528114263613,-0.35176291021549311,-0.26620415599370517,0.075654636312036061,0.081241037155171725,0.10058215341544319,0.53825692050070195,0.6950523812379501,0.21003414131246423,-0.71354341220398965,-0.25570072426954837,0.34300418930408938,0.85011743491024383,1.0983409645288358,-0.46232146941524555,-0.8252934138370307,-0.47444555551013501,-0.16946330881796001,-0.14566082893600552,-0.19498131614082936,0.59638894615286198,0.0087775042428841488,0.092671911466547741,0.44118287640610099,-0.049367038306694866,0.40159575637804323,-0.13008369842314771,-0.058830826690478233,-0.12937020926978882,-0.23694046480277464,-0.16991799261999674,0.11976738197645531,-0.1135578042945582,0.21938315915226525,0.08491798385629501,-0.40080821617577733,-0.36203188769760608,-0.05055248331379758,0.32027072010273727,0.25902917629873201,0.19364634503800637,-0.4375467164696456,-0.37635990108444162,-0.29395280551768366,1.3875527074537324,0.18561818029918875,0.42537702670454358,0.21322315277987336,0.68067535980068428,1.0622138088382034,1.3474479601137315,1.4064419726378095,-0.059337066636519609,-0.045675704918783921,-0.081675238677089368,-0.42667052297073482,0.19066927242395693,-0.12569641969931666,-0.04259121765259799,0.87409929089097815,0.22100524323699489,0.73209587007515609,-0.47912482152094427,-0.21649467812418344,-0.017207124914014216,-0.61818244298425107,-0.46570710375873503,0.017497454818872882,-0.087691745861578241,0.10817088982399703,-0.23923890396420155,-0.036304132805124567,-0.58874589244813613,0.066391474768668246,-0.2717477811671305,-0.28189579642695151,-0.60838553456494715,-0.17080017599168329,0.041302577580843547,-0.3809326410919418,-0.082494363414802763,-0.17125004233369978,-0.71957149834468481,-0.32413094577992752,-0.3480263492128568,-0.35972930113587509,-1.2983220564812239,-0.44326240328805611,-0.38910011606786199,0.41710062456181518,-0.74286822221547588,-0.46550166480256117,0.020473511748273054,-0.17532397134977806,-0.38079366270277148,-0.10632634105362193,0.39877474170374327,-0.067558664630134047,0.17855034044518092,-0.80006333374633343,-0.22072544627937773,-0.011442403585542493,0.39932801579926469,-0.016542310892283751,0.053950157720539238,0.079056533353009328,-0.60624155619267306,0.45348472394602801,-0.38505746454737633,0.083235946031459562,-0.18211015197744373,-1.5614192349977998,-1.0865544753224867,-0.050317666931885441,-0.532786902418664,0.012925016415799462,0.11656550584910796,-0.83524786783607752,-0.49774712150477285,0.5512500768267703,-0.12600189182257537,0.28137144509467582,0.12204505965794965,0.24746660812055943,-0.047659387569190415,0.4044860556434493,-0.51106417985416108,-0.098193330083372388,1.4529181801749456,-0.2276746313747271,0.090372070527941162,-1.2553839252903671,0.29044521135126899,0.22335942375792861,-1.0772525997495883,-0.05734052521251698,-0.83301851566540108,0.0045527169108492416,0.35840519309063801,-0.12522491501587751,0.059358323472347152,0.20703852178862725,-0.078615055879692974,-0.73625644243618815,0.50884153329038817,0.10622766034414255,0.022487912549987499,0.002760175013946764,0.2789722155855241,-0.013403327698641831,0.4213483609943669,0.11346939483601304,0.024454203391060858,-0.2435050976271409,1.0773432400946827,0.85107148563237978,0.69914245095596605,1.8716750452670894,-0.21281208947389452,0.17433145531765071,-0.72169732328123004,0.11153177573628703,0.45087865647735725,0.31411015065369341,3.8878245595533105,1.8745256586495831,4.9715461339558349,2.8094789757007383,-0.1039811549417049,-1.1145918842420528,0.55388443016668454,-0.23621361901045823,0.70254819885314035,4.3997211488635894,5.9553137912550156,0.084450285220894372,0.98723096628673268,0.20557198888031891,0.13308624329480345,0.23352443428481884,-0.018415798051140797,-0.95259597052254641,0.0045527169108492416,0.071058393828975497,0.86608807045386271,0.36963301602695076,-0.8623892198382741,0.032359728294769852,-0.68138446476812931,-0.8531841550839232,0.72491964846045853,0.19885286908907673,-1.0066789649046104,-0.47625356711480649,0.41702001443511882,0.54182090801313265,1.0573880815091954,-0.39067134916893842,1.0377065266463195,-0.028845562924031398,0.10730565070947051,-0.70623467150178776,-0.66700694071660216,0.11612284199684808,0.22763034963144335,0.11474202285089241,-1.5301009306288957,0.14270023682719923,0.0082289409114046919,3.1718128516078661,0.42405738007486882,0.40413184078438569,-0.30269927822031839,0.015854397420985933,-0.60815169463838004,0.39175941503525813,0.27612935716386389,1.6488062878963561,-0.11298765696699498,0.058932131049690639,0.058413115300920637,0.77236083622083385,0.018838191277163574,0.018323683655363965,0.29278377068914629,-1.1912141319293248,0.017278963668314162,0.10247240030888882,0.13643847354185645,0.18365573627465004,0.15422178833150113,-0.23409636719935811,-0.58865669627016004,0.12200670612537401,1.0899857866891853,-0.12559790470434784,0.050305396030712046,0.42384807663630042,-0.01438561879883693,-0.75041909627475256,0.21616312179611441,-0.36092351880193441,2.184260303692021,1.1235917558978787,0.67906095353028384,3.0116570271892833,0.74460577241391235,0.072475464524865529,0.94072923790755958,0.96564526264758221,-0.24680492298062084,-0.071243014517028413,-0.64031784092030009,-1.2753243898104767,0.11333123415010604,0.060035118098404894,-0.08712218949435524,0.32049132963258131,0.20489814194471023,0.13100082118391576,-0.10043076227732151,-0.088630803191893648,-0.31622551963193857,-0.18832827558240517,-0.17784431803832135,0.79347465552554652,-0.83287901198389136,-0.60150488703953719,-0.093191432604777802,-0.79697808236050705,-0.0688773663750748,-0.42092295047213213,-0.28092773013720063,-0.10463954124439923,-0.057690271588780817,-0.21267791216752485,-0.28197890437808937,-0.32120070091758102,1.5931180946001682,-0.31901110032232083,-0.4960701807006096,0.46616330720661026,-0.55069761913129511,2.5548775061319464,-0.4477518507941074,-0.78122006946987277,-0.16939973651858686,0.98857321253289676,-0.042071791870800013,0.0045527169108492416,0.83321318874039108,-0.23337139601827772,-0.14770948235621617,0.72039704918320169,0.098820633302647565,0.26347542631999232,0.20039208717003021,-0.74374797176022689,0.31524824585697964,-0.036018324666883927,-0.048242751697751274,-0.087308843574861683,-0.22660716258418212,0.43187199248322372,0.075756928925926559,-0.3982338503216436,0.10435624553195488,-0.18579310132896154,0.091889881945355967,3.1312280449317864,-0.60212050660674521,0.66650004607069313,0.66570036052532977,-0.38790530226827968,-0.50341412319336243,0.074544742417293364,0.6466516571758234,0.42522515219029522,5.2299209450471107,4.392199842721535,-0.38245212943225937,0.13945483784370083,-0.27671585700328905,0.98380457538877231,-0.24633486204500699,-0.54915727046074458,0.61953383123507777,-0.27114638441322292,-0.61297890609423433,0.31458182459503625,-0.39767105927387902,-0.65059478003583138,-2.7112282141156214,-0.088781136842008834,0.37254463138297922,-0.21992403011805983,-0.53834255154986188,0.26563892368816333,-0.22540421650607101,-0.32950425159706498,-0.48028551771175643,0.18936675998892305,0.48133789061279586,-0.020933843757271475,1.2708622307568067,-0.61052420078260106,-0.39419000955700767,-0.29998256237402288,0.39694541183235721,0.65634189301298207,0.40513485782083514,0.35622629271759898,-1.4696684715864947,-0.1389578844844781,0.11229976755269178,0.26268619721356146,0.5751688650408795,0.75773960386925943,0.29838555276566758,1.4824894809921201,1.0257095035174615,1.3001857692644947,-1.596527336704435,0.53109530225224333,0.97102005730875263,-0.044304277824306126,-0.4099590936103823,-0.48548590217352938,-0.43942473179592767,-0.37693200559048634,-0.31286924825807105,0.1487491968231609,1.4294385452635421,-0.010198588432736244,0.098756297898171752,0.023173361971968731,0.22479487864884895,0.8476897517778319,0.4792383018866655,-0.74205641968548264,-0.70136203978201372,-0.22365349356721786,-0.30067997343648756,-1.0370925385220193,-0.95711446011324242,0.39571891637328527,-0.40240291552831664,2.2042615330691984,-0.51736696160133633,0.48186091208636128,0.47647729464627808,0.64831393961893014,-0.51461504919150336,-0.26723084645353445,0.080942355632050322,-0.29237160306422716,0.81457356789728053,1.6306437960754145,1.822071135552159,3.3624998932685699,0.42785093236024707,0.29752745597982511,2.6451927616169311,-0.35827617652734034,0.34750092627016826,0.73102273707019094,0.72803653416081993,-0.19324583272591589,-0.37043799706393976,-0.69246565920897041,1.4202320220356395,-0.35717603134874487,0.98284854862240145,1.9446329296783205,0.53518354352405595,0.30362457256856246,0.088401482961739219,0.061828842298732312,0.17649869802689544,-0.15644473696024974,0.66127391240036104,1.1153922772807743,0.049935260844771179,0.3841013779026401,0.10496462764808001,0.36693833760111616,-0.046091386269827339,0.43573175834526445,3.7988178195718802,3.5559934959669146,-0.028523793235489592,-0.75131780156374894,0.59880875679784396,2.5555584855024787,0.99783156520012106,-0.594684665098411,0.17341481835530637,-0.18191080695775419,0.14713967730573607,0.91741322335722941,-0.39157634461518143,-0.89216296115038496,1.511842704358866,3.792183042663158,-0.54848873567946121,0.906783089898207,0.49002649050216718,-0.1416376285059755,-0.24953716689439887,0.0026482403032730417,-0.66020349801554623,1.7206712300796472,-0.33399821082697301,0.69388758794978322,0.89132050195263091,-0.96250350280832464,0.061747116388438883,2.0194335768605196,0.41926455731779555,2.9707870567774268,0.012434174154245525,3.0426140915381854,2.4628346607279497,-0.44180102408237865,0.86227754304413651,0.44011170908847852,1.5289113879423226,-0.21578945750743372,-0.18738550169303636,0.84674719047436042,3.371166772611101,0.99896307386840633,1.5364150204317255,0.28573322888857255,1.2667832164427217,-0.1318934977539179,1.3143448284272718,-0.17776967058527404,1.2796732440239502,-0.7014695671881217,1.9407835405077698,-0.17439639588526035,-1.6131748741657841,4.4255612863018943,1.0728959243363967,0.69732040445811094,1.347259541624787,0.04749597155334051,2.3900906876399723,0.56312467185571435,1.6245280606739509,0.34125348012633339,3.7250134513008,0.49540988126743102,0.74326079155188651,0.16182076980965832,3.0496078809206644,3.5291900911427661,2.8771435992013323,3.6529703881044,1.6931052987237045,2.5793605766652163,1.5638417976992471,1.7703471630570409,-0.34595527234851708,0.51549631843951893,-0.1731261001938158,0.22958329313050463,1.3524623438759171,0.61784828645530077,-0.068207243556996033,-0.50813396016049062,-0.067019536727702445,-0.076775411447254527,-0.26088064502110875,0.85090413935259335,0.44240969410592079,0.60355167881304972,0.40187722152324135,0.84173448541058882,-1.0588891152064939,0.83316976992193581,-0.10100343307231263,-1.7624581047111896,0.067228893707605764,-0.41376816512821435,0.0090230871513945488,-0.0049264937088882021,0.16114818209962145,0.0045527169108492416,0.76353713846460458,0.28933816472180141,0.92404619215556849,1.1379133894535638,0.17197644108758325,-0.13125455560611599,-0.061850654150417128,0.54757776786361134,1.6333087180039794,1.6458219814541835,-0.12291834376331678,-0.18048948605700943,0.47190905097788516,0.051270399689709478,0.066820218215054794,-0.34123136467208681,-0.58858942649726487,-0.035982996087724928,-0.071575375887848125,-0.075916858594458958,0.21764973271977262,-3.5226813880726269,2.1547763297184019,0.41114674867182366,0.40586208821146919,-0.29439317234701079,0.78298024630828245,0.054559947264879227,1.0682514371585903,-3.5943811395920555,-2.5806962207245334,0.011243408007882039,-3.0041573609940624,-2.0162510145946033,-0.31691178714382673,0.0045527169108492416,0.33720970381868476,-0.36071572744305769,0.38955841279246783,-0.62980680077641971,-1.130678735117689,-2.4819256670658785,0.54737593188932721,0.41156697874339265,-2.8344120270984217,0.51779794677612934,1.9468766990452249,1.4617356785244819,-2.0885990964234917,-0.13813644241662182,4.5400730099819189,2.6875112624506752,4.9923526165049346,-0.22109673734471436,0.35287395813138112,-0.63952571764690802,-0.19054423246583418,-2.5227838418013082,-1.1542621538572835,-0.22775186873127495,0.17905322294291004,-0.25717749211910501,-1.9845679389608009,0.14384948230816264,0.97179200877577188,0.34293088700120933,-1.1728246899332806,-1.4914069472586693,1.9012231967069937,1.2636638359352173,0.59830932463830067,-0.34449757552239291,1.0056117467559655,0.34366597407219679,0.80070652816639587,0.27196580700511674,-0.15078901227420261,1.0276265243092126,1.7037523038512781,-1.9679614328209976,-0.79951968318228239,-2.1106236450205884,-1.1569046520084125,-0.79113403352776857,-0.30313494848177136,0.58766628099697549,0.2389222710367136,-1.566770737127392,-0.87253950859691898,-0.44124927356387467,-1.000663449795228,1.174512172600517,-0.65129485200615278,-0.15819292466315638,0.3969736712463412,-1.7306710983487186,-0.41669211900511627,0.67680228667430065,-0.91932667201516693,-0.77041745442387466,0.4178237235821296,0.42158133557951416,-0.76553642771126285,0.87449223567858425,-1.3791544906042805,-1.4954874130255416,-0.72702714810381153,-0.60877701191197531,-0.12131991566261036,0.46565803755713375,0.093549918684223243,0.26116978648219913,0.71191890633221178,0.050453750588456359,-0.85393497662118278,1.7482450231034665,0.35485647346870053,0.30551706952680036,0.56259065219797222,0.043740476379561244,0.96160404548728984,-3.6985385856392554,0.39025408148668284,-2.9941387334637781,-1.1822349651491635,0.35968056575914709,-0.40157114033571517,1.3453916391683247,0.046058500960844739,0.6361230076728166,1.1862647675757856,-0.34758354130454272,3.3892405587885754,0.3189784772696207,0.0045527169108492416,-0.057181792571171286,0.67379206010686055,0.610730442599273,-0.72119226812385584,-0.71693390103906118,-0.42048227699615026,-0.23776331916496751,0.092547898409172547,-0.14356884404820924,-0.43789371573978109,-0.29774502891348753,0.52562250362648122,1.0047290908440658,1.2946804741217068,0.0003476765935559456,-0.75163039490896644,1.1511620620834879,-0.23478041713252296,-1.4473341554919354,1.0684700301056491,-0.027446710390195861,1.0219180277513438,0.49968734416172289,1.4140333451552518,-0.97577076715111666,0.78697856705965741,-0.54817216793540169,0.33044874072340846,-0.5448983861898089,-0.77969394403105241,0.19732826193041575,5.0326735123972792,0.41775572039158249,0.40955931644539589,-0.70724087352218667,0.25776993370545398,0.34333689127962508,0.32408851855827869,0.3612475336972647,-0.0044118707286564529,-0.32137207654726296,0.54728356779237508,0.056347498757494563,-0.62564994055053624,-0.32613444724994878,0.21179675106818507,0.25073743736834153,1.0296018912064078,0.20768275308040884,2.3720801283722963,0.058596188844155961,0.14598553510645296,0.54129662610016638,-0.071961306936970004,0.33769610116328863,0.23942499742164003,0.89131219866363054,0.5010490512258361,-0.18402901483676537,-0.14773457568786696,0.52236414803983777,-1.5215328824768086,-0.12564057841460397,0.3931003934174182,1.3460989946057129,-0.10545871745574686,-0.24932442191766846,0.3132867392895804,-0.22846264937840743,0.57674391132243308,0.57466346117230316,0.44561228476170101,0.29288920450325406,0.25025291830655938,0.74938448707339766,1.1243039475207759,-1.1138949113513839,0.28395760143514259,0.11470227679481226,-0.62173439255707486,0.1509454966413859,-0.72975300132069876,-0.19906445123614525,0.62148779725933778,1.9190104618729666,-0.49165388316463776,-0.38300826502318408,-0.58159752068762671,-0.48427765245842913,0.33167699892037028,-2.4635486067646255,-0.13051077792790267],"y":[0.22112552799726048,8.8538719643217618,1.1301817920206718,1.4473317838878068,0.089375595110798803,1.7619538968712045,1.0428718023231869,3.1817741063860447,11.452225294612177,2.2350770153501114,12.007446482167865,1.6716203965612624,4.3027706572402824,0.17327747983100789,8.6903698325741008,10.774690718274137,2.4225082001627745,0.097453220686008576,11.653647025549361,9.9469215565165801,0.4762535331884355,2.3819519032879071,2.0819696632151201,0.02090709936167361,1.2975694635544748,1.0443122496864943,2.485452247339714,6.8860566476931631,0.15490195998574319,6.1426675035687319,4.6020599913279625,7.6716203965612619,0.18508681872492605,0.52143350440615666,1.4710832997223453,0.29242982390206362,9.4271283977995193,5.8356471442155629,1.4045037781744258,1.3106911408763797,0.095284454721319037,2.0555173278498313,0.14146280243036088,11.458420756053419,0.41907502432438071,9.4534573365218684,5.681936665037238,5.6675615400843951,5.8416375079047507,2.1034737825104446,2.856985199745905,3.3010299956639813,5.5376020021010435,1.4156687756324693,1.1655792963184675,3.7375489102695707,3.6478174818886377,1.5622494371796121,0.17198493577602311,2.3036436112666681,2.0250280057019312,1.9355420107730816,0.014124642691606345,0.068033885271827368,3.8927900303521317,5.0105501823333078,0.19314197048118256,5,3.4934949675951281,0.030118356253500032,6.4584207560534193,1.5543957967264024,0.25649023527157022,0.047207556955907906,0.24641694110709345,0.68613277963084662,0.29073003902416922,0.2479515521805615,0.99567862621735737,0.052566278112949241,0.17717835469689538,0.05403929642243141,0.096910013008056392,0.011441043121384482,1.2350770153501116,2.9065783148377649,3.7212463990471711,4.52432881167557,6.3458234581220392,0.8477116556169435,0.62525165398989613,0.15614457737683893,0.19517932127883766,2.2620126736665691,0.34775365899667682,0.26201267366656922,1.3545777306509081,2.0609802235513337,1.9913998282380825,8.7328282715969863,2.0163737128754655,0.82681373158772598,1.3798639450262424,0.99567862621735737,0.36151074304536268,3.4522252946121772,7.5654310959658009,6.5833594926617192,4.9665762445130506,6.0390538042661683,3.4801720062242811,0.25884840114821489,0.33818731446273875,3.2426039712069756,6.6861327796308467,1.9136401693252518,10.76447155309245,2.336299074610352,1.8632794328435933,11.928117992693874,15.406713932979542,1.3334820194451191,1.9393021596463884,0.10790539730951958,11.399027104313252,8.4023048140744869,0.95860731484177497,11.313363730737708,13.563837352959244,17.528708288941061,1.095284454721319,2.5100415205751654,1.2716462179787715,12.245651664288982,1.1617807780923741,3.832682665251824,2.1505805862031004,3.9586073148417751,2.7099653886374822,12.336299074610352,5.9625735020593762,0.36051351073141397,0.39040559077477999,2.5185573714976948,1.1771783546968955,1.0376306643299789,1.3882766919926581,0.085656842880559247,4.2757241303992108,2.8013429130455774,0.11407366019856895,5.6497519816658368,5.655607726314889,2.9136401693252516,14.122053048370812,0.47495519296315475,0.075204004202087837,4.3925449767853317,0.8507808873446201,1.2839966563652008,13.76447155309245,1.2083093509798821,0.88272870434423567,0.28567024025476695,3.5622494371796121,3.2269453066357374,1.5951662833800619,1.6968039425795112,0.39577394691552992,1.2240256688706308,1.3946949538588904,2.213958789757446,6.8446639625349386,6.1169066414243103,3.3968556273798178,0.53017798402183702,1.2069083998234198,0.3925449767853314,1.4881166390211256,0.51712641639124624,1.3726341434072673,5.4134126953282449,1.1536628878701947,3.3124710387853655,1.8096683018297086,1.4736607226101559,1.563837352959244,0.31515463835558755,1.9065783148377649,1.4801720062242814,0.083546051450074932,0.74472749489669399,0.46218090492672592,4.4156687756324695,0.12147820449879346,2.1739251972991736,0.85698519974590492,0.24336389175415199,2.4306260903849539,1.0026136156026866,0.91721462968354994,2.7166987712964503,2.4449055514216811,0.23433144524098595,2.0087739243075053,0.62525165398989613,0.8124792791635369,0.89619627904404309,2.3089185078770313,4.5421181032660076,5.5171264163912461,4.924453038607469,8.5734887386354242,3.4259687322722812,4.338187314462739,0.50445566245355156,0.24412514432750865,1.2365720064370627,2.6840296545430822,1.6161846340195687,0.39902710431325172,3.258060922270801,3.9586073148417751,4.1511952989481964,0.017728766960431602,0.65169513695183934,1.4134126953282451,3.1101382787418115,0.10182351650232342,0.41793663708829126,4.3757179041643317,0.21253952548158497,0.94692155651658028,3.6757175447023074,3.9393021596463882,4.4213607900319278,1.1260984021355387,0.35753547975787864,2.5243288116755704,0.23136189875238555,0.17914201056030005,5.070070439915412,1.4190750243243806,2.2692177243336107,1.785156151952302,0.24718356881172862,1.3178549236261683,0.239577516576788,0.85387196432176193,8.7011469235902936,2.9507819773298185,0.54821356447570979,0.088309841246138887,3.2388241868442686,0.25963731050575611,0.790484985457369,1.0136762229492347,0.65560772631488928,2.5867002359187481,1.2139587897574458,2.3851027839668655,5.0958256317158366,10.421360790031928,1.2564902352715703,0.031984286006358213,0.68613277963084662,2.1630432629404495,4.0840727883028842,1.4056074496245732,5.083019952679618,2.8210230527068307,0.76700388960784616,3.5816987086802543,4.4353339357479111,0.076238039171299746,1.4522252946121774,3.8297382846050425,0.5867002359187482,1.2034256667895702,0.059483515067432782,2.1348960253588722,1.4294570601181025,2.1095789811990859,2.5199930570428495,4.2724587429714438,0.90308998699194354,2.8728952016351923,0.39902710431325172,0.0017406615763012701,1.496209316942819,1.7144426909922261,0.29157909986528724,2.5622494371796121,4.8068754016455388,0.71896663275227246,1.7619538968712045,0.089909454405931857,0.94692155651658028,0.97881070093006195,0.78515615195230215,5.9208187539523749,1.596879478824182,3.0056828473303634,0.56066730616973737,1.4134126953282451,2.5030703519267852,1.9746941347352298,1.2204035087421754,1.856985199745905,2.3151546383555877,2.5686362358410126,4.0685421293109947,0.90657831483776496,1.1278437272517072,1.6882461389442456,1.2898826348881838,5,0.790484985457369,1.0132282657337552,0.22694530663573742,0.18243463044021921,0.0048037084028205992,0.80134291304557737,0.11294562194904302,2.5867002359187481,0.46852108295774486,3.8761483590329142,3.3196644865854368,6.9393021596463882,3.3645162531850881,0.4788619162959637,1.0371573187987575,3.2027324591692836,2.1668528880872149,0.18177410638604449,1.496209316942819,0.63638802010785567,0.70114692359029329,1.0675262353228467,0.57839607313016894,2.600326278518962,3.1354889189416082,1.3565473235138126,0.49214412830416909,4.8894102897007512,0.12667939818460122,0.094204119632131461,7.026410376572743,5.6968039425795114,1.3133637307377066,1.2907300390241692,0.52143350440615666,1.3001622741327543,1.9586073148417751,4.089909454405932,1.7304870557820837,1.490797477668897,2.5451551399914898,0.12726117252733121,6.4621809049267256,0.23210238398190938,0.74232142513081545,4.8601209135987631,4.4788619162959638,2.3071530807227698,1.8096683018297086,2.0467236633326955,1.3585258894959005,1.7594507517174003,3.5016894462103996,2.8961962790440432,2.0830199526796176,0.45222529461217748,0.71669877129645043,0.30980391997148632,0.16052195262580163,3.0614802748235079,0.32975414692587596,1.889410289700751,0.12959609472097294,2.3288271572849166,1.8961962790440432,0.89619627904404309,0.24033215531036956,0.28988263488818372,3.8124792791635369,2.6595558851598815,0.24641694110709345,0.27572413039921095,3.4762535331884354,2.6840296545430822,2.4596705252091264,1.4814860601221125,1.5157001606532141,3.8068754016455384,2.6635402661514704,4.0644927341752872,0.056505484093897433,0.22475374025976358,1.1524273408578878,1.274905478918531,0.0048037084028205992,0.8477116556169435,0.44977164694490596,3.2831622767004753,3.7099653886374822,1.27083521030723,3.1481303992702339,0.42365864979420714,2.224025668870631,2.5543957967264026,3.4801720062242811,1.3251388592621884,4.928117992693875,3.0958256317158366,0.80410034759076621,1.058488567365597,0.20342566678957033,3.4921441283041692,4.856985199745905,2.9507819773298185,0.46852108295774486,0.14266750356873156,2.8761483590329142,1.728158393463501,4.2291479883578562,4.5816987086802543,1.7471469690201069,4.2048154103175763,1.2048154103175761,0.15304467498017607,0.095825631715836468,0.074687908500350508,0.18442225167573273,4.6989700043360187,4.1101382787418119,0.051587034221398972,2.4134126953282449,5.1051303432547472,5.4078232426041328,6.0584885673655968,0.72584215073632019,0.52870828894106148,0.83564714421556296,1.0872466963286771,1.109020403010311,5.3306831194338882,2.9586073148417751,0.015022873584506671,0.42712839779951983,1.7594507517174003,7.9355420107730819,3.3840499483435988,0.74472749489669399,0.49894073778224851,0.63451201510910027,2.1402614338028529,0.074687908500350508,4.6968039425795114,2.7746907182741372,1.7399286120149251,0.79317412396815024,0.39685562737981767,0.95860731484177497,2.563837352959244,1.0213630516155257,0.33818731446273875,1.2564902352715703,0.026872146400301365,1.4122890349810886,0.4934949675951279,0.44249279809434211,0.5767541260631921,2.7931741239681505,2.7721132953863266,1.7746907182741372,0.024568191490737076,2.2596373105057563,2.2146701649892329,0.24108810760202651,2.0680338852718272,2.6556077263148894,2.3695721249749759,0.79860287567954846,0.85698519974590492,6.2373214362725635,1.1307682802690238,2.4881166390211256,0.010550182333308195,0.71669877129645043,0.77728352885241669,0.73754891026957059,0.44249279809434211,3.3851027839668655,0.78251605578609373,0.37468754903832613,2.0390538042661683,1.4546928835341759,0.790484985457369,0.69250396208678711,1.021819483062586,1.5497508916806388,1.3477536589966768,4.3840499483435993,0.4934949675951279,0.10017949757290372,0.39577394691552992,0.69250396208678711,0.97061622231479039,2.728158393463501,1.0904439707588247,0.8507808873446201,1.0043648054024501,0.063486257521106718,2.4659738939438651,0.77989191195994489,0.9507819773298184,0.50031291738159622,0.88272870434423567,2.3115801779972895,1.7351821769904636,1.045275209020937,0.83863199776502517,2.4546928835341757,0.21041928783557454,0.50031291738159622,0.86646109162978246,0.66756154008439472,2.7166987712964503,0.88605664769316317,3.8894102897007512,0.80410034759076621,0.40671393297954272,3.3496924768680634,3.6363880201078556,6.6516951369518393,4.056505484093897,1.6020599913279623,1.5287082889410615,0.72353819582675583,0.49485002168009401,0.769551078621726,0.014573525916998339,0.82390874094431876,1.4867823999320611,0.20204035626280387,1.530177984021837,0.40340290437353976,0.20481541031757602,0.58838029403676984,1.4056074496245732,0.61439372640168788,1.4609239012072235,0.85387196432176193,0.80410034759076621,0.2749054789185309,2.4089353929735009,1.853871964321762,0.20830935097988201,2.089909454405932,0.99567862621735737,0.82390874094431876,0.66958622665080914,0.5072396109731625,0.56543109596580121,4.7258421507363204,0.31425826139773638,1.679853713888946,1.679853713888946,5.9355420107730819,6.114073660198569,10.991399828238082,3.9586073148417751,0.60380065290426366,0.24412514432750865,0.37365963262495766,1.5833594926617189,0.33254704711004607,2.2291479883578558,0.14026143380285311,4.4473317838878064,0.69036983257410123,6.8153085691824016,2.9507819773298185,1.630784142589857,0.055024091587952087,5.4749551929631544,2.1432711096171175,0.044312249686494193,0.239577516576788,0.29584948316020088,0.39902710431325172,0.12090412049992724,1.7328282715969863,0.10127481841050648,1.4449055514216809,1.0925886392254138,3.000869458712629,0.21824462534753111,0.078313524516397934,1.7986028756795485,0.62342304294348805,0.34294414714289606,1.7375489102695705,1.1079053973095196,2.1278437272517072,2.0301183562534999,6.2247537402597635,1.6516951369518393,1.6252516539898962,2.1062382379420566,3.530177984021837,2.6946486305533761,0.063486257521106718,1.072116589669293,3.4801720062242811,0.24718356881172862,1.6252516539898962,0.16941133131485567,0.82102305270683062,4.6595558851598815,1.2856702402547671,0.045757490560675115,1.3809066693732572,0.055024091587952087,0.18243463044021921,0.8728952016351923,3.1979107421182671,4.6861327796308467,0.91364016932525183,0.13489602535887207,1.0163737128754655,4.3535962737769305,4.5044556624535517,0.19586056766464957,1.6055483191737838,0.039529222465701036,0.65364702554936138,9.5199930570428499,1.1992829217176149,3.0305840876460186,0.25727486869530169,0.92081875395237522,0.24033215531036956,0.60380065290426366,0.11125903931710739,0.85698519974590492,2.8153085691824011,0.28567024025476695,3.5436339668709569,0.59687947882418213,0.32882715728491674,4.2111248842245832,3.2403321553103694,1.0555173278498313,3.0109953843014634,0.19111413264018789,2.2055119533408303,0.790484985457369,1.4546928835341759,0.26841123481326129,0.22767829327708025,0.6655462488490691,0.19586056766464957,6.6090648928966207,2.5482135644757098,1.8297382846050425,0.28903688100472424,0.03385826726096737,0.8728952016351923,0.049635145623876928,1.8356471442155629,0.57024771999759194,0.088842391260023412,0.52578373592374483,2.5734887386354246,3.1226286541302262,3.0824944904474534,2.2676062401770314,2.4609239012072233,0.51855737149769499,2.4921441283041692,0.49894073778224851,3.5686362358410126,0.92811799269387463,7.5451551399914898,2.8996294548824371,9.2790142558462616,7.8860566476931631,0.44490555142168087,4.3036436112666676,0.59345981956604477,0.6777807052660807,3.3635121036466344,11.718966632752272,10.718966632752272,0.26760624017703144,1.8664610916297826,0.75696195131370558,0.51999305704284937,1.1174754620451195,0.022733787572707352,4.6038006529042637,0.790484985457369,0.3010299956639812,2.5044556624535517,0.52287874528033762,3.4788619162959638,0.17005330405836405,1.6861327796308465,2.9746941347352296,1.1481303992702336,3.3269790928711038,8.5072396109731621,2.3251388592621884,2.1605219526258015,2.9244530386074694,6.0496351456238768,1.5228787452803376,6.6020599913279625,0.28735029837278864,0.43889861635094402,2.2596373105057563,1.9030899869919435,0.20760831050174613,0.55752023093555136,0.33913452199613081,7.5686362358410131,0.31069114087637978,0.016824927962187056,7.5934598195660445,4.8096683018297082,0.33348201944511913,1.4485500020271249,0.33161408330999981,2.140861702705469,0.42250820016277468,0.75202673363819339,3.0915149811213505,0.21041928783557454,0.15552282425431863,0.11013827874181155,4.2027324591692832,0.33254704711004607,0.24565166428898116,2.2541448048262711,6.1811145854059903,0.27572413039921095,0.42712839779951983,0.2062096153091813,0.45469288353417592,0.41907502432438071,0.82681373158772598,6.3053948010664316,0.29584948316020088,2.7772835288524167,0.15428198203334137,0.094743951251548705,1.8507808873446201,0.025949097207122653,1.3106911408763797,0.769551078621726,0.5900668766687055,11.522878745280337,9.0726296369609774,1.1811145854059901,4.105683937315562,2.7235381958267557,0.12147820449879346,6.0338582672609675,7.8013429130455778,1.2620126736665693,0.15242734085788781,1.5376020021010439,2.4225082001627745,0.45099673797421219,0.21183162885883233,0.30803489723263966,0.65560772631488928,1.1797985405143596,0.60906489289662091,0.27245874297144357,0.26440110030182007,1.6882461389442456,0.98716277529482777,0.68824613894424569,0.90657831483776496,3.6989700043360187,2.2518119729937998,0.17069622716897506,3.1630432629404495,0.090443970758824668,1.238072161579471,0.76195389687120463,0.35359627377693043,0.14387555575769967,0.56703070912559428,2.5883802940367699,1.7594507517174003,7.0846001647877301,0.22475374025976358,2.4078232426041333,2.0159229660971691,0.41566877563246918,8.1778319206319825,0.43179827593300502,0.75202673363819339,0.23284413391781958,7.2262135550188065,0.11238269966426384,0.790484985457369,5.8961962790440428,2.8297382846050425,1.5243288116755704,2.0520763801682738,0.099632871343529689,0.13253251214094852,1.114638779968488,1.07727454200674,0.92811799269387463,0.11238269966426384,0.16685288808721482,0.44369749923271273,0.790484985457369,0.24108810760202651,0.40893539297350079,2.9030899869919438,0.11747546204511952,1.1864190114318081,0.65955588515988162,4.8356471442155629,3.8996294548824371,2.4400933749638876,1.9788107009300619,1.3160528692484879,1.5391021572434522,0.056011124926228104,2.540607512240769,0.53461714855158171,8.8153085691824007,20.248720896016657,0.57186520597121115,0.20971483596675833,1.0920514783877278,3.4134126953282449,1.6736641390712486,2.5482135644757098,2.4045037781744258,0.33724216831842591,2.3251388592621884,1.2118316288588322,2.6757175447023074,3.0867160982395814,6.6497519816658368,0.23136189875238555,0.76195389687120463,1.1186153432294272,1.9507819773298183,0.21896306137886817,3.040005161671584,1.1456939581989194,2.0132282657337552,0.25414480482627105,0.58838029403676984,0.019996628416253676,3.5670307091255942,2.4259687322722812,3.7695510786217259,3.3777859770337049,1.8181564120552274,4.496209316942819,1.2628073572952627,0.95860731484177497,4.7772835288524167,0.77989191195994489,0.66154350639539516,0.28819277095880896,0.7471469690201068,3.2464169411070936,0.45099673797421219,4.1586405295451447,5.573488738635425,4.991399828238082,9.5606673061697371,2.5867002359187481,2.326058001365912,0.10679324694015198,0.89279003035213167,1.7189666327522726,2.6289321377282637,2.2055119533408303,2.1713401034646802,0.14387555575769967,6.804100347590766,0.028260409112221711,0.42250820016277468,0.038104526332149599,0.35261702988538018,2.3151546383555877,1.6143937264016879,2.7495799976911059,1.6038006529042637,0.80134291304557737,1.8446639625349381,2.9829666607012197,3.7495799976911059,1.0083309926200514,2.3851027839668655,7.1985962899826452,0.78781239559604221,1.4388986163509441,3.4473317838878068,3.5900668766687054,3.2247537402597635,0.44733178388780681,0.33348201944511913,2.5686362358410126,1.4801720062242814,9.3655227298392685,11.593459819566045,9.669586226650809,0.75202673363819339,0.25727486869530169,7.7281583934635014,0.83564714421556296,1.2027324591692836,8.4449055514216802,3.0310503190186573,0.46597389394386496,0.68193666503723849,3.6270879970298933,8.8601209135987631,1.3990271043132518,6.0736575533743453,8.2765443279648139,4.5016894462103991,6.7423214251308154,0.29843201494407262,0.087246696328677029,0.86327943284359321,0.79317412396815024,1.8239087409443189,2.0390538042661683,0.16749108729376366,0.98716277529482777,0.50445566245355156,0.28483264215154214,0.085656842880559247,1.3288271572849168,13.057991946977687,15.257274868695301,0.019996628416253676,0.50863830616572736,1.1850868187249262,4.7189666327522728,2.7495799976911059,2.1106982974936899,0.84163750790475034,0.56383735295924398,0.10734896612269966,6.8632794328435933,2.0920514783877278,1.6968039425795112,7.7471469690201067,14.954677021213342,1.9746941347352298,5.52432881167557,3.3353580244438743,0.39361863488939502,0.23807216157947098,0.0048037084028205992,2.7166987712964503,10.2958494831602,1.090979145788844,2.0409586076789066,3.1617807780923743,3.9100948885606019,0.069560405233299899,8.6882461389442458,0.49079747766889709,8.0609802235513328,0.0083309926200514969,11.221125527997261,5.2823294969977379,0.82681373158772598,2.1917890270757781,0.33441900898204685,7.0762380391713,0.6655462488490691,0.14026143380285311,4.9430951486635273,10.087246696328677,4.8181564120552274,6.4294570601181027,0.29929628285498067,3.6345120151091002,0.28735029837278864,2.8041003475907664,0.58004425151024208,5.2848326421515424,3.3635121036466344,9.0496351456238777,0.54668165995296236,4.8096683018297082,13.659555885159882,2.111820506081675,2.6038006529042637,3.596879478824182,0.087777943467584538,11.59176003468815,0.52143350440615666,3.9956786262173574,1.8210230527068305,10.555955204081924,0.82681373158772598,0.78251605578609373,0.13076828026902382,10.665546248849068,8.66354026615147,6.991399828238082,8.6073030467403342,4.6038006529042637,2.6575773191777938,4.8696662315049943,8.0639892042847912,1.1752235375244544,0.26201267366656922,1.176525770829699,1.0540392964224314,4.9507819773298181,1.5654310959658013,0.18111458540599013,3.6126101736612708,0.066006836168757702,0.55595520408192367,1.1617807780923741,5.924453038607469,1.4145392704914994,4.2125395254815849,1.8601209135987635,5.52432881167557,6.0141246426916064,1.0296531237699067,0.22988470521289839,7.5391021572434518,0.21467016498923297,1.6903698325741012,0.015022873584506671,0.0056828473303632727,0.39469495385889053,0.790484985457369,3.8210230527068307,1.2306226739238615,2.692503962086787,3.6234230429434882,0.13548891894160814,0.66354026615147055,0.29328221766324125,1.7189666327522726,8.025949097207123,7.4436974992327132,0.35261702988538018,0.36653154442041347,1.2254830342714504,0.15304467498017607,0.25649023527157022,0.59516628338006194,1.6252516539898962,0.72584215073632019,0.079354998593212434,0.6777807052660807,0.94692155651658028,8.7399286120149249,9.3695721249749759,0.44009337496388751,0.58004425151024208,0.58169870868025453,0.89279003035213167,0.086186147616283335,3.5100415205751654,10.032452023781138,10.009217308196861,0.0056828473303632727,8.0830199526796171,6.3575354797578782,0.77989191195994489,0.790484985457369,1.8827287043442358,1.9136401693252518,1.2781893847874535,5.6179829574251317,9.4485500020271243,8.8996294548824366,1.728158393463501,1.1999706407558657,11.747146969020108,0.4145392704914993,10.436518914605589,7.7121982700697744,8.0550240915879527,0.32330639037513342,8.8961962790440428,13.081445469449726,14.525783735923746,0.18708664335714442,1.0762380391712998,0.69036983257410123,0.21896306137886817,9.481486060122112,5.0362121726544444,0.5900668766687055,0.97881070093006195,1.0096611452123985,6.4948500216800937,1.1687703061329366,7.1951793212788377,0.27002571430044436,8.6216020990518629,1.5590909179347823,7.1662156253435212,4.2612194415156308,1.5497508916806388,8.9172146296835493,0.85387196432176193,0.22475374025976358,3.1726307269461747,0.92081875395237522,0.33724216831842591,1.5497508916806388,2.4078232426041333,15.089375595110798,13.718966632752272,8.0092173081968614,9.8696662315049934,4.8632794328435933,1.2013493545547311,2.7212463990471711,0.93554201077308152,9.1524273408578871,4.7144426909922261,1.1112590393171073,6.6090648928966207,1.0819696632151199,1.8927900303521317,0.72353819582675583,1.1426675035687315,8.5968794788241816,2.630784142589857,1.5606673061697374,2.7471469690201067,3.3716110699496884,3.3124710387853655,0.82973828460504262,4.9430951486635273,3.9746941347352296,9.0021769192542749,8.681936665037238,4.7423214251308154,4.092588639225414,0.52287874528033762,0.8728952016351923,0.31425826139773638,0.60730304674033431,2.090979145788844,0.12551818230053352,2.7055337738384071,7.7495799976911064,1.1378686206869628,0.73282827159698616,1.7328282715969863,0.094204119632131461,3.224025668870631,10.285670240254767,0.49620931694281889,7.9665762445130506,7.163675884293248,0.99139982823808248,1.5559552040819238,4.1079053973095192,0.076238039171299746,2.3736596326249577,3.7825160557860937,0.95467702121334252,9.5968794788241816,0.43533393574791068,0.790484985457369,0.18842499412940666,1.6925039620867872,1.114073660198569,1.4571745730408201,2.3419886033428874,1.1180450286603996,0.38090666937325729,0.18508681872492605,0.29929628285498067,1.1958605676646494,0.38721614328026455,3.0329202658555028,2.9244530386074694,7.9956786262173578,0.00043451177401769168,2.9469215565165805,5.3872161432802645,0.51144928349955576,11.549750891680638,3.1396619934290064,0.066512712151294562,4.0515870342213987,1.9136401693252518,7.9208187539523749,8.2204035087421747,2.8538719643217618,1.7471469690201069,1.095284454721319,2.2765443279648143,4.6989700043360187,0.77469071827413716,9.5376020021010444,4.5622494371796121,3.9208187539523753,4.0952844547213187,1.6556077263148892,2.0506099933550872,2.7055337738384071,3.0181813928293364,0.0096611452123985687,0.68613277963084662,0.37468754903832613,0.07779372256098363,1.2139587897574458,0.86966623150499389,0.77211329538632645,0.22988470521289839,0.99139982823808248,0.26121944151563081,2.2588484011482151,0.047691990337874794,0.075204004202087837,0.31158017799728938,0.042392712939904729,0.15989390554324223,0.1106982974936897,0.64975198166583714,0.23210238398190938,0.079876673709276078,0.58502665202918203,0.29499204066666401,5.1163385648463828,0.48678239993206096,1.9208187539523751,5.3819519032879075,0.15614457737683893,0.5072396109731625,0.59176003468815042,0.095825631715836468,0.41116827440579273,0.25570701687732372,0.21183162885883233,0.22402566887063094,0.44855000202712486,0.61978875828839397,5.8153085691824016,3.4248121550723392,0.29157909986528724,0.20551195334083039,2.4723700991286615,0.11861534322942717,1.5128616245228135,0.13667713987954411,0.50445566245355156,7.4377071355435254,1.0087739243075051,0.82973828460504262,1.3746875490383261,1.1555228242543185,1.0114410431213845,7.3840499483435993,0.15490195998574319],"text":["1002.10960987762_3.3183331","1004.54196498357_5.227879","1007.25951783638_4.1707163","1007.50948380929_4.171711","1010.45291876275_6.0610256","1010.70334814845_6.06043","1014.364945103_2.9326644","1020.53627483962_4.4623117","1024.65587328443_5.152619","1024.95850270142_6.0516896","1025.38424755014_4.2881155","1030.52095057116_4.326651","1032.53626005789_4.561846","1033.52548206636_4.1262217","1034.55552730134_5.1120253","1035.20999937842_5.1151323","1035.53803422953_5.1342006","1035.58278295896_4.5551424","1036.08833557279_5.1137934","1036.20811027474_5.112846","104.059264569687_0.6302757","104.070845078818_0.6292385","104.107425371357_0.5997596","104.124821538078_0.6135892","1042.71805848751_6.0093784","1048.53125071698_3.9029436","1050.54519856612_3.7529614","1050.54822978048_4.3713474","1061.53758211582_4.232515","1063.55359737151_5.102087","1064.56173571534_4.5294437","1064.56256345352_5.062037","1065.54914243348_5.0918326","1066.54226450459_4.037623","1070.55251983682_5.1009955","1075.5288865694_5.1827555","1076.5443098022_5.0173903","1078.54178280109_4.6522307","108.961945754774_0.52226293","1081.30194612454_3.8349085","1086.51656175831_5.090658","1087.56019226313_5.099809","1089.54358431136_5.4752946","1090.54216049957_4.628391","1091.55959458988_5.564287","1093.05922614098_5.0877805","1093.23781716117_6.180354","1093.29917264833_6.1754456","1093.55046637555_6.176837","1098.48140302339_6.17624","1098.73180148994_6.178696","1098.98191963008_6.178225","1099.54970934834_5.0868053","110.009108080217_0.52003735","1102.47285624063_6.1768355","1102.72360192802_6.17763","1102.97384022474_6.1770353","1103.22385191993_6.1756425","1103.52409993786_5.057157","1104.22549929508_6.1782255","1105.21691094873_6.17624","1105.46636282562_6.178027","1105.53794155597_6.178225","1105.54013037867_5.0856733","1106.46608846064_6.1772337","1106.53751166266_4.4966908","1106.542819966_5.524711","1106.71636991358_6.176238","1106.96727089235_6.177034","1107.49231441596_6.2382135","1108.55364750803_4.5751567","111.007803224591_1.1192559","1111.96094361679_6.179617","1112.21108007327_6.1790204","1112.4614512125_6.1792197","1112.73613516603_6.2394066","1112.98668593084_6.2402015","1113.4871655995_6.2384133","1116.20347246871_6.176239","1116.72770173484_6.236626","1116.97827734174_6.2402015","1117.22831769173_6.2382145","1119.46661509977_5.0893717","1119.47186422956_6.23762","1119.72109969339_6.239606","1119.94617128667_6.1782255","112.050529756137_2.2533631","112.050582030237_0.71044403","112.086888085517_0.5327405","1120.19635748028_6.1798162","1120.72107184965_6.239405","1121.471816731_6.239008","1126.46577085801_6.240996","113.034576214103_1.5815856","1133.49885270921_6.128963","1133.74942089071_6.1315446","1133.74955118356_5.9490604","1135.7629084545_6.196102","1138.56280620729_4.2442145","1138.56283592827_4.5159597","114.037915180084_1.577215","114.987503209513_0.52144504","1149.24278131145_6.199478","115.038980056501_2.3986132","115.056594575498_2.3734224","116.070721366157_0.70451075","1164.0340835672_6.3254185","1169.27807629203_6.3270073","1169.77958207004_6.324624","1173.52006143208_6.3266115","118.08632061476_0.9366337","1181.59404198252_5.281263","1182.58828124813_4.621011","119.016153594211_0.7097321","1192.5445672173_6.3419075","120.065570036653_0.61459327","1208.56868152163_3.792631","121.064414203714_1.7913388","1210.58368836768_4.0201635","1210.58400966928_3.4885986","1212.5995506509_4.1152945","1217.59136825534_6.1657095","122.09644076751_2.8501673","122.919636614785_0.5671052","1228.59491949469_3.8650029","1228.59535506144_3.6373556","123.055299484864_0.70484966","1240.59421196927_4.32268","1268.59007971284_4.1923685","1270.60700514352_4.260901","128.019315993083_0.5188364","129.018417804627_1.1243048","129.021378893684_0.52388287","1292.58739446697_3.870564","130.021660184719_1.1251011","130.050100914616_1.2840797","130.050280422605_0.61607695","130.085559682816_0.545067","130.086345981562_0.980759","1300.61575330522_4.2100472","1309.5661765845_4.575434","131.117930458033_0.71151936","132.1019296846_1.2230818","132.102313005933_1.7501794","1324.80605814051_3.4783397","1329.63010103805_4.9732404","1329.82412689939_4.2080574","1335.47559828887_3.3165443","134.044785115529_1.1221993","134.044906761727_0.6012433","1342.80145176276_3.3190126","1346.19517310368_5.385562","1346.52905170636_5.3842206","136.061806032502_0.7260182","1365.53761159437_5.1514273","137.059749482996_1.1501302","138.055501454422_0.67077035","1395.53510258752_5.0182495","142.065130018016_2.347164","143.034447819593_2.469724","1432.65843333566_4.1609845","144.081046072779_3.2843747","1458.72118632129_6.178623","146.117590231148_2.7758389","1469.62811773357_6.175841","1469.96216882122_6.1760397","147.028890164915_1.1250994","147.054544852541_1.1256945","147.065098883515_0.679142","147.076517135445_1.1078179","147.077120604255_0.6086585","1473.28976352279_6.1768355","1474.95170879287_6.1764402","1475.28560948065_6.177034","1475.62001398422_6.1774316","1476.72904894934_6.2398043","148.042700285058_1.0796087","148.060537815741_1.1171542","148.061209408145_0.63665396","148.087658174229_0.6322054","1482.27836140101_6.1778283","1482.61250860892_6.1758432","1482.94611577609_6.1770353","1483.279902256_6.179415","1487.93659367186_6.178027","1488.27139465591_6.1806087","1488.60779664124_6.17763","1488.63401670369_6.240201","1488.94477929203_6.178225","1489.27915335448_6.1768355","1489.30165729896_6.236825","1489.6139535383_6.1790214","1489.63262396687_6.224906","149.074466231316_3.2652116","1490.6330159184_6.213783","1492.92547416177_6.177034","1493.25913481696_6.1780267","1494.95940900421_6.2370234","150.058523191226_1.0655062","151.061463436118_2.2830036","153.032826515381_0.5184004","157.013230695687_1.1252983","157.03956315125_1.1251017","157.060762966191_0.6998004","160.075881617831_2.3447804","160.083537141446_2.3493497","160.096909814532_0.63484275","162.075773201933_1.2620181","163.038993641679_4.335789","163.038998548773_4.581708","163.039052467794_3.2281482","163.047835033395_3.228149","165.05462976107_2.8772357","166.072018162205_1.6572696","166.087210672427_2.5390656","166.116297975965_2.5470376","167.070383390408_4.352781","168.088041177324_2.2839956","169.133127265593_2.489564","170.066281728326_0.52003735","170.081242429204_1.3630425","171.137989723578_4.086178","175.023770735038_0.81183606","175.023882166817_1.126293","175.032406572551_1.1294698","175.107751487114_1.2637546","176.010922741139_0.6757644","176.027162453549_1.1256977","176.055365954047_1.4677628","176.091656312399_0.5944512","176.091766308528_1.7889699","176.103003371189_0.63906544","177.054674020564_3.5054564","180.087799935828_2.6432436","181.049525333414_3.1828578","181.049834750529_2.826691","182.081361062316_1.5244584","182.089540918942_1.522589","184.060482675504_2.3081403","184.073440299069_0.6098142","185.032420315497_0.59551233","187.123012913143_3.9446592","188.055399382533_1.6523025","189.123404553853_2.4184778","189.123411809507_0.989623","189.123449341918_1.1815163","189.127406564465_4.0574884","189.127562792485_3.6993418","189.134681076971_0.629877","191.102705350765_0.68291515","192.055630860064_0.670798","192.112222215503_2.4533324","193.043465289578_1.1266893","193.134163631169_2.9643729","195.064969547932_3.059298","195.065194745835_3.516381","198.940035782227_0.52541333","202.970807186115_0.51982933","203.117961741715_2.4856193","203.139071376656_2.7573633","203.139074603428_2.3932514","203.150364725932_0.703177","204.086746393406_0.68887496","205.09752481593_2.9962618","205.106042238235_3.000703","205.118326466636_0.70582","207.137977827918_4.056892","207.137986128065_4.192567","207.137994487637_3.71026","207.149227997936_3.185639","209.11730539783_3.4494393","209.129074912558_2.4161446","209.153615490251_4.136041","210.06131668532_1.1272856","210.069529482763_1.1157647","210.160116536358_3.5362437","211.064347777372_1.1258941","212.008063056802_1.1320528","212.10255625913_1.0788156","212.509743765725_1.1296695","214.059043783935_0.6447758","214.180193259256_4.2144175","215.016478027279_1.1272852","215.024909870814_1.1284773","217.154709713247_3.4599657","217.154762166289_2.4645627","218.102390892261_4.0740647","219.027136551574_0.65074444","219.035496595959_0.65212506","219.133973455722_1.5225896","219.134019249512_1.0069044","219.149329825659_3.9774356","220.117048641711_0.70456666","220.118036760173_2.7088947","222.942483753903_0.52181506","223.024003042555_0.55121434","223.060271482678_0.6539131","223.999100370436_0.52169186","225.021232670833_0.5492274","227.07910887785_2.996132","227.102690054227_2.5885174","227.127719241312_3.5936232","227.139071717043_2.6673784","228.107795808549_0.6429228","229.032006849884_2.4657555","230.175078681092_3.6675506","230.990382964077_1.1209276","231.000213842452_1.121327","231.170360966652_3.1780887","231.170361221031_2.977658","232.190760363603_3.8425555","232.190775544041_3.5644536","233.005948887601_0.6408027","233.113256282031_1.101264","233.149626581702_1.8624678","233.149659939758_2.2395","235.144113775186_2.9472675","236.200891807883_6.022641","239.13906898984_2.6087787","240.159457402078_3.8739421","240.170750764306_3.1774924","240.180770931498_3.1780896","240.953045182911_0.52122015","241.004387079031_0.51923287","241.154704702059_2.2585704","241.15868646032_7.240054","244.103309007362_0.7115197","244.103442010046_0.9759605","244.117953612934_3.2474165","244.186856320866_0.59551156","245.0178700297_0.5200262","245.186058369785_3.7388623","246.181476418352_0.64318615","247.128885816708_1.957818","247.129019533854_1.1505281","247.132737351948_5.4084015","248.149337654709_2.7239914","249.037357755439_0.6503377","249.047185535029_0.65133023","249.126569637481_2.645924","250.0380509486_1.1018592","251.069694398395_1.0913298","251.139146260835_2.6918125","251.14951791322_2.6920114","252.170482034482_2.9429858","253.070736226914_0.65431106","253.154625236986_2.4856195","254.186500429163_3.015402","254.19648935992_3.0191767","256.081705354062_0.9580376","256.081743685307_0.71169686","256.129234370845_1.4032037","257.099239144158_2.4345903","257.18599251545_3.3564723","258.108512203345_1.3948606","258.108540094844_2.2549956","258.110040513346_0.63186306","258.144735413397_2.3100188","259.081231310408_0.6636468","260.053184204638_0.66126305","260.160483727626_2.709888","260.160506299823_2.0501907","260.196864462938_2.279031","260.222080012835_5.6413207","261.144496577564_2.8115926","261.144541607884_2.3479595","263.142147222167_3.448446","265.015666051808_0.51903534","265.085227032649_1.1368202","265.143497945273_3.125648","265.154657822565_3.152096","265.154682147518_3.4994972","266.123478960814_0.65389735","266.159791764325_0.63186383","266.162732512318_2.8844962","266.186275076171_4.0394115","267.058776738125_1.583571","267.170255525107_2.9184618","268.105166673735_2.2694929","268.141393261401_2.2669137","268.2024183764_4.6057467","268.211962699852_4.590251","268.9480392452_0.51962936","269.09563556301_2.636192","269.117939630513_2.268947","269.172408892481_4.479012","270.18125304418_2.3728843","270.945637660252_0.5190345","271.081075531743_0.65490675","272.269655944889_4.233488","273.075755591289_3.9692624","273.075959445715_5.8499703","273.086600539382_5.8528485","273.221272133518_5.099118","274.187390207433_0.7101293","274.20129320866_3.1508775","274.212495708315_2.5257456","275.10285870017_0.6733818","275.1100674461_2.3797424","275.136206364098_0.653913","275.196480764785_2.6191077","275.200543321724_5.9541545","276.119013661769_0.695827","276.180577525138_3.6212652","279.047754968361_0.6465638","279.118770096866_0.6501389","279.170337354161_4.0990057","281.149562121312_2.6620164","282.048716498383_0.7190674","282.087385971491_0.6696064","282.112506770323_4.1798534","282.118630962657_0.654111","282.119481126699_2.3841128","282.119728254127_1.3245409","282.119748510556_1.0641154","282.21755534853_5.0840845","282.588667626943_0.67020196","283.544331826478_0.9890262","284.046528919322_0.51883566","284.079892189358_0.6672234","284.09950268314_2.292376","284.108803950139_2.2919862","284.128155152465_5.06005","284.197215014353_2.827486","284.207232712751_2.8237104","286.092227443391_0.7021838","287.055021619346_4.002264","287.110161615452_3.5487607","288.20299031992_2.3263083","289.070619827583_5.340534","291.118767421884_0.62530786","293.027084710051_0.62789166","293.149678736606_3.06983","293.160823251693_3.0573149","295.128890868719_3.3238935","295.164601782148_3.071221","295.165209739442_3.2281482","295.16523827181_3.4009678","296.196812793616_4.2382545","296.269534930145_4.9929085","296.269551658586_4.453585","296.942930405526_0.51843804","297.088095566769_0.67232484","297.144477586987_2.6189096","298.096881984704_2.926366","298.107353884127_3.8926604","298.11456542297_2.4256291","298.114623597233_2.0033083","298.149697479953_2.433775","298.176144809552_2.79451","298.212518471225_3.2835689","298.285170014478_4.9102693","298.993002343146_0.6082246","299.085202453917_2.3988109","300.122814868277_4.6337385","300.191813675979_2.2907517","301.296174094289_2.2891612","302.134748338186_0.6539135","302.218621847967_2.5863328","302.232517106946_4.6854024","303.049967907958_3.799251","303.089668794954_4.532249","303.141472124568_3.4834068","304.150457720113_0.5980948","304.24822112951_4.152838","305.208853310391_7.229422","307.042620137596_0.6884782","307.083553146826_2.0382717","307.165176002619_3.4374437","307.176380476385_3.2307308","307.176532215947_3.4794333","308.021615525031_1.1264899","308.083304246624_2.0388687","308.091741376643_1.0966933","308.101542567913_1.0913302","309.129435738036_0.6278909","309.14438896052_2.8137517","311.123657323199_2.1364849","311.221642105401_6.913006","311.221674366055_6.3208504","312.123082847553_4.353469","312.130307256943_2.6443357","312.165210685165_3.4103055","312.166642234517_0.675962","312.228141472998_3.7682643","312.300960129956_4.9501033","313.089477669772_2.8100047","313.154889674888_4.2593937","313.175770208057_1.7973133","314.138740148774_5.1996965","315.105061524741_2.609176","316.117961637875_4.2388453","316.223013763099_4.019349","316.673899136544_2.5665824","317.120250164803_3.6733015","318.181179175538_4.192369","319.151381661198_3.139752","320.243069118867_3.4601657","321.056769117968_0.5305713","321.058301500761_0.8932786","321.092868082326_1.1252989","321.192066299961_3.6087513","322.035859501799_0.6503377","322.187294026037_2.282606","323.073903620463_0.6934438","323.160038133698_3.26907","324.050006542865_1.0541836","324.059019024688_0.7055603","325.057665089329_4.0219316","325.090077282731_3.4375203","325.091821194567_2.923429","325.139387750766_3.4953253","327.19141828383_2.34796","329.155508969989_3.715425","329.327450101498_3.1055858","330.133611061198_4.3483415","330.13434913205_4.7795906","330.134545475703_3.7448237","330.238617173324_3.8840294","331.172712369895_3.7621064","332.134005675483_1.8217479","332.134188132301_1.290343","333.115989340114_2.635345","335.064029106572_0.70496434","336.191683845003_3.5654464","336.922835077399_0.52082187","337.061867251269_0.7864095","337.187063379205_3.5277038","339.107425233401_3.6091473","339.155084550302_2.245658","340.152531764563_4.5103965","340.159573709623_3.6609967","342.133967823097_4.4762745","342.134101835458_4.665676","342.134999131718_5.068195","342.140530641401_2.4278147","343.136249856002_3.3143597","343.172690081225_4.7386417","344.091056905611_1.3585105","344.133985533611_1.0710684","344.134129031655_3.338195","344.14917216575_5.3252397","344.167942778564_3.732507","345.224552260693_1.048065","346.046889735281_1.0655062","346.110833455456_1.4361795","346.149684276117_3.1528633","346.258724788672_6.0896287","347.094882213519_2.493566","347.131236803541_3.3475337","348.070780099458_0.73793954","348.071043640023_0.98783493","348.08137286914_0.9914117","349.086076308262_0.98862946","349.089386920903_3.3370044","349.092079702846_2.613347","349.135398289332_1.1102021","349.198531115816_7.0759134","350.171013635595_2.3521316","351.068920400983_0.7029778","351.10501194923_3.155643","351.214112220277_6.158123","351.214143888661_6.483541","353.22978627075_6.9258733","353.229803010167_6.449772","353.327445840928_3.734493","354.108509018133_0.69245005","354.175874669268_4.48656","354.933433345444_0.520821","355.114850914207_3.221393","355.172688217767_4.922387","355.172697503071_4.093444","355.342781052989_3.7643745","356.156261017776_2.310218","356.930529607227_0.5210202","357.115583431516_3.3940153","357.212950001343_2.6331213","357.213242518147_2.812844","357.249626180696_0.70595676","358.233535039294_5.0876594","359.10362953979_2.6699617","359.131208872315_4.4881496","359.131269920733_3.5596852","359.167616318275_3.1240604","360.150082557464_0.6904211","362.015003254636_0.7057595","362.144526078135_3.445069","362.144549116829_3.2488077","362.144575025064_3.1016138","362.180925204213_3.5872977","362.289974007738_7.350227","364.064455195942_0.71900773","364.065328995149_1.0390844","364.196548294922_2.4091425","365.085460265648_2.850527","366.177046891906_3.3479314","367.099956787368_3.2466228","367.136352686092_3.220599","368.155096933691_4.243818","368.191363316256_5.0830913","369.152467823049_4.2028966","369.249574576615_0.7083408","370.153053852588_2.565077","370.153059632449_2.3513372","370.170753337319_3.3570688","370.171531752881_2.5678577","371.167567288662_4.042591","371.203851222227_5.1704965","372.213045815746_3.3300517","372.225464359099_3.3332305","373.183227599981_3.4120934","373.183231738041_4.4438524","373.183249285893_3.560282","373.575935758603_0.985848","374.142228859105_2.4375482","374.144507132573_4.2122335","374.196790740142_4.4891424","374.239760530097_0.71198505","375.126158092851_3.3598487","375.126200393553_2.8123872","376.160241300727_3.3187292","376.999097365401_1.2780566","377.230040859179_4.469674","379.099892337128_3.5219433","380.148485976094_2.581366","381.079823766127_0.69423777","381.091455392748_0.687881","381.115572874802_3.3217092","383.131132531385_4.1862106","383.167577411865_4.0521245","385.146805550397_3.8636127","385.146865910629_4.3459206","385.183313255763_4.389623","385.258241257637_6.4443846","386.026233426149_0.7393312","386.228172777004_3.996163","387.271282991788_2.330479","387.27523063519_3.278007","388.160134563264_4.6907663","388.175347719449_5.5844736","388.1941277881_2.7607398","388.194159999876_3.140149","389.14174217451_3.9905438","389.239446066495_3.312176","391.027410008605_0.67953897","391.099973826939_3.358857","391.151233520427_3.2020988","392.191252559871_3.5892832","393.188261653741_4.740231","394.095326056325_3.9514406","394.164058295436_2.7369034","394.164189217323_2.9808373","394.207078530317_5.6001663","395.066890035868_0.81302696","398.905899450925_0.52340436","399.0897394097_3.4327517","399.14461536251_0.6477556","399.162493170299_4.227926","399.246808492192_4.5366135","400.217595360782_3.723768","400.244570698216_4.651237","400.256504945391_4.6511226","401.141648580335_2.4049695","403.218553389264_3.1725283","404.15274625999_2.7100863","405.172992523945_3.7225764","407.030669186116_1.122121","408.032827440097_1.1181456","409.02012693542_1.1489394","409.038002186071_0.6114034","409.110474909877_3.2204","409.183182104617_4.050338","409.183262899896_3.7092674","409.220210397108_3.5191622","410.159228969411_2.2967103","412.214879276515_5.1825194","412.216648344728_4.8896117","412.217497841304_4.003658","412.320843932061_6.4825077","413.141400718824_3.047781","413.178097621389_3.7126453","413.178149807219_3.7923002","413.304818719377_6.286017","414.173334606685_3.3387916","414.233162666759_4.280765","414.336469174079_5.704641","414.336477130827_7.010889","414.336477817697_6.420249","414.349878147519_5.0137672","415.193672749791_4.2531543","415.23007497056_4.9744315","415.320457920738_5.140702","416.225353097725_3.479633","416.2393891293_2.8896604","416.352127978318_5.934502","416.352288873152_6.600741","418.168423474249_3.0785682","418.262242051523_6.332178","419.188489887331_4.2744083","420.186442469597_3.5084367","420.199977334525_3.509627","421.182362118897_4.4283586","421.185033854835_5.111299","421.259892834676_4.621516","422.908150737198_0.5198278","423.20047041049_3.8909388","423.212089982434_4.144693","423.285185114523_3.2875428","425.157104598248_3.7096648","425.178092513043_4.7920785","425.251069926788_6.46424","426.194088284289_5.2769675","427.016960872658_0.8187885","427.095080247212_0.69999886","427.154754694626_3.598619","427.157271951894_3.921616","427.157428314601_3.1365733","427.157467019231_2.9577947","427.20731131499_2.6006331","428.153607185939_3.2285461","428.977886297432_1.138609","429.172591667555_3.1262448","429.209385601943_3.5269094","429.209388758287_4.078943","429.222945204189_2.353323","430.255164278551_4.337453","430.267765018669_4.338383","431.115872755097_2.4977367","431.271849025645_4.337182","432.183967345542_2.6496983","432.34702235276_5.597187","432.34719391256_4.328638","432.360672416262_4.544366","433.168012708619_2.9778569","433.9782775753_1.1288745","434.165530364106_1.1459572","434.363511903792_4.592898","435.127319630408_4.2183914","435.128347776642_4.9708576","435.128421211292_4.640707","435.183643428989_3.460563","436.184699695233_3.4891677","436.217560638441_4.5429745","436.985025363831_1.135431","438.980676920364_1.1398004","439.157414170161_3.9190342","439.196007036156_5.1140795","439.983455884712_1.1370198","441.133445449191_3.515388","441.136432521557_3.0964103","441.172846784782_5.2706113","442.204799959775_4.0557027","443.115960624585_2.6314251","443.159421198115_2.5237596","443.271174414181_4.708714","444.165041844641_3.5231345","444.186326290447_2.3982158","444.27016315929_4.779959","445.162062547521_3.5406153","445.19000015717_2.343391","445.204268909371_4.8681574","445.276800865189_2.281414","446.201898883843_5.3233795","446.249840277714_2.7390893","446.263298431251_2.7476306","447.155798230221_5.010915","448.342154687091_5.6832376","449.107708644891_4.0183573","449.162805429553_3.2277505","449.178245325541_4.402734","449.192109733836_4.4061112","449.242593627952_3.2490056","450.136905990294_3.6806614","451.157155478145_5.3776507","451.193785572146_5.431673","451.193888546187_4.146878","451.904221739955_0.5202266","452.176149804404_2.3364391","452.236549081_4.268252","452.901767241014_0.5192329","453.18613800333_2.3862984","453.209417476364_4.7684393","455.116091897299_0.69066316","455.152207165994_3.3677952","455.152337774303_3.2585409","455.166664543269_3.2589388","455.741972399506_4.6441536","456.162113484295_2.667576","456.170982125915_3.821301","456.220426437591_4.4551754","456.281434237917_3.3449316","457.131871329006_2.5580697","457.205600936167_5.073757","457.20660824805_4.9168267","458.199231227853_3.7986553","458.199553667564_3.2474163","459.183353600945_3.9545906","460.193841188357_2.3322673","460.215235168666_3.3453493","460.265267706687_3.0865161","460.272612542367_5.1984396","461.126535070987_3.820706","461.177340906489_2.3630564","462.749992884006_5.18182","463.209676546055_5.117266","463.244066554123_5.092428","463.247849136517_5.1087184","464.178218847226_3.8086226","465.166852388396_4.0014715","465.207740411727_2.4149024","465.285351543191_4.7723923","466.264471633594_5.4621086","467.188778961956_3.1236615","467.202936169043_3.1240597","468.16275065367_4.1431046","468.162852563015_4.004709","468.269764276889_4.547002","468.913770824155_0.5184381","469.131426346217_3.7799077","469.131819988623_2.9836102","469.145149020463_2.596661","469.145158575794_2.9057503","469.145973027229_3.812596","469.167962663618_3.728336","470.747785414686_4.545756","470.911780942798_0.51963013","471.145532321797_3.2110639","471.147720335573_2.8204956","471.208365166337_0.9471114","471.208513564504_0.7101293","472.341839506857_6.440611","473.207191614085_4.0660305","474.175599908065_3.6931756","474.175654849292_3.4575827","474.219209636728_2.401196","474.230870751573_3.7166173","474.259183347606_3.416065","474.279017302203_3.4430814","474.301603753326_3.4340563","474.357797269672_6.0229306","474.357920874411_5.0924287","475.142097242418_2.6405616","475.142116708473_4.3520784","475.239719117412_2.835828","475.290144079365_6.3199444","475.294416192834_4.447428","476.160919717778_0.694835","476.206532128317_4.285731","476.212170205866_4.770426","477.100265248862_3.8205073","477.245703790438_5.621622","478.168255376969_4.0704017","478.26505085886_3.290721","479.188651911472_5.080908","480.170944622277_2.4913807","481.16822442093_4.7456017","481.217914303508_3.3024411","481.254331326042_3.30264","481.738335380686_4.5457864","483.162081865842_3.1232646","484.116326257522_0.7085396","484.116398246444_0.9862453","484.155703125696_4.17012","484.156789490052_4.037233","484.157291650195_3.664661","484.157562591281_3.524326","486.255629012834_2.9193084","487.178591848052_0.7158912","487.178759593699_0.97532153","487.20751709757_3.3320382","487.215038419136_3.996505","487.216015404315_4.5775385","487.258352789495_3.497907","488.174388248652_2.5525618","495.183376138015_4.0574884","496.908643516823_0.5196301","497.311723629918_3.701124","498.173098966059_4.092229","498.173292498581_4.2839413","498.26957404813_3.6350114","499.123213967798_5.3137174","499.123215234075_4.4041224","499.123317777403_4.6037607","499.141956115342_3.4317584","500.315469844117_4.6701074","501.207864752135_2.4935658","502.227851788012_3.870367","502.253538582197_4.230111","505.202683328245_1.4884583","508.178789194532_3.8554683","509.174679420604_3.49612","509.285401290459_3.2879405","511.142167868234_3.203101","511.178477797648_4.4454412","512.197186780241_2.3171704","513.121456802455_0.6992028","513.244089168946_3.3574657","514.166196407121_4.282751","514.168046966666_3.4438767","514.1680645116_3.9468434","515.209436597203_2.249831","515.209552314172_5.4166155","515.329777311964_2.539253","517.154789754542_2.6695633","517.22501117616_4.776659","517.225250263171_4.417829","517.225270062131_4.6750736","519.23356933687_3.3105872","520.773606568555_5.487411","521.128616351325_4.9769793","521.183819795745_3.1453145","521.271876911988_6.185576","521.763322107263_4.451996","524.152594237709_3.8532832","524.233588268513_3.3252504","524.903622187842_0.5202266","525.280343875757_3.3034358","527.285696275911_2.9877992","527.762957960779_4.6053495","527.763064040528_4.6307764","527.763569965845_5.0103903","528.183769353193_4.345127","528.183907167979_4.1852508","528.771058155717_4.6244183","531.20452993731_3.7058897","531.317590485728_2.887873","533.763056762346_4.7070556","534.789302490303_4.7909656","535.178309470005_4.832005","535.235574815692_3.3179355","535.236964667212_4.095827","535.76073437965_4.288115","536.197171279131_3.7511792","536.764194900416_4.6466675","536.767906511424_5.601758","536.768280512208_4.8341894","536.768809278032_4.317315","536.888596288983_0.52082187","537.178697994763_3.1145244","537.889565791987_0.51923245","538.1270218386_2.40497","538.218589324866_4.680116","538.226800464936_4.183033","538.887141560888_0.5202262","539.282299851035_5.661667","540.882979426716_0.5202269","541.791691468909_5.089103","542.288339177884_4.335592","542.767979707774_4.171115","542.768223419451_5.1821585","542.768576895364_4.955959","543.132332380497_0.6751703","543.168101129269_3.1988535","543.183297206057_4.6021733","543.775920970087_4.529118","544.238931916278_3.1943636","544.2609539939_2.8335688","544.757253094032_4.3284388","544.764579621998_4.337579","544.771577063628_5.0834894","545.2328652976_5.001848","547.199337417507_3.7348895","547.235740539173_3.9925117","547.29835309733_5.6097636","548.394168933001_5.331646","550.212792280117_4.106754","551.773637384722_4.2311044","552.291393087413_3.3012516","552.752204501194_4.335392","553.238803349344_2.351304","554.343241081682_3.3068125","555.240946415718_4.343737","556.765821626597_4.6323633","556.808334402699_4.165752","557.19904508845_4.8812685","557.244245023498_5.0638876","557.256204560566_4.3324127","557.737581413946_5.085476","557.77394099718_4.665737","558.237820199408_5.090148","558.747611550673_5.0217466","559.231817156306_5.063036","559.277532938698_5.0862694","560.254836937591_5.108627","561.159601482082_3.3610415","561.193817511751_3.8431509","561.254306017828_5.088859","562.76372907486_5.129774","563.245919552326_5.9541535","564.264643080934_5.089522","564.763346165342_4.4941087","564.781307209645_5.449103","565.771361252895_4.577143","566.264773693257_4.663355","569.242615704643_5.089297","569.293023716084_5.262892","569.320289090662_4.5217214","570.745624215728_5.1166363","571.235835515147_3.4311633","571.240707686575_5.090045","571.271847350359_2.5638962","571.78916608635_5.786277","572.376296427116_2.4987297","572.759797177348_4.5308585","572.779218397406_5.044754","573.193875665156_4.243023","573.194087099816_4.5072184","574.264353675797_4.7503347","574.373443430132_4.1290026","574.776322444841_4.40293","575.251876578028_5.0884795","576.38905575257_4.576148","576.389459071182_4.229317","576.390145899106_5.0115824","577.275071432589_3.2927082","577.372982659027_6.591861","578.374814609131_5.0763307","578.404889330714_4.619849","578.406656402623_5.1152167","578.455757632792_5.127192","578.697554672857_5.1160097","578.729741517752_5.1132994","579.440869047658_5.1133013","579.786663112948_4.8453317","580.776302786928_4.515958","581.186222956329_4.1740932","581.396783299582_5.0863953","582.052861736799_0.9876361","582.893786082677_0.52022535","583.770975250705_5.5531325","585.069874366856_0.606703","585.33550369631_3.9480355","587.194406824495_3.3018444","589.153360723739_4.6018653","589.172222707282_2.294723","590.404644732039_5.3077583","590.404702674631_4.761286","592.22279859297_5.248856","592.383764201804_4.769629","592.420388632664_5.4122458","595.40301691008_4.1939583","596.254652686657_3.6176882","596.415562551282_4.594988","598.333041227773_3.3207169","601.17350659698_3.6504674","604.86327023157_0.5200269","605.018018704074_0.6749703","605.313629594591_3.5471725","606.190462833387_0.68325317","606.280474499989_4.8616004","606.301620404574_5.629113","606.399644085_5.419197","606.862305730669_0.52082145","607.319218059495_5.038745","608.215682986023_5.1445103","608.23952329519_0.6789422","608.376325681056_4.842533","609.190254653519_0.7043675","609.26501664899_2.9814339","609.797217427631_4.8119392","609.797229811669_5.0391917","610.394565853499_3.9079099","610.394578057023_4.33599","611.160614155502_4.0229254","611.244427250339_2.3414047","612.887838766117_0.5206226","613.246278059607_5.218316","613.318815948764_2.7860978","615.035051415751_1.1471505","615.238848971941_2.3598773","616.038432360905_1.1431777","616.176320133605_7.4507394","616.786266270528_3.7807481","617.147270480167_4.2940745","618.290225925736_5.0322404","618.291550671606_4.355386","619.162722652101_3.3592212","622.273054861529_3.2759717","624.30164145493_5.00575","624.410033696653_4.4686823","624.783964411822_3.579794","624.784226904524_3.7685552","625.253994683437_6.4576","625.792203801223_4.402445","625.79224133757_3.6407337","627.382071008805_4.270435","628.382914819219_4.8645153","629.132340414478_0.7019845","629.241267000912_2.6739345","629.277419922997_4.9221888","631.147854554322_0.70397174","631.184148271558_3.3191943","632.319799021741_3.8859193","633.142382864254_4.02372","633.358822677773_3.5916667","633.789093792091_3.8459811","634.286763720569_4.4792423","634.394317130029_4.6293845","634.394422485488_4.26686","634.797375535345_3.8876474","634.821992189702_3.588886","636.410005968517_5.4306793","636.410479369109_4.660573","636.41142762531_5.091435","637.229440985105_0.67675877","637.337746257043_5.7065115","638.213434471225_0.67457265","638.364239131547_3.9863744","638.800207994414_4.717875","639.298341185963_5.0946126","639.832436244235_3.9626546","639.884837350553_0.5196297","640.337465725607_5.154208","642.784450866947_3.8876972","642.881350645933_0.51943135","643.220611951378_4.247592","644.23915653574_2.3973455","644.31982165214_3.8719547","645.199758227268_2.996214","645.291006464239_6.3165274","645.291435923501_5.6887655","646.788509429769_5.4292417","646.797576088072_4.260703","647.235835897999_6.2046375","647.236027635026_5.6550016","647.270686633326_5.017738","648.270438330955_3.8276854","650.39422311438_4.9371276","652.297009433864_3.839593","652.405139468011_5.521899","653.324841878431_4.2019024","654.784305527919_4.2607017","654.794139525077_4.175229","655.802631039354_4.199719","657.788239847703_4.2622905","657.788276327872_3.8691738","659.27058655838_5.176453","660.249338523761_2.9597805","660.265240268482_4.2607017","661.175836235648_3.7263508","661.334974377316_3.6536937","662.765885741408_3.8701677","663.230313959279_5.649862","664.115803622664_0.75878376","664.171450612271_2.6322188","665.079399400803_4.0239186","666.384335382519_4.5348306","668.239476512275_3.631225","669.092857070857_1.068902","671.862961852011_4.619228","675.31916066188_3.6325898","677.281268093498_4.566812","677.281780157895_4.770336","679.296865006242_4.511786","679.297327898518_5.0181365","680.75448572371_4.2603045","681.255783688855_4.261099","682.254949609798_3.9003613","684.234086873565_3.4702272","693.276236005505_5.036014","693.34882223061_4.0209374","695.298357941811_4.9265585","695.365103783566_3.9927306","695.433691636642_6.465094","696.807404705657_4.9494042","697.300974215568_3.6329832","697.303826449227_5.3952713","699.263514111392_4.937684","699.264929466417_4.8273005","701.279209723976_5.0193286","705.184434017331_0.6616608","705.236014323679_3.6901953","706.818562329024_3.5988612","706.901721140163_3.6037636","715.823177416139_3.8734705","717.184400082085_3.5768452","717.273668097498_4.5709844","721.244391893806_2.9991124","731.178438286601_3.2198088","731.288527795779_5.2671437","731.289522596004_4.9823775","731.456878619703_4.899417","733.08848489531_0.7389344","740.457854629429_5.247173","742.212111613416_3.69734","743.251838840705_6.577289","749.05224808107_0.98664284","757.21809906814_3.3534932","765.257188102129_3.870167","765.350166507881_6.0145454","769.408533861427_3.4261944","773.213170946335_3.1461086","776.553210809639_6.009774","781.433608933297_6.1750464","792.291533727056_2.863242","797.121331131404_3.7976623","798.962179163695_3.8803904","805.327772155608_5.286901","805.328341044183_6.052245","807.34428952803_5.612484","808.364301907827_6.060726","810.417268089262_3.2915447","811.315659002511_5.804076","812.414190272477_2.5379736","814.457651658925_3.8707638","821.302163226433_5.9849114","822.302204643676_2.9728923","829.326091837655_5.677044","833.975580272891_6.0111656","841.328524635025_6.009179","841.349731641395_4.50841","845.298867779342_5.6536026","857.416824927339_3.7760093","859.33650638196_5.3183656","863.331511050417_4.725726","863.331898048055_4.5109916","869.015899075496_3.9110026","872.499367035118_5.2325525","874.39065259555_6.177034","874.591213693784_6.178424","879.305203106985_4.5098","882.180585098449_6.176637","885.174481676895_6.1782255","885.375120551811_6.1778297","885.575558000436_6.1776314","885.794329780374_6.2394066","887.534295842691_5.900918","888.494333582338_4.643124","889.238920533259_4.5731683","893.341578414687_4.4381695","893.342054698314_4.740679","893.344050970909_5.8292084","896.462671149958_5.0428753","896.463227248883_4.762278","899.445319922891_4.599457","900.494309040442_4.676282","900.494355109044_4.200992","900.494401802338_5.143498","900.49467052741_4.994267","902.50946847929_4.5684614","902.51026276417_5.103555","902.510361279391_5.149243","903.496036964059_5.2440395","903.500121845477_5.0891066","903.513316776676_5.1991525","904.489843789534_4.877891","904.502725612437_5.0929685","905.254663474928_3.0026896","906.504863170248_4.925169","908.612223810866_6.1972938","909.36147311658_5.1840034","911.22037492015_4.5743613","913.026472042376_4.2889085","916.488936426147_4.0488415","916.489609676396_4.4477015","918.504877296639_5.589065","918.507473363876_4.5507216","918.566953814544_4.5525093","918.871446537274_4.548354","919.249163211112_4.5791283","919.436537817108_4.550762","923.867059206742_4.9436436","928.414173691866_6.0320244","934.499393345772_4.0034904","944.555403467009_5.861334","949.708640726462_4.481594","956.405900638342_5.0887313","956.685201036719_6.01335","960.515617138388_5.0993814","962.512499027946_4.546643","969.37571940433_5.8712993","970.689648816487_6.006001","981.696272657772_6.0067954","981.946703028999_6.0058026","982.197332503086_6.0048103","984.355085392382_2.8880715","987.440032541248_6.012712","991.378831837767_5.1586967"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.0746725700195494,1.7416825348450544,1.4198669960226091,4.4519721892129738,2.9533196860688236,3.0294567650920303,2.7689818055707995,2.5607189865653304,1.8179519885913074,4.8404748321980176,1.0550907549046862,2.9840628354511267,1.3645308255661899,1.8991479112405116,4.3051079072949925,3.2336801027267423,1.5237781711871392,1.445387275100277,1.4408639214543619,1.178511052654553,1.1764103908796972,1.1378768611546306,1.5285940307615924,1.5403753846483195,1.6191396692097424,2.0802263275594992,1.6375975437070238,1.4608240107030728,1.3289633613783476,1.0997154974177707,2.6930894817008078,1.1398388328284756,1.6111007247202735,1.2955716329581168,1.0271622033919545,1.3636377045814339,1.0750437344576564,1.0840395399464242,1.008827523842271,1.3313412931840549,1.0983409645288358,1.3875527074537324,1.0622138088382034,1.3474479601137315,1.4064419726378095,1.4529181801749456,1.0773432400946827,1.8716750452670894,3.8878245595533105,1.8745256586495831,4.9715461339558349,2.8094789757007383,4.3997211488635894,5.9553137912550156,1.0573880815091954,1.0377065266463195,3.1718128516078661,1.6488062878963561,1.0899857866891853,2.184260303692021,1.1235917558978787,3.0116570271892833,1.5931180946001682,2.5548775061319464,3.1312280449317864,5.2299209450471107,4.392199842721535,1.2708622307568067,1.4824894809921201,1.0257095035174615,1.3001857692644947,1.4294385452635421,2.2042615330691984,1.6306437960754145,1.822071135552159,3.3624998932685699,2.6451927616169311,1.4202320220356395,1.9446329296783205,1.1153922772807743,3.7988178195718802,3.5559934959669146,2.5555584855024787,1.511842704358866,3.792183042663158,1.7206712300796472,2.0194335768605196,2.9707870567774268,3.0426140915381854,2.4628346607279497,1.5289113879423226,3.371166772611101,1.5364150204317255,1.2667832164427217,1.3143448284272718,1.2796732440239502,1.9407835405077698,4.4255612863018943,1.0728959243363967,1.347259541624787,2.3900906876399723,1.6245280606739509,3.7250134513008,3.0496078809206644,3.5291900911427661,2.8771435992013323,3.6529703881044,1.6931052987237045,2.5793605766652163,1.5638417976992471,1.7703471630570409,1.3524623438759171,1.1379133894535638,1.6333087180039794,1.6458219814541835,2.1547763297184019,1.0682514371585903,1.9468766990452249,1.4617356785244819,4.5400730099819189,2.6875112624506752,4.9923526165049346,1.9012231967069937,1.2636638359352173,1.0276265243092126,1.7037523038512781,1.7482450231034665,1.3453916391683247,1.1862647675757856,3.3892405587885754,1.0047290908440658,1.2946804741217068,1.1511620620834879,1.0684700301056491,1.0219180277513438,1.4140333451552518,5.0326735123972792,2.3720801283722963,1.3460989946057129,1.1243039475207759,1.9190104618729666],"y":[8.8538719643217618,11.452225294612177,4.3027706572402824,8.6903698325741008,10.774690718274137,11.653647025549361,9.9469215565165801,6.1426675035687319,4.6020599913279625,7.6716203965612619,1.4710832997223453,9.4271283977995193,2.0555173278498313,11.458420756053419,9.4534573365218684,5.5376020021010435,6.4584207560534193,8.7328282715969863,7.5654310959658009,6.5833594926617192,4.9665762445130506,6.0390538042661683,6.6861327796308467,5.6497519816658368,5.655607726314889,14.122053048370812,4.3925449767853317,8.5734887386354242,5,4.8601209135987631,4.4788619162959638,2.6840296545430822,2.4596705252091264,1.5157001606532141,4.0644927341752872,2.5543957967264026,4.5816987086802543,4.6968039425795114,1.4122890349810886,6.2373214362725635,3.6363880201078556,4.7258421507363204,6.114073660198569,10.991399828238082,3.9586073148417751,3.5436339668709569,2.5734887386354246,2.2676062401770314,7.5451551399914898,2.8996294548824371,9.2790142558462616,7.8860566476931631,11.718966632752272,10.718966632752272,6.0496351456238768,6.6020599913279625,7.5934598195660445,3.0915149811213505,2.7772835288524167,11.522878745280337,9.0726296369609774,4.105683937315562,7.0846001647877301,8.1778319206319825,4.8356471442155629,8.8153085691824007,20.248720896016657,3.5670307091255942,4.1586405295451447,5.573488738635425,4.991399828238082,6.804100347590766,7.1985962899826452,9.3655227298392685,11.593459819566045,9.669586226650809,7.7281583934635014,8.8601209135987631,8.2765443279648139,2.0390538042661683,13.057991946977687,15.257274868695301,4.7189666327522728,7.7471469690201067,14.954677021213342,10.2958494831602,8.6882461389442458,8.0609802235513328,11.221125527997261,5.2823294969977379,7.0762380391713,10.087246696328677,6.4294570601181027,3.6345120151091002,2.8041003475907664,5.2848326421515424,9.0496351456238777,13.659555885159882,2.111820506081675,3.596879478824182,11.59176003468815,3.9956786262173574,10.555955204081924,10.665546248849068,8.66354026615147,6.991399828238082,8.6073030467403342,4.6038006529042637,2.6575773191777938,4.8696662315049943,8.0639892042847912,4.9507819773298181,3.6234230429434882,8.025949097207123,7.4436974992327132,9.3695721249749759,3.5100415205751654,10.436518914605589,7.7121982700697744,8.8961962790440428,13.081445469449726,14.525783735923746,7.1662156253435212,4.2612194415156308,1.5497508916806388,2.4078232426041333,7.7495799976911064,4.1079053973095192,3.7825160557860937,9.5968794788241816,2.9244530386074694,7.9956786262173578,5.3872161432802645,3.1396619934290064,4.0515870342213987,7.9208187539523749,9.5376020021010444,2.2588484011482151,5.3819519032879075,5.8153085691824016,7.4377071355435254],"text":["1004.54196498357_5.227879","1024.65587328443_5.152619","1032.53626005789_4.561846","1034.55552730134_5.1120253","1035.20999937842_5.1151323","1036.08833557279_5.1137934","1036.20811027474_5.112846","1063.55359737151_5.102087","1064.56173571534_4.5294437","1064.56256345352_5.062037","1070.55251983682_5.1009955","1076.5443098022_5.0173903","1087.56019226313_5.099809","1090.54216049957_4.628391","1093.05922614098_5.0877805","1099.54970934834_5.0868053","1108.55364750803_4.5751567","1138.56283592827_4.5159597","1164.0340835672_6.3254185","1169.27807629203_6.3270073","1169.77958207004_6.324624","1173.52006143208_6.3266115","1192.5445672173_6.3419075","1346.19517310368_5.385562","1346.52905170636_5.3842206","1365.53761159437_5.1514273","1395.53510258752_5.0182495","165.05462976107_2.8772357","235.144113775186_2.9472675","260.196864462938_2.279031","260.222080012835_5.6413207","273.075755591289_3.9692624","273.075959445715_5.8499703","273.221272133518_5.099118","274.212495708315_2.5257456","282.112506770323_4.1798534","287.055021619346_4.002264","302.218621847967_2.5863328","307.176380476385_3.2307308","312.300960129956_4.9501033","342.134999131718_5.068195","353.327445840928_3.734493","355.172688217767_4.922387","355.172697503071_4.093444","355.342781052989_3.7643745","394.095326056325_3.9514406","412.214879276515_5.1825194","412.320843932061_6.4825077","414.336469174079_5.704641","414.336477130827_7.010889","414.336477817697_6.420249","414.349878147519_5.0137672","416.352127978318_5.934502","416.352288873152_6.600741","427.157467019231_2.9577947","428.153607185939_3.2285461","432.34702235276_5.597187","435.128347776642_4.9708576","444.165041844641_3.5231345","446.249840277714_2.7390893","446.263298431251_2.7476306","448.342154687091_5.6832376","460.265267706687_3.0865161","463.209676546055_5.117266","472.341839506857_6.440611","474.357797269672_6.0229306","474.357920874411_5.0924287","484.157562591281_3.524326","499.123213967798_5.3137174","499.123215234075_4.4041224","499.123317777403_4.6037607","511.178477797648_4.4454412","520.773606568555_5.487411","527.762957960779_4.6053495","527.763064040528_4.6307764","527.763569965845_5.0103903","528.771058155717_4.6244183","535.76073437965_4.288115","536.767906511424_5.601758","538.226800464936_4.183033","542.768223419451_5.1821585","542.768576895364_4.955959","543.775920970087_4.529118","547.29835309733_5.6097636","548.394168933001_5.331646","556.765821626597_4.6323633","557.77394099718_4.665737","558.747611550673_5.0217466","559.277532938698_5.0862694","560.254836937591_5.108627","562.76372907486_5.129774","564.781307209645_5.449103","566.264773693257_4.663355","569.293023716084_5.262892","570.745624215728_5.1166363","571.240707686575_5.090045","571.78916608635_5.786277","572.779218397406_5.044754","573.193875665156_4.243023","574.264353675797_4.7503347","574.776322444841_4.40293","576.38905575257_4.576148","576.390145899106_5.0115824","578.404889330714_4.619849","578.406656402623_5.1152167","578.455757632792_5.127192","578.697554672857_5.1160097","578.729741517752_5.1132994","579.440869047658_5.1133013","579.786663112948_4.8453317","580.776302786928_4.515958","583.770975250705_5.5531325","608.215682986023_5.1445103","609.797217427631_4.8119392","609.797229811669_5.0391917","617.147270480167_4.2940745","624.410033696653_4.4686823","634.394317130029_4.6293845","634.394422485488_4.26686","636.410005968517_5.4306793","636.410479369109_4.660573","636.41142762531_5.091435","645.291006464239_6.3165274","645.291435923501_5.6887655","652.297009433864_3.839593","652.405139468011_5.521899","697.303826449227_5.3952713","731.178438286601_3.2198088","731.456878619703_4.899417","740.457854629429_5.247173","805.328341044183_6.052245","807.34428952803_5.612484","811.315659002511_5.804076","821.302163226433_5.9849114","829.326091837655_5.677044","841.328524635025_6.009179","872.499367035118_5.2325525","900.494309040442_4.676282","909.36147311658_5.1840034","923.867059206742_4.9436436","969.37571940433_5.8712993"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.1434970554148602,-2.1486096377567154,-1.1866971177749068,-5.1277872185526832,-3.1236968352869372,-2.7040804257439515,-3.446133165348547,-3.063504149111818,-1.9101878648127162,-3.0533043621042868,-2.2740608922281744,-1.2709667566862421,-2.7473536601764241,-1.5701346729045653,-3.9953728323406903,-1.0568269906090038,-1.001645587340418,-1.3154495509062425,-1.0875335912325852,-1.4911749923945923,-1.2710423403984343,-1.1216271404237617,-1.2983220564812239,-1.5614192349977998,-1.0865544753224867,-1.2553839252903671,-1.0772525997495883,-1.1145918842420528,-1.0066789649046104,-1.5301009306288957,-1.1912141319293248,-1.2753243898104767,-2.7112282141156214,-1.4696684715864947,-1.596527336704435,-1.0370925385220193,-1.6131748741657841,-1.0588891152064939,-1.7624581047111896,-3.5226813880726269,-3.5943811395920555,-2.5806962207245334,-3.0041573609940624,-2.0162510145946033,-1.130678735117689,-2.4819256670658785,-2.8344120270984217,-2.0885990964234917,-2.5227838418013082,-1.1542621538572835,-1.9845679389608009,-1.1728246899332806,-1.4914069472586693,-1.9679614328209976,-2.1106236450205884,-1.1569046520084125,-1.566770737127392,-1.000663449795228,-1.7306710983487186,-1.3791544906042805,-1.4954874130255416,-3.6985385856392554,-2.9941387334637781,-1.1822349651491635,-1.4473341554919354,-1.5215328824768086,-1.1138949113513839,-2.4635486067646255],"y":[12.007446482167865,2.4225082001627745,6.3458234581220392,10.76447155309245,11.928117992693874,15.406713932979542,11.399027104313252,8.4023048140744869,11.313363730737708,13.563837352959244,17.528708288941061,12.245651664288982,12.336299074610352,5.9625735020593762,13.76447155309245,8.7011469235902936,3.5816987086802543,5.9208187539523749,3.0056828473303634,7.026410376572743,5.6968039425795114,5.1051303432547472,6.2247537402597635,4.3535962737769305,4.5044556624535517,4.2111248842245832,3.0109953843014634,4.3036436112666676,8.5072396109731621,7.5686362358410131,6.1811145854059903,2.4225082001627745,6.6497519816658368,4.7772835288524167,9.5606673061697371,2.9829666607012197,4.8096683018297082,6.0141246426916064,7.5391021572434518,8.7399286120149249,10.032452023781138,10.009217308196861,8.0830199526796171,6.3575354797578782,9.4485500020271243,8.8996294548824366,11.747146969020108,8.0550240915879527,9.481486060122112,5.0362121726544444,6.4948500216800937,8.6216020990518629,1.5590909179347823,15.089375595110798,8.0092173081968614,9.8696662315049934,9.1524273408578871,6.6090648928966207,8.5968794788241816,9.0021769192542749,8.681936665037238,10.285670240254767,7.9665762445130506,7.163675884293248,11.549750891680638,5.1163385648463828,3.4248121550723392,7.3840499483435993],"text":["1025.38424755014_4.2881155","1035.53803422953_5.1342006","112.086888085517_0.5327405","1208.56868152163_3.792631","1210.58400966928_3.4885986","1212.5995506509_4.1152945","1228.59491949469_3.8650029","1228.59535506144_3.6373556","1240.59421196927_4.32268","1268.59007971284_4.1923685","1270.60700514352_4.260901","1292.58739446697_3.870564","1300.61575330522_4.2100472","1309.5661765845_4.575434","1432.65843333566_4.1609845","191.102705350765_0.68291515","209.153615490251_4.136041","227.102690054227_2.5885174","227.139071717043_2.6673784","254.186500429163_3.015402","254.19648935992_3.0191767","296.196812793616_4.2382545","371.203851222227_5.1704965","385.183313255763_4.389623","385.258241257637_6.4443846","394.207078530317_5.6001663","399.0897394097_3.4327517","415.23007497056_4.9744315","427.095080247212_0.69999886","431.115872755097_2.4977367","439.196007036156_5.1140795","451.193785572146_5.431673","479.188651911472_5.080908","488.174388248652_2.5525618","499.141956115342_3.4317584","517.22501117616_4.776659","572.759797177348_4.5308585","596.254652686657_3.6176882","601.17350659698_3.6504674","616.786266270528_3.7807481","624.783964411822_3.579794","624.784226904524_3.7685552","625.792203801223_4.402445","625.79224133757_3.6407337","631.184148271558_3.3191943","632.319799021741_3.8859193","633.789093792091_3.8459811","634.797375535345_3.8876474","638.800207994414_4.717875","639.298341185963_5.0946126","642.784450866947_3.8876972","644.31982165214_3.8719547","645.199758227268_2.996214","653.324841878431_4.2019024","654.794139525077_4.175229","655.802631039354_4.199719","660.265240268482_4.2607017","662.765885741408_3.8701677","666.384335382519_4.5348306","680.75448572371_4.2603045","681.255783688855_4.261099","706.818562329024_3.5988612","715.823177416139_3.8734705","717.184400082085_3.5768452","814.457651658925_3.8707638","905.254663474928_3.0026896","928.414173691866_6.0320244","987.440032541248_6.012712"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,255,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.6819422690430681,6.5094688417454005],"y":[1.3,1.3],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-1],"y":[-1.0119798074381143,21.261135215228791],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-1.0119798074381143,21.261135215228791],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"OH8243 vs HATS, positive mode","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.6819422690430681,6.5094688417454005],"tickmode":"array","ticktext":["-3","0","3","6"],"tickvals":[-3,0,3,6],"categoryorder":"array","categoryarray":["-3","0","3","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"-log2 fold change","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.0119798074381143,21.261135215228791],"tickmode":"array","ticktext":["0","5","10","15","20"],"tickvals":[0,5.0000000000000018,10,14.999999999999998,20],"categoryorder":"array","categoryarray":["0","5","10","15","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"-log10 p-value","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c0f69c2999a":{"x":{},"y":{},"text":{},"type":"scatter"},"c0f66f283b4":{"x":{},"y":{},"text":{}},"c0f3ba4d339":{"x":{},"y":{},"text":{}},"c0f422761c6":{"yintercept":{}},"c0f27843018":{"xintercept":{}},"c0f57718bec":{"xintercept":{}}},"cur_data":"c0f69c2999a","visdat":{"c0f69c2999a":["function (y) ","x"],"c0f66f283b4":["function (y) ","x"],"c0f3ba4d339":["function (y) ","x"],"c0f422761c6":["function (y) ","x"],"c0f27843018":["function (y) ","x"],"c0f57718bec":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering">K-means clustering</h2>
<p>Conduct k-means clustering on our data to see if we do have a natural 3 groups here.</p>
<p>First I am wrangling the data by removing metadata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>for_kmeans <span class="ot">&lt;-</span> metab_wide_meta_imputed_log2 <span class="sc">%&gt;%</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>sample_or_qc <span class="sc">==</span> <span class="st">"QC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sample_name, <span class="sc">-</span>sample_or_qc, <span class="sc">-</span>tomato, <span class="sc">-</span>rep_or_plot, <span class="sc">-</span>run_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then I can calculate within cluster sum of square errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate within cluster sum of squared errors wss</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  tomato_kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(for_kmeans, <span class="at">centers =</span> i, <span class="at">nstart =</span> <span class="dv">20</span>)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  wss[i] <span class="ot">&lt;-</span> tomato_kmeans<span class="sc">$</span>tot.withinss</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Followed by a scree plot which helps us see how many clusters we might have in our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, wss, <span class="at">type =</span> <span class="st">"b"</span>, </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of Clusters"</span>, </span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Within groups sum of squares"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>To me, I might pick the elbow at 3 clusters. You could change this or try different numbers of clusters and see how that affects your results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set number of clusters to be 3</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>kmeans_3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(for_kmeans, </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">centers =</span> k, </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nstart =</span> <span class="dv">20</span>, </span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter.max =</span> <span class="dv">200</span>)</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kmeans_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>             Length Class  Mode   
cluster        36   -none- numeric
centers      3834   -none- numeric
totss           1   -none- numeric
withinss        3   -none- numeric
tot.withinss    1   -none- numeric
betweenss       1   -none- numeric
size            3   -none- numeric
iter            1   -none- numeric
ifault          1   -none- numeric</code></pre>
</div>
</div>
<p>Which samples are in which cluster?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>kmeans_3<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code> [1] 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 1 3 3 3 3 3 3 3 3</code></pre>
</div>
</div>
<p>Now we can add the cluster identity to our metadata so we can visualizate our data based on the kmeans clustering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the cluster group to the parent datafile</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>scores_noqc_kmeans <span class="ot">&lt;-</span> scores_noqc <span class="sc">%&gt;%</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_3 =</span> kmeans_3<span class="sc">$</span>cluster)</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder so kmeans cluster is towards the beginning</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>scores_noqc_kmeans <span class="ot">&lt;-</span> scores_noqc_kmeans <span class="sc">%&gt;%</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, sample_or_qc, tomato, rep_or_plot, run_order, kmeans_3, <span class="fu">everything</span>())</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co"># check the reordering</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(scores_noqc_kmeans[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">sample_name</th>
<th style="text-align: left;">sample_or_qc</th>
<th style="text-align: left;">tomato</th>
<th style="text-align: left;">rep_or_plot</th>
<th style="text-align: right;">run_order</th>
<th style="text-align: right;">kmeans_3</th>
<th style="text-align: right;">PC1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HATS_402_041</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">402</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-23.24793</td>
</tr>
<tr class="even">
<td style="text-align: left;">HATS_403_037</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">403</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-17.01461</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HATS_404_040</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">404</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-21.49241</td>
</tr>
<tr class="even">
<td style="text-align: left;">HATS_401_022</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">401</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-16.35241</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HATS_408_043</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">408</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-15.27909</td>
</tr>
<tr class="even">
<td style="text-align: left;">HATS_405_025</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">405</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-20.42581</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HATS_406_055</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">406</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-20.87974</td>
</tr>
<tr class="even">
<td style="text-align: left;">HATS_407_059</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">407</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-21.20251</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HATS_412_019</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">412</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-14.14882</td>
</tr>
<tr class="even">
<td style="text-align: left;">HATS_409_056</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">409</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-15.66016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HATS_410_018</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">410</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-15.15110</td>
</tr>
<tr class="even">
<td style="text-align: left;">HATS_411_044</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">HATS</td>
<td style="text-align: left;">411</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-15.69849</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA2213_602_035</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">602</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">41.19750</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA2213_603_045</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">603</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">49.19390</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA2213_601_051</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">601</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">49.69095</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA2213_604_016</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">604</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">46.56555</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA2213_605_017</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">605</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">46.48514</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA2213_607_032</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">607</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45.99993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA2213_608_024</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">608</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45.81353</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA2213_606_033</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">606</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">49.70804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA2213_609_058</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">609</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45.76014</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA2213_610_050</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">610</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">43.55337</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA2213_612_046</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">612</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">44.25618</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH8243_801_036</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">801</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-22.74986</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH8243_802_026</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">802</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-25.64428</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH8243_803_030</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">803</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-26.66404</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH8243_805_057</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">805</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-31.27910</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA2213_611_061</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">LA2213</td>
<td style="text-align: left;">611</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">50.50206</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH8243_804_029</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">804</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-30.49216</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH8243_806_027</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">806</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-36.03705</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH8243_809_063</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">809</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-29.82613</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH8243_807_053</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">807</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-28.82398</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH8243_810_049</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">810</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-26.33023</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH8243_808_038</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">808</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-26.40468</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH8243_812_060</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">812</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-31.83884</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH8243_811_028</td>
<td style="text-align: left;">Sample</td>
<td style="text-align: left;">OH8243</td>
<td style="text-align: left;">811</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-26.08287</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now we can color our PCA based on our kmeans clustering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>(scores_noqc_kmeans_plot <span class="ot">&lt;-</span> scores_noqc_kmeans <span class="sc">%&gt;%</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">fill =</span> <span class="fu">as.factor</span>(kmeans_3), <span class="at">shape =</span> tomato,</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">text =</span> <span class="fu">glue</span>(<span class="st">"Sample: {sample_name},</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="st">                            Treatment: {tomato}"</span>))) <span class="sc">+</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">glue</span>(<span class="st">"PC1: {PC1_percent_noqc}%"</span>), </span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">glue</span>(<span class="st">"PC2: {PC2_percent_noqc}%"</span>), </span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"PCA Scores Plot Colored by K-means Cluster"</span>,</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"K-means cluster"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Looks like the K-means clusters are aligned exactly with our tomato type.</p>
</section>
<section id="hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-clustering">Hierarchical clustering</h2>
<p>Conduct hierarchical clustering to see if our data naturally is clustered into our three tomato groups. Here I will calculate a distance matrix using Wards distance, or minimal increase in sum of squares (MISSQ), good for more cloud and spherical shaped groups, and running HCA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the df for kmeans also works for HCA but needs to be a matrix</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>for_hca <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(for_kmeans)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a distance matrix</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">distance</span>(for_hca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Metric: 'euclidean'; comparing: 36 vectors.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making the true distance matrix</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>true_dist_matrix <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist_matrix)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># conduct HCA</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>hclust_output <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="at">d =</span> true_dist_matrix, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hclust_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>            Length Class  Mode     
merge       70     -none- numeric  
height      35     -none- numeric  
order       36     -none- numeric  
labels      36     -none- character
method       1     -none- character
call         3     -none- call     
dist.method  0     -none- NULL     </code></pre>
</div>
</div>
<p>Now we can plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_output,</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Hierarchical clustering of samples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Our samples are not named, let’s bring back which sample is which.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grab metadata</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>hca_meta <span class="ot">&lt;-</span> metab_wide_meta_imputed_log2 <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>sample_or_qc <span class="sc">==</span> <span class="st">"QC"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, sample_or_qc, tomato, rep_or_plot, run_order)</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="co"># bind to hca object</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>hclust_output<span class="sc">$</span>labels <span class="ot">&lt;-</span> hca_meta<span class="sc">$</span>sample_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_output,</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Hierarchical clustering of samples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>This base R plotting is too ugly for me I gotta do something about it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdendrogram</span>(hclust_output, <span class="at">rotate =</span> <span class="cn">TRUE</span>, <span class="at">theme_dendro =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dendrogram object so we can plot better late</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hclust_output)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>dend_data <span class="ot">&lt;-</span> <span class="fu">dendro_data</span>(dend, <span class="at">type =</span> <span class="st">"rectangle"</span>)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dend_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>[1] "segments"    "labels"      "leaf_labels" "class"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dend_data<span class="sc">$</span>segments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>         x         y     xend      yend
1 14.32812 734.90047  6.87500 734.90047
2  6.87500 734.90047  6.87500  49.19104
3 14.32812 734.90047 21.78125 734.90047
4 21.78125 734.90047 21.78125 225.75525
5  6.87500  49.19104  3.62500  49.19104
6  3.62500  49.19104  3.62500  32.07677</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dend_data<span class="sc">$</span>labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>  x y          label
1 1 0 LA2213_608_024
2 2 0 LA2213_609_058
3 3 0 LA2213_610_050
4 4 0 LA2213_606_033
5 5 0 LA2213_611_061
6 6 0 LA2213_604_016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new column called group so we can color by it</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>dend_data<span class="sc">$</span>labels <span class="ot">&lt;-</span> dend_data<span class="sc">$</span>labels <span class="sc">%&gt;%</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> label, </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>, </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"group"</span>, <span class="st">"rep"</span>, <span class="st">"run_order"</span>),</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols_remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, y, label, group)</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dend_data<span class="sc">$</span>segments) <span class="sc">+</span> </span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend))<span class="sc">+</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> dend_data<span class="sc">$</span>labels, <span class="fu">aes</span>(x, y, <span class="at">label =</span> label, <span class="at">color =</span> group),</span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">300</span>, <span class="dv">800</span>) <span class="sc">+</span></span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of tomato samples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
</section>
<section id="pls-da" class="level2">
<h2 class="anchored" data-anchor-id="pls-da">PLS-DA</h2>
<p>Partial least squares discriminant analysis (or regression) is a method for classification/prediction of high dimensional data. Many people use PLS to find the features most distinguishing groups (or more associated with an outcome Y). Personally I don’t really like PLS analysis - I don’t find its any more useful that running a series of univariate tests to see which feautures are differentially abundant by group, and it has a <a href="10.2174/2213235X11301010092">bad tendency to overfit</a> especially with noisy data (and one could argue metabolomics data is always noisy). Still, I’ll show you how to do it.</p>
<p>As we went over in the lecture material, PLS based methods are prediction methods though most use them in metabolomics to discover features of interest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>for_PLS <span class="ot">&lt;-</span> metab_wide_meta_imputed_log2 <span class="sc">%&gt;%</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sample_name, <span class="sc">-</span>sample_or_qc, <span class="sc">-</span>tomato, <span class="sc">-</span>rep_or_plot, <span class="sc">-</span>run_order) <span class="co"># remove meta</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>pls <span class="ot">&lt;-</span> <span class="fu">opls</span>(<span class="at">x =</span> for_PLS, <span class="at">y =</span> metab_wide_meta_imputed_log2<span class="sc">$</span>tomato,</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">orthoI =</span> <span class="dv">0</span>) <span class="co"># for PLS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>PLS-DA
42 samples x 1278 variables and 1 response
standard scaling of predictors and response(s)
      R2X(cum) R2Y(cum) Q2(cum)  RMSEE pre ort pR2Y  pQ2
Total    0.727    0.986   0.964 0.0528   5   0 0.05 0.05</code></pre>
</div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random forest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed for consistent results</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co"># divide our data into a training and a test set</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>for_RF <span class="ot">&lt;-</span> metab_wide_meta_imputed_log2 <span class="sc">%&gt;%</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample_or_qc <span class="sc">==</span> <span class="st">"Sample"</span>) <span class="sc">%&gt;%</span> <span class="co"># keep only samples</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sample_name, <span class="sc">-</span>sample_or_qc, <span class="sc">-</span>rep_or_plot, <span class="sc">-</span>run_order)  <span class="sc">%&gt;%</span> <span class="co"># remove meta we don't need</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="co"># can't have unused factors </span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sample your data with replacement</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(for_RF), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>))</span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create a training set</span></span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> for_RF[ind <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create a test set</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> for_RF[ind <span class="sc">==</span> <span class="dv">2</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run random forest with the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(tomato <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">proximity =</span> <span class="cn">TRUE</span>) </span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print output</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>
Call:
 randomForest(formula = tomato ~ ., data = train, proximity = TRUE) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 35

        OOB estimate of  error rate: 0%
Confusion matrix:
       HATS LA2213 OH8243 class.error
HATS      7      0      0           0
LA2213    0      8      0           0
OH8243    0      0      9           0</code></pre>
</div>
</div>
<p>Predict on the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>predicted_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf, train)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the confusion matrix</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicted_train, train<span class="sc">$</span>tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Confusion Matrix and Statistics

          Reference
Prediction HATS LA2213 OH8243
    HATS      7      0      0
    LA2213    0      8      0
    OH8243    0      0      9

Overall Statistics
                                     
               Accuracy : 1          
                 95% CI : (0.8575, 1)
    No Information Rate : 0.375      
    P-Value [Acc &gt; NIR] : 5.981e-11  
                                     
                  Kappa : 1          
                                     
 Mcnemar's Test P-Value : NA         

Statistics by Class:

                     Class: HATS Class: LA2213 Class: OH8243
Sensitivity               1.0000        1.0000         1.000
Specificity               1.0000        1.0000         1.000
Pos Pred Value            1.0000        1.0000         1.000
Neg Pred Value            1.0000        1.0000         1.000
Prevalence                0.2917        0.3333         0.375
Detection Rate            0.2917        0.3333         0.375
Detection Prevalence      0.2917        0.3333         0.375
Balanced Accuracy         1.0000        1.0000         1.000</code></pre>
</div>
</div>
<p>Predict using the test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>predicted_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf, test)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the confusion matrix</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicted_test, test<span class="sc">$</span>tomato)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>Confusion Matrix and Statistics

          Reference
Prediction HATS LA2213 OH8243
    HATS      5      0      0
    LA2213    0      4      0
    OH8243    0      0      3

Overall Statistics
                                     
               Accuracy : 1          
                 95% CI : (0.7354, 1)
    No Information Rate : 0.4167     
    P-Value [Acc &gt; NIR] : 2.738e-05  
                                     
                  Kappa : 1          
                                     
 Mcnemar's Test P-Value : NA         

Statistics by Class:

                     Class: HATS Class: LA2213 Class: OH8243
Sensitivity               1.0000        1.0000          1.00
Specificity               1.0000        1.0000          1.00
Pos Pred Value            1.0000        1.0000          1.00
Neg Pred Value            1.0000        1.0000          1.00
Prevalence                0.4167        0.3333          0.25
Detection Rate            0.4167        0.3333          0.25
Detection Prevalence      0.4167        0.3333          0.25
Balanced Accuracy         1.0000        1.0000          1.00</code></pre>
</div>
</div>
<p>What doe sthe error rate look over number of trees?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
</div>
<p>Capture the features most contributing to the rf model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in a plot</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(rf,</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">sort =</span> T,</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">n.var =</span> <span class="dv">10</span>,</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Top 10 - Variable Importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_R_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid" style="width:85.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in a list</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(rf) <span class="sc">%&gt;%</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> MeanDecreaseGini, <span class="at">n =</span> <span class="dv">20</span>) <span class="co"># grab top 20 features</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="styled-output"><code>                             MeanDecreaseGini
x579_786663112948_4_8453317        0.15644682
x578_729741517752_5_1132994        0.11585055
x244_117953612934_3_2474165        0.11521026
x547_29835309733_5_6097636         0.11469464
x636_410479369109_4_660573         0.09894394
x625_792203801223_4_402445         0.09052381
x578_455757632792_5_127192         0.08673333
x416_352288873152_6_600741         0.08492930
x638_800207994414_4_717875         0.08109414
x1432_65843333566_4_1609845        0.08057033
x533_763056762346_4_7070556        0.08030996
x542_768223419451_5_1821585        0.08005152
x423_285185114523_3_2875428        0.07854762
x295_164601782148_3_071221         0.07637349
x427_154754694626_3_598619         0.07338462
x684_234086873565_3_4702272        0.06961655
x1138_56283592827_4_5159597        0.06828095
x1064_56256345352_5_062037         0.06825897
x542_768576895364_4_955959         0.06816667
x260_053184204638_0_66126305       0.06769048</code></pre>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Created with RStudio and <a href="https://quarto.org/">Quarto</a> <br> © Jessica Cooperstone, 2024, License: <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a> <br> <a href="https://osu-codeclub.github.io/#category=website">Want to make a website like this one?</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>